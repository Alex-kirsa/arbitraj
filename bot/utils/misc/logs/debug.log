2024-03-01T00:39:12.596957+0200 INFO Bot started!
2024-03-01T00:40:07.395678+0200 INFO ::1 [01/Mar/2024:00:40:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:07.401547+0200 INFO Update id=925011838 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T00:40:07.450785+0200 INFO ::1 [01/Mar/2024:00:40:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:07.454436+0200 INFO Update id=925011839 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T00:40:08.114574+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.167213+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.222325+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.274582+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.330015+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.378219+0200 INFO Update id=925011840 is handled. Duration 264 ms by bot id=5646878393
2024-03-01T00:40:08.381143+0200 INFO Update id=925011843 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T00:40:08.381738+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.385125+0200 INFO Update id=925011845 is handled. Duration 0 ms by bot id=5646878393
2024-03-01T00:40:08.436440+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.439923+0200 INFO Update id=925011842 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T00:40:08.489162+0200 INFO ::1 [01/Mar/2024:00:40:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:40:08.492764+0200 INFO Update id=925011841 is handled. Duration 328 ms by bot id=5646878393
2024-03-01T00:40:08.538707+0200 INFO Update id=925011844 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T00:40:08.601285+0200 INFO Update id=925011847 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T00:40:08.647837+0200 INFO Update id=925011846 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T00:41:06.858985+0200 INFO ::1 [01/Mar/2024:00:41:06 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:41:07.097724+0200 INFO Update id=925011848 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T00:41:09.402058+0200 INFO ::1 [01/Mar/2024:00:41:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:41:09.530807+0200 INFO Update id=925011849 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T00:41:10.743206+0200 INFO ::1 [01/Mar/2024:00:41:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:41:10.866141+0200 INFO Update id=925011850 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T00:42:07.723187+0200 INFO ::1 [01/Mar/2024:00:42:07 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"
2024-03-01T00:42:07.869656+0200 INFO <MultiDictProxy()>
2024-03-01T00:42:07.872659+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000020425A39620>
    │       └ <function run at 0x000002041D2EC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000020425915D40>
           │      └ <function Runner.run at 0x000002041D37C900>
           └ <asyncio.runners.Runner object at 0x00000204235D53D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002041D37A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000204235D53D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002041D45A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002041D37C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002041D2BDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000204262F7C40>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000204262F7C40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000204262F7C40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000204262F7C40>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x20425f05550>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000020425A394E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 64, in handle_add_channel
    data = safe_parse_webapp_init_data(token=bot.token, init_data=data["_auth"])
           │                                 │   │                └ <MultiDictProxy()>
           │                                 │   └ <property object at 0x000002042327C270>
           │                                 └ <class 'aiogram.client.bot.Bot'>
           └ <function safe_parse_webapp_init_data at 0x0000020425A39300>

KeyError: '_auth'
2024-03-01T00:42:07.881293+0200 INFO ::1 [01/Mar/2024:00:42:07 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"
2024-03-01T00:58:09.017862+0200 INFO ::1 [01/Mar/2024:00:58:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:58:09.020624+0200 INFO Update id=925011851 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T00:58:09.023620+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-83' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=UnknownIntent('Context not found for intent id: wC6tf5')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000020425A7FB90>
                   │    │          │                   │           └ {'update_id': 925011851, 'callback_query': {'id': '1663765556340974741', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000020425967AD0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000204232FF1A0>
                   │    └ <Dispatcher '0x204258507d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000020425A7FB90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000020425967AD0>
                 │    └ <function Dispatcher.feed_update at 0x00000204232FF100>
                 └ <Dispatcher '0x204258507d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000204232FD940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000020425EE4C50>
                     └ <Dispatcher '0x204258507d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000020425842210>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000020425EE5290>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000204259A2640>
          │    │   │      │    └ UnknownIntent('Context not found for intent id: wC6tf5')
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnknownIntent'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000204260026B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000020425F0F210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000020425815650>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000020425FC07C0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000020425EF0710>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000020425EE5750>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011851, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000204262B7380>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x204258507d0'>>, Update(update_id=925011851, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556340974741', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000204232FE700>
                 └ <Dispatcher '0x204258507d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556340974741', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000204262B74C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000204232FD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000020425EDB1D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000204232FE7A0>
                 └ <Dispatcher '0x204258507d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556340974741', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000204232FE700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x204258507d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556340974741', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000204262B56C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000204232FD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000020425EE65D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 250, in process_callback_query
    await self._load_context_by_intent(
          │    └ <function IntentMiddlewareFactory._load_context_by_intent at 0x000002042371FE20>
          └ <aiogram_dialog.context.intent_middleware.IntentMiddlewareFactory object at 0x0000020425833490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 125, in _load_context_by_intent
    context = await proxy.load_context(intent_id)
                    │     │            └ 'wC6tf5'
                    │     └ <function StorageProxy.load_context at 0x000002042371F380>
                    └ <aiogram_dialog.context.storage.StorageProxy object at 0x00000204262C0A50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\storage.py", line 51, in load_context
    raise UnknownIntent(
          └ <class 'aiogram_dialog.api.exceptions.UnknownIntent'>

aiogram_dialog.api.exceptions.UnknownIntent: Context not found for intent id: wC6tf5
2024-03-01T00:58:11.954173+0200 INFO ::1 [01/Mar/2024:00:58:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:58:12.142203+0200 INFO Update id=925011852 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T00:58:13.592971+0200 INFO ::1 [01/Mar/2024:00:58:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:58:13.701301+0200 INFO Update id=925011853 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T00:58:16.323361+0200 INFO ::1 [01/Mar/2024:00:58:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T00:58:16.439716+0200 INFO Update id=925011854 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T00:58:33.521975+0200 INFO ::1 [01/Mar/2024:00:58:33 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T00:58:33.604616+0200 INFO <MultiDictProxy()>
2024-03-01T00:58:33.605180+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000020425A39620>
    │       └ <function run at 0x000002041D2EC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000020425915D40>
           │      └ <function Runner.run at 0x000002041D37C900>
           └ <asyncio.runners.Runner object at 0x00000204235D53D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002041D37A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000204235D53D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002041D45A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002041D37C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002041D2BDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000002042629FB80>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000002042629FB80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000002042629FB80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000002042629FB80>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x20425f05550>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000020425A394E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 64, in handle_add_channel

KeyError: '_auth'
2024-03-01T00:58:33.608148+0200 INFO ::1 [01/Mar/2024:00:58:33 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T00:58:45.320653+0200 INFO Bot stopped!
2024-03-01T00:58:48.925520+0200 INFO Bot started!
2024-03-01T00:59:01.527195+0200 INFO ::1 [01/Mar/2024:00:59:01 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T00:59:01.610876+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001B5425A5620>
    │       └ <function run at 0x000001B539EBC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001B542481C40>
           │      └ <function Runner.run at 0x000001B539F4C900>
           └ <asyncio.runners.Runner object at 0x000001B542517750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001B539F4A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001B542517750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001B53A01A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001B539F4C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001B539E8DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001B5426A2AD0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001B5426A2AD0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001B5426A2AD0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001B5426A2AD0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1b542b31d90>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001B5425A54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 66, in handle_add_channel
    data = safe_parse_webapp_init_data(token=bot.token, init_data=data["_auth"])
           │                                 │   │                └ <MultiDictProxy()>
           │                                 │   └ <property object at 0x000001B53FDEC270>
           │                                 └ <class 'aiogram.client.bot.Bot'>
           └ <function safe_parse_webapp_init_data at 0x000001B5425A5300>

KeyError: '_auth'
2024-03-01T00:59:01.618846+0200 INFO ::1 [01/Mar/2024:00:59:01 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:00:41.037613+0200 INFO Bot stopped!
2024-03-01T01:00:44.501372+0200 INFO Bot started!
2024-03-01T01:00:56.518999+0200 INFO ::1 [01/Mar/2024:01:00:56 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:00:56.601750+0200 INFO ::1 [01/Mar/2024:01:00:56 +0200] "POST /add-channel HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:01:07.582898+0200 INFO Bot stopped!
2024-03-01T01:01:11.183455+0200 INFO Bot started!
2024-03-01T01:01:17.757597+0200 INFO ::1 [01/Mar/2024:01:01:17 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:01:17.840280+0200 INFO ::1 [01/Mar/2024:01:01:17 +0200] "POST /add-channel HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:05:24.118790+0200 INFO Bot stopped!
2024-03-01T01:05:27.663192+0200 INFO Bot started!
2024-03-01T01:05:40.641920+0200 INFO ::1 [01/Mar/2024:01:05:40 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:05:40.811897+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000019575BF5620>
    │       └ <function run at 0x000001956D4EC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000019575AD5C40>
           │      └ <function Runner.run at 0x000001956D57C900>
           └ <asyncio.runners.Runner object at 0x00000195759CA650>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001956D57A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000195759CA650>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001956D64A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001956D57C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001956D4BDA80>
    └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E00>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E00>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x19575c4c250>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000019575BF54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 66, in handle_add_channel
    data = check_webapp_signature(token=bot.token, init_data=data)
           │                            │   │                └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
           │                            │   └ <property object at 0x000001957343C270>
           │                            └ <class 'aiogram.client.bot.Bot'>
           └ <function check_webapp_signature at 0x0000019575BF4E00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\utils\web_app.py", line 78, in check_webapp_signature
    parsed_data = dict(parse_qsl(init_data, strict_parsing=True))
                       │         └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
                       └ <function parse_qsl at 0x000001956D776A20>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 733, in parse_qsl
    qs, _coerce_result = _coerce_args(qs)
    │                    │            └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
    │                    └ <function _coerce_args at 0x000001956D774680>
    └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 124, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           │            │        └ <function _encode_result at 0x000001956D774540>
           │            └ ({'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAud...
           └ <function _decode_args at 0x000001956D7745E0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 108, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                          │         │                             └ ({'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAud...
                          │         └ 'strict'
                          └ 'ascii'
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 108, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 │        │         │          │             └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
                 │        │         │          └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...
                 │        │         └ 'strict'
                 │        └ 'ascii'
                 └ {'channelName': 'd', 'channelUrl': 'd', 'channelTheme': {'id': 3, 'name': 'Лінгвістика '}, 'subscriberCount': '22', 'maleAudi...

AttributeError: 'dict' object has no attribute 'decode'
2024-03-01T01:05:40.820955+0200 INFO ::1 [01/Mar/2024:01:05:40 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:21:07.183044+0200 INFO ::1 [01/Mar/2024:01:21:07 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:21:07.272812+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000019575BF5620>
    │       └ <function run at 0x000001956D4EC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000019575AD5C40>
           │      └ <function Runner.run at 0x000001956D57C900>
           └ <asyncio.runners.Runner object at 0x00000195759CA650>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001956D57A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000195759CA650>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001956D64A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001956D57C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001956D4BDA80>
    └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E30>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x0000019575CF2E30>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x19575c4c250>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000019575BF54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 66, in handle_add_channel
    async with db_factory() as session:
               └ async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.engine.AsyncEngine object at 0x0000019575B81140>, auto...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\utils\web_app.py", line 78, in check_webapp_signature
    parsed_data = dict(parse_qsl(init_data, strict_parsing=True))
                       │         └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...
                       └ <function parse_qsl at 0x000001956D776A20>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 733, in parse_qsl
    qs, _coerce_result = _coerce_args(qs)
    │                    │            └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...
    │                    └ <function _coerce_args at 0x000001956D774680>
    └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 124, in _coerce_args
    return _decode_args(args) + (_encode_result,)
           │            │        └ <function _encode_result at 0x000001956D774540>
           │            └ ({'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', '...
           └ <function _decode_args at 0x000001956D7745E0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 108, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                          │         │                             └ ({'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', '...
                          │         └ 'strict'
                          └ 'ascii'
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\urllib\parse.py", line 108, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
                 │        │         │          │             └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...
                 │        │         │          └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...
                 │        │         └ 'strict'
                 │        └ 'ascii'
                 └ {'channelName': 'dd', 'channelTheme': {'id': 9, 'name': 'Інше '}, 'channelThemeAdditional': 'tyrstsd', 'channelUrl': '22', 's...

AttributeError: 'dict' object has no attribute 'decode'
2024-03-01T01:21:07.277346+0200 INFO ::1 [01/Mar/2024:01:21:07 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:24:04.656198+0200 INFO Bot stopped!
2024-03-01T01:28:22.949795+0200 INFO Bot started!
2024-03-01T01:28:23.810224+0200 INFO ::1 [01/Mar/2024:01:28:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:28:24.033492+0200 INFO Update id=925011855 is handled. Duration 234 ms by bot id=5646878393
2024-03-01T01:28:28.666527+0200 INFO ::1 [01/Mar/2024:01:28:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:28:28.799319+0200 INFO Update id=925011856 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T01:28:52.820567+0200 INFO ::1 [01/Mar/2024:01:28:52 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:28:52.905905+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000020A83889620>
    │       └ <function run at 0x0000020AFB18C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000020A83765B40>
           │      └ <function Runner.run at 0x0000020AFB21C900>
           └ <asyncio.runners.Runner object at 0x0000020A83049A10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000020AFB21A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000020A83049A10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000020AFB2EA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000020AFB21C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000020AFB15DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x20a83826410>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000020A838894E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(*data_for_db)
          │    │            │            └ {'channel_title': 'test', 'channel_owner_id': 387375605, 'channel_theme': 'other', 'custom_channel_theme': 'aboba', 'channel_...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x0000020A835319E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x0000020A83EDD010>
          └ <bot.db.Repo object at 0x0000020A83EDD690>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 13, in add_channel
    query = insert(Channels).values(
            │      └ <class 'bot.db.models.models.Channels'>
            └ <function insert at 0x0000020A834F7C40>

  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 280, in _generative
    x = fn(self, *args, **kw)
        │  │      │       └ {}
        │  │      └ ('channel_title', 'channel_owner_id', 'channel_theme', 'custom_channel_theme', 'channel_invite_link', 'subs_amount', 'male_pe...
        │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000020A83EDDB50>
        └ <function ValuesBase.values at 0x0000020A82EA3740>
  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 313, in check
    return fn(self, *args, **kw)
           │  │      │       └ {}
           │  │      └ ('channel_title', 'channel_owner_id', 'channel_theme', 'custom_channel_theme', 'channel_invite_link', 'subs_amount', 'male_pe...
           │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000020A83EDDB50>
           └ <function ValuesBase.values at 0x0000020A82EA36A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\dml.py", line 1117, in values
    raise exc.ArgumentError(
          │   └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.ArgumentError: Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.
2024-03-01T01:28:52.915756+0200 INFO ::1 [01/Mar/2024:01:28:52 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:29:21.736321+0200 INFO Bot stopped!
2024-03-01T01:29:25.416657+0200 INFO Bot started!
2024-03-01T01:29:39.440087+0200 INFO ::1 [01/Mar/2024:01:29:39 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:29:39.523317+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001E20AC95620>
    │       └ <function run at 0x000001E20259C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001E20AB75C40>
           │      └ <function Runner.run at 0x000001E20262C900>
           └ <asyncio.runners.Runner object at 0x000001E20AC02A10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001E20262A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001E20AC02A10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001E2026FA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001E20262C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001E20256DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1e20ac37210>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001E20AC954E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 78, in handle_add_channel
    for key, value in DEFAULT_CHANNEL_TOPPICS:
                      └ {'news': 'Новини', 'cryptocurrency': 'Криптовалюта', 'recruiting': 'Рекрутинг', 'meets': 'Знайомства', 'linguistics': 'Лінгві...

ValueError: too many values to unpack (expected 2)
2024-03-01T01:29:39.534463+0200 INFO ::1 [01/Mar/2024:01:29:39 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:29:56.107280+0200 INFO Bot stopped!
2024-03-01T01:29:59.615814+0200 INFO Bot started!
2024-03-01T01:30:12.469113+0200 INFO ::1 [01/Mar/2024:01:30:12 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:30:12.549803+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001AFC29A5620>
    │       └ <function run at 0x000001AFBA25C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001AFC2885C40>
           │      └ <function Runner.run at 0x000001AFBA2EC900>
           └ <asyncio.runners.Runner object at 0x000001AFC28DA750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001AFBA2EA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001AFC28DA750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001AFBA3CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001AFBA2EC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001AFBA22DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1afc2f323d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001AFC29A54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(**data_for_db)
          │    │            │             └ {'channel_title': 'ss', 'channel_owner_id': 387375605, 'channel_theme': None, 'custom_channel_theme': None, 'channel_invite_l...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x000001AFC26519E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000001AFC301BC10>
          └ <bot.db.Repo object at 0x000001AFC265CD90>

TypeError: ChannelRequestsRepo.add_channel() got an unexpected keyword argument 'channel_title'
2024-03-01T01:30:12.560338+0200 INFO ::1 [01/Mar/2024:01:30:12 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:30:48.717193+0200 INFO Bot stopped!
2024-03-01T01:30:52.448328+0200 INFO Bot started!
2024-03-01T01:31:05.286116+0200 INFO ::1 [01/Mar/2024:01:31:05 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:31:05.535135+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ ('zxcxz', 387375605, None, None, 'zxz', 2342, 23432, 345345, 345, 34, 345, '53345', '35', 'WAIT_FOR_PAYMENT')
    │    │             │             └ <function PreparedStatement.fetch at 0x000001F2AA1CDB20>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001F2AA964540>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ ('zxcxz', 387375605, None, None, 'zxz', 2342, 23432, 345345, 345, 34, 345, '53345', '35', 'WAIT_FOR_PAYMENT')
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001F2AA964540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001F2AA964540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x000001F2AA1F0730>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x000001F2AA960B80>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.NotNullViolationError: null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, zxcxz, 387375605, null, null, zxz, 2342, 23432, 345345, 345, 34, 345, 53345, 35, WAIT_FOR_PAYMENT).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001F2A9867880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001F2A9EEC0D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('zxcxz', 387375605, None, None, 'zxz', 2342, 23432, 345345, 345, 34, 345, '53345', '35', 'WAIT_FOR_PAYMENT')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001F2A9D6EC00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001F2AA5B1120>
           └ <_AsyncIoGreenlet object at 0x000001F2AA5E52C0 (otid=0x000001F2A9227930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001F2AA5B1120>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001F2A9D6EA20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Тематика канала" відношення "c...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, zxcxz, 387375605, null, null, zxz, 2342, 23432, 345345, 345, 34, 345, 53345, 35, WAIT_FOR_PAYMENT).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001F2AA105620>
    │       └ <function run at 0x000001F2A19BC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001F2A9FE5D40>
           │      └ <function Runner.run at 0x000001F2A1A4C900>
           └ <asyncio.runners.Runner object at 0x000001F2A7CA89D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001F2A1A4A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001F2A7CA89D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001F2A1B2A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001F2A1A4C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001F2A198DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1f2aa0e7c50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001F2AA1054E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(**data_for_db)
          │    │            │             └ {'channel_title': 'zxcxz', 'channel_owner_id': 387375605, 'channel_theme': None, 'custom_channel_theme': None, 'channel_invit...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x000001F2A9DB19E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000001F2AA689C90>
          └ <bot.db.Repo object at 0x000001F2A9EE4FD0>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 16, in add_channel
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000001F2AA77C7D0>
          │    │       └ <function AsyncSession.execute at 0x000001F2A9C51A80>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001F2AA8D4750>
          └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000001F2AA689C90>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001F2A9294040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001F2AA5E52C0 (otid=0x000001F2A9227930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001F2A9B7D8A0>
           └ <sqlalchemy.orm.session.Session object at 0x000001F2AA0D6A50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x000001F2A9B513A0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000001F2A97CFA60>
             └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x000001F2AA013710>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001F2A97CFD80>
           └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001F2A97CFF60>
          └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001F2A97D4040>
           └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001F2A97D42C0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Тематика канала" відношення "c...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError'>, IntegrityError('<class \'asyncpg.e...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>:...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001F2A9867880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001F2A9EEC0D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F2AA0A9A90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('zxcxz', 387375605, None, None, 'zxz', 2342, 23432, 345345, 345, 34, 345, '53345', '35', 'WAIT_FOR_PAYMENT')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001F2A9D6EC00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001F2AA5B1120>
           └ <_AsyncIoGreenlet object at 0x000001F2AA5E52C0 (otid=0x000001F2A9227930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001F2AA5B1120>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001F2A9D6EA20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001F2AA8B7C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Тематика канала" відношення "c...

sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "Тематика канала" відношення "channels" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, zxcxz, 387375605, null, null, zxz, 2342, 23432, 345345, 345, 34, 345, 53345, 35, WAIT_FOR_PAYMENT).
[SQL: INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на канал", "Количество подписчиков", "Процент мужчин", "Процент женщин", "Средний охват одной публикации", "Средний охват одной рекламной публикации", "Минимальная цена рекламы", "Комментарий", "Контакт", status) VALUES ($1::VARCHAR, $2::BIGINT, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::FLOAT, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::channelstatus) ON CONFLICT DO NOTHING RETURNING channels.id]
[parameters: ('zxcxz', 387375605, None, None, 'zxz', 2342, 23432, 345345, 345, 34, 345, '53345', '35', 'WAIT_FOR_PAYMENT')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-03-01T01:31:05.554529+0200 INFO ::1 [01/Mar/2024:01:31:05 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:31:47.637579+0200 INFO Bot stopped!
2024-03-01T01:31:51.138646+0200 INFO Bot started!
2024-03-01T01:31:58.564617+0200 INFO ::1 [01/Mar/2024:01:31:58 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:31:58.777650+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001D378985620>
    │       └ <function run at 0x000001D37026C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001D378865C40>
           │      └ <function Runner.run at 0x000001D3702FC900>
           └ <asyncio.runners.Runner object at 0x000001D378893D10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001D3702FA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001D378893D10>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001D3703CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001D3702FC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001D37023DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1d378929fd0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001D3789854E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 103, in handle_add_channel
    await bot.send_message(user_id, "<b>✅Канал успішно додано.</b>\n\nОчікуйте підтвердження адміністратора бота.")
          │   │            └ 387375605
          │   └ <function Bot.send_message at 0x000001D3761DAF20>
          └ <class 'aiogram.client.bot.Bot'>

TypeError: Bot.send_message() missing 1 required positional argument: 'text'
2024-03-01T01:31:58.789477+0200 INFO ::1 [01/Mar/2024:01:31:58 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:32:30.179641+0200 INFO Bot stopped!
2024-03-01T01:32:33.709662+0200 INFO Bot started!
2024-03-01T01:35:19.817463+0200 INFO ::1 [01/Mar/2024:01:35:19 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:35:19.917776+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000019F6DCF5620>
    │       └ <function run at 0x0000019F655BC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000019F6DBD1D40>
           │      └ <function Runner.run at 0x0000019F6564C900>
           └ <asyncio.runners.Runner object at 0x0000019F6DC41A90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000019F6564A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000019F6DC41A90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000019F6571A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000019F6564C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000019F6558DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x19f6e282250>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000019F6DCF54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 103, in handle_add_channel
    await bot.send_message(chat_id=user_id, text="<b>✅Канал успішно додано.</b>\n\nОчікуйте підтвердження адміністратора бота.")
          │   │                    └ 387375605
          │   └ <function Bot.send_message at 0x0000019F6B54AF20>
          └ <class 'aiogram.client.bot.Bot'>

TypeError: Bot.send_message() missing 1 required positional argument: 'self'
2024-03-01T01:35:19.925284+0200 INFO ::1 [01/Mar/2024:01:35:19 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:35:49.734490+0200 INFO Bot stopped!
2024-03-01T01:35:53.229075+0200 INFO Bot started!
2024-03-01T01:36:03.118128+0200 INFO ::1 [01/Mar/2024:01:36:03 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:36:03.253863+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ ('2', 387375605, 'news', None, 'D', 2, 2, 234, 1, 2, 3, '4', '5', 'WAIT_ADMIN_CONFIRM')
    │    │             │             └ <function PreparedStatement.fetch at 0x00000264CABA1B20>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x00000264CB32A980>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ ('2', 387375605, 'news', None, 'D', 2, 2, 234, 1, 2, 3, '4', '5', 'WAIT_ADMIN_CONFIRM')
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x00000264CB32A980>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x00000264CB32A980>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x00000264CABC0730>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x00000264CB330B80>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.InvalidTextRepresentationError: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000264CA237880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x00000264CAA77E90>
    └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('2', 387375605, 'news', None, 'D', 2, 2, 234, 1, 2, 3, '4', '5', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x00000264CA732C00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000264CB084040>
           └ <_AsyncIoGreenlet object at 0x00000264CAFB23C0 (otid=0x00000264C9BF7930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000264CB084040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x00000264CA732A20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
          └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000264CAAD5620>
    │       └ <function run at 0x00000264C238C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000264CA9B5E40>
           │      └ <function Runner.run at 0x00000264C241C900>
           └ <asyncio.runners.Runner object at 0x00000264CA8F2DD0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000264C241A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000264CA8F2DD0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000264C24FA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000264C241C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000264C235DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x264cb05e8d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x00000264CAAD54E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(**data_for_db)
          │    │            │             └ {'channel_title': '2', 'channel_owner_id': 387375605, 'channel_theme': 'news', 'custom_channel_theme': None, 'channel_invite_...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x00000264CA7819E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x00000264CAA40550>
          └ <bot.db.Repo object at 0x00000264CA8F1C90>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 16, in add_channel
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x00000264CAA37D50>
          │    │       └ <function AsyncSession.execute at 0x00000264CA61DA80>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000264CB2A1490>
          └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x00000264CAA40550>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x00000264C9C64040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x00000264CAFB23C0 (otid=0x00000264C9BF7930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x00000264CA54D8A0>
           └ <sqlalchemy.orm.session.Session object at 0x00000264CB056A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x00000264CA5213A0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x00000264CA19FA60>
             └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x00000264CAA19450>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x00000264CA19FD80>
           └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x00000264CA19FF60>
          └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x00000264CA1A4040>
           └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x00000264CA1A42C0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error'>, Error('<class \'asyncpg.exceptions.InvalidT...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ DBAPIError('(sqlalchemy.dialects.postgresql.asyncpg.Error) <class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неп...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000264CA237880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x00000264CAA77E90>
    └ <sqlalchemy.engine.base.Connection object at 0x00000264CB148510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('2', 387375605, 'news', None, 'D', 2, 2, 234, 1, 2, 3, '4', '5', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x00000264CA732C00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000264CB084040>
           └ <_AsyncIoGreenlet object at 0x00000264CAFB23C0 (otid=0x00000264C9BF7930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000264CB084040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x00000264CA732A20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000264CB287700>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
          └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...

sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"
[SQL: INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на канал", "Количество подписчиков", "Процент мужчин", "Процент женщин", "Средний охват одной публикации", "Средний охват одной рекламной публикации", "Минимальная цена рекламы", "Комментарий", "Контакт", status) VALUES ($1::VARCHAR, $2::BIGINT, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::FLOAT, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::channelstatus) ON CONFLICT DO NOTHING RETURNING channels.id]
[parameters: ('2', 387375605, 'news', None, 'D', 2, 2, 234, 1, 2, 3, '4', '5', 'WAIT_ADMIN_CONFIRM')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2024-03-01T01:36:03.269860+0200 INFO ::1 [01/Mar/2024:01:36:03 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:36:11.484584+0200 INFO Bot stopped!
2024-03-01T01:37:15.584795+0200 INFO Bot started!
2024-03-01T01:37:30.189321+0200 INFO ::1 [01/Mar/2024:01:37:30 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:37:30.287941+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ ('3', 387375605, 'news', None, '4', 5, 5, 7, 6, 8, 9, '0-', '9', 'WAIT_ADMIN_CONFIRM')
    │    │             │             └ <function PreparedStatement.fetch at 0x000002D2A3451B20>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002D2A2F3B740>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ ('3', 387375605, 'news', None, '4', 5, 5, 7, 6, 8, 9, '0-', '9', 'WAIT_ADMIN_CONFIRM')
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002D2A2F3B740>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002D2A2F3B740>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x000002D2A3470730>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x000002D2A3BE0B80>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.InvalidTextRepresentationError: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002D2A2AE7880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000002D2A32929D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('3', 387375605, 'news', None, '4', 5, 5, 7, 6, 8, 9, '0-', '9', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000002D2A2FE6C00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002D2A3934EE0>
           └ <_AsyncIoGreenlet object at 0x000002D2A39FC400 (otid=0x000002D2A24AB8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002D2A3934EE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000002D2A2FE6A20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
          └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000002D2A3389620>
    │       └ <function run at 0x000002D29ACAC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000002D2A3265E40>
           │      └ <function Runner.run at 0x000002D29AD3C900>
           └ <asyncio.runners.Runner object at 0x000002D2A2B4D790>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002D29AD3A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002D2A2B4D790>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002D29AE0A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002D29AD3C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002D29AC7DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x2d2a390e890>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000002D2A33894E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(**data_for_db)
          │    │            │             └ {'channel_title': '3', 'channel_owner_id': 387375605, 'channel_theme': 'news', 'custom_channel_theme': None, 'channel_invite_...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x000002D2A30319E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000002D2A32F3210>
          └ <bot.db.Repo object at 0x000002D2A3368110>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 16, in add_channel
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000002D2A32F1ED0>
          │    │       └ <function AsyncSession.execute at 0x000002D2A2ECDA80>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000002D2A38CBB90>
          └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000002D2A32F3210>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000002D2A2514040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000002D2A39FC400 (otid=0x000002D2A24AB8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000002D2A2DFD8A0>
           └ <sqlalchemy.orm.session.Session object at 0x000002D2A3A162D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x000002D2A2DD13A0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000002D2A2A4FA60>
             └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x000002D2A32F1C10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002D2A2A4FD80>
           └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002D2A2A4FF60>
          └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000002D2A2A54040>
           └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002D2A2A542C0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error'>, Error('<class \'asyncpg.exceptions.InvalidT...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ DBAPIError('(sqlalchemy.dialects.postgresql.asyncpg.Error) <class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неп...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002D2A2AE7880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000002D2A32929D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D2A39EF990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('3', 387375605, 'news', None, '4', 5, 5, 7, 6, 8, 9, '0-', '9', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000002D2A2FE6C00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002D2A3934EE0>
           └ <_AsyncIoGreenlet object at 0x000002D2A39FC400 (otid=0x000002D2A24AB8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002D2A3934EE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000002D2A2FE6A20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002D2A3456F80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ InvalidTextRepresentationError('неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"')
          └ Error('<class \'asyncpg.exceptions.InvalidTextRepresentationError\'>: неприпустиме вхідне значення для переліку channelstatus...

sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: неприпустиме вхідне значення для переліку channelstatus: "WAIT_ADMIN_CONFIRM"
[SQL: INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на канал", "Количество подписчиков", "Процент мужчин", "Процент женщин", "Средний охват одной публикации", "Средний охват одной рекламной публикации", "Минимальная цена рекламы", "Комментарий", "Контакт", status) VALUES ($1::VARCHAR, $2::BIGINT, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::FLOAT, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::channelstatus) ON CONFLICT DO NOTHING RETURNING channels.id]
[parameters: ('3', 387375605, 'news', None, '4', 5, 5, 7, 6, 8, 9, '0-', '9', 'WAIT_ADMIN_CONFIRM')]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2024-03-01T01:37:30.303091+0200 INFO ::1 [01/Mar/2024:01:37:30 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:37:30.599173+0200 INFO ::1 [01/Mar/2024:01:37:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:37:30.884699+0200 INFO Update id=925011857 is handled. Duration 280 ms by bot id=5646878393
2024-03-01T01:38:39.409186+0200 INFO Bot stopped!
2024-03-01T01:39:39.073529+0200 INFO Bot started!
2024-03-01T01:39:48.037981+0200 INFO ::1 [01/Mar/2024:01:39:48 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:39:48.244774+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ ('2123', 387375605, 'news', None, '2', 3, 4, 5, 6, 7, 8, '89', '23', 'WAIT_ADMIN_CONFIRM')
    │    │             │             └ <function PreparedStatement.fetch at 0x000001BE47831B20>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001BE47FC9EE0>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ ('2123', 387375605, 'news', None, '2', 3, 4, 5, 6, 7, 8, '89', '23', 'WAIT_ADMIN_CONFIRM')
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001BE47FC9EE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001BE47FC9EE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x000001BE47850730>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x000001BE47FD3600>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.ForeignKeyViolationError: insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца канала_fkey"
DETAIL:  Ключ (ID владельца канала)=(387375605) не присутній в таблиці "users".


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001BE46EC7880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001BE476D3F50>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('2123', 387375605, 'news', None, '2', 3, 4, 5, 6, 7, 8, '89', '23', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001BE473CAC00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001BE47D50160>
           └ <_AsyncIoGreenlet object at 0x000001BE47553A00 (otid=0x000001BE46887930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001BE47D50160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001BE473CAA20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ ForeignKeyViolationError('insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца к...
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ ForeignKeyViolationError('insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца к...
          └ IntegrityError('<class \'asyncpg.exceptions.ForeignKeyViolationError\'>: insert або update в таблиці "channels" порушує обмеж...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца канала_fkey"
DETAIL:  Ключ (ID владельца канала)=(387375605) не присутній в таблиці "users".


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BE47765620>
    │       └ <function run at 0x000001BE3F01C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BE47645E40>
           │      └ <function Runner.run at 0x000001BE3F0AC900>
           └ <asyncio.runners.Runner object at 0x000001BE47672450>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BE3F0AA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BE47672450>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BE3F18A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BE3F0AC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BE3EFEDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x1be47748290>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x000001BE477654E0>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 101, in handle_add_channel
    await repo.channel_repo.add_channel(**data_for_db)
          │    │            │             └ {'channel_title': '2123', 'channel_owner_id': 387375605, 'channel_theme': 'news', 'custom_channel_theme': None, 'channel_invi...
          │    │            └ <function ChannelRequestsRepo.add_channel at 0x000001BE474119E0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000001BE47573610>
          └ <bot.db.Repo object at 0x000001BE47C5B790>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 16, in add_channel
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000001BE47705F90>
          │    │       └ <function AsyncSession.execute at 0x000001BE472B1A80>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001BE47E0B150>
          └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000001BE47573610>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000001BE468F4040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001BE47553A00 (otid=0x000001BE46887930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001BE471DD8A0>
           └ <sqlalchemy.orm.session.Session object at 0x000001BE47E0A610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x000001BE471B13A0>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000001BE46E2FA60>
             └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x000001BE47672C50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001BE46E2FD80>
           └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001BE46E2FF60>
          └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001BE46E34040>
           └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001BE46E342C0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError('<class \'asyncpg.exceptions.ForeignKeyViolationError\'>: insert або update в таблиці "channels" порушує обмеж...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError'>, IntegrityError('<class \'asyncpg.e...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.ForeignKeyViolationError\...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001BE46EC7880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001BE476D3F50>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE47DF55D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ('2123', 387375605, 'news', None, '2', 3, 4, 5, 6, 7, 8, '89', '23', 'WAIT_ADMIN_CONFIRM')
    │      │       └ 'INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на ка...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001BE473CAC00>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001BE47D50160>
           └ <_AsyncIoGreenlet object at 0x000001BE47553A00 (otid=0x000001BE46887930) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001BE47D50160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001BE473CAA20>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ ForeignKeyViolationError('insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца к...
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001BE47443A60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ ForeignKeyViolationError('insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца к...
          └ IntegrityError('<class \'asyncpg.exceptions.ForeignKeyViolationError\'>: insert або update в таблиці "channels" порушує обмеж...

sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert або update в таблиці "channels" порушує обмеження зовнішнього ключа "channels_ID владельца канала_fkey"
DETAIL:  Ключ (ID владельца канала)=(387375605) не присутній в таблиці "users".
[SQL: INSERT INTO channels ("Название канала", "ID владельца канала", "Тематика канала", "Кастомна Тематика канала", "Ссылка на канал", "Количество подписчиков", "Процент мужчин", "Процент женщин", "Средний охват одной публикации", "Средний охват одной рекламной публикации", "Минимальная цена рекламы", "Комментарий", "Контакт", status) VALUES ($1::VARCHAR, $2::BIGINT, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::BIGINT, $7::FLOAT, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::channelstatus) ON CONFLICT DO NOTHING RETURNING channels.id]
[parameters: ('2123', 387375605, 'news', None, '2', 3, 4, 5, 6, 7, 8, '89', '23', 'WAIT_ADMIN_CONFIRM')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-03-01T01:39:48.262790+0200 INFO ::1 [01/Mar/2024:01:39:48 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:40:17.454544+0200 INFO ::1 [01/Mar/2024:01:40:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:40:17.749287+0200 INFO Update id=925011858 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T01:40:28.386402+0200 INFO ::1 [01/Mar/2024:01:40:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:40:28.514895+0200 INFO Update id=925011859 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:40:29.514168+0200 INFO ::1 [01/Mar/2024:01:40:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:40:29.517445+0200 ERROR Cannot get window data for state <State 'ChannelPosterOwnerMenu:select_channel_topic'>
2024-03-01T01:40:29.518545+0200 INFO Update id=925011860 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T01:40:29.523981+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=ValueError('too many values to unpack (expected 2)')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001BE47542710>
                   │    │          │                   │           └ {'update_id': 925011860, 'callback_query': {'id': '1663765555154417579', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001BE477F4C90>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001BE4502B1A0>
                   │    └ <Dispatcher '0x1be47705910'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001BE47542710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001BE477F4C90>
                 │    └ <function Dispatcher.feed_update at 0x000001BE4502B100>
                 └ <Dispatcher '0x1be47705910'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001BE45029940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001BE47C22310>
                     └ <Dispatcher '0x1be47705910'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001BE47585A50>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001BE476ED710>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001BE483FB3C0>
          │    │   │      │    └ ValueError('too many values to unpack (expected 2)')
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001BE47CDE980>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001BE47DE7C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001BE476D22D0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001BE481507C0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001BE476D0E10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001BE476EE6D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011860, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001BE48150680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1be47705910'>>, Update(update_id=925011860, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001BE4502A700>
                 └ <Dispatcher '0x1be47705910'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001BE47E5B7E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001BE45029940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001BE47C210D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001BE4502A7A0>
                 └ <Dispatcher '0x1be47705910'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001BE4502A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001BE47FD37E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001BE45029940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001BE47C38050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001BE47D1D550>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001BE47FD2980>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001BE4502A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001BE4502A700>
                     └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001BE481F7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001BE45029940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001BE47CDB290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001BE4502A7A0>
                 └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001BE45029A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001BE47CDB290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001BE4683ACD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001BE476EE6D0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001BE47572350>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001BE4544F100>, <function CallableObject.call at 0x000001BE481F7...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001BE481F7CE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
          │      │                └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001BE454ADBC0>
          └ <Window(<State 'ChannelOwnerMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001BE45286D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001BE47CDA250>
          └ <Window(<State 'ChannelOwnerMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001BE45422020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001BE47CDA250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001BE45286D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001BE47CDA090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001BE45422020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001BE47CDA090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelOwnerMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001BE45286D40>
             └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000001BE452879C0>
                 └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
          │    │        │             └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001BE45284EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001BE47CD9FD0>
          └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
          │    │        │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
          │    │        └ CallbackQuery(id='1663765555154417579', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <bound method Start._on_click of <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001BE47CD9FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\state.py", line 165, in _on_click
    await manager.start(self.state, self.start_data, self.mode)
          │       │     │    │      │    │           │    └ <StartMode.NORMAL: 'NORMAL'>
          │       │     │    │      │    │           └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
          │       │     │    │      │    └ None
          │       │     │    │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
          │       │     │    └ <State 'ChannelPosterOwnerMenu:select_channel_topic'>
          │       │     └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001BE47CD9ED0>
          │       └ <function ManagerImpl.start at 0x000001BE45496C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'ChannelPosterOwnerMenu:select_channel_topic'>
          │    └ <function ManagerImpl._start_normal at 0x000001BE45496DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001BE454971A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
                        │    └ <function ManagerImpl.dialog at 0x000001BE45496520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
                        │      │      └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
                        │      └ <function Window.render at 0x000001BE454ADC60>
                        └ <Window(<State 'ChannelPosterOwnerMenu:select_channel_topic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
                         │    │         └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
                         │    └ <function Window.load_data at 0x000001BE454ADA80>
                         └ <Window(<State 'ChannelPosterOwnerMenu:select_channel_topic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001BE45498AE0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001BE4816CC50>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001BE47CFB690>
    │    │            └ <Window(<State 'ChannelPosterOwnerMenu:select_channel_topic'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x1be47705910'>, 'session_pool': async_session...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_channel_themes at 0x000001BE475B8860>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001BE47CFB690>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_owner_menu\getters.py", line 57, in get_channel_themes
    'channel_topics': [(topic_key, topic_value) for topic_key, topic_value in DEFAULT_CHANNEL_TOPPICS]
                                                                              └ {'news': 'Новини', 'cryptocurrency': 'Криптовалюта', 'recruiting': 'Рекрутинг', 'meets': 'Знайомства', 'linguistics': 'Лінгві...

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_owner_menu\getters.py", line 57, in <listcomp>
    'channel_topics': [(topic_key, topic_value) for topic_key, topic_value in DEFAULT_CHANNEL_TOPPICS]
                                                                              └ {'news': 'Новини', 'cryptocurrency': 'Криптовалюта', 'recruiting': 'Рекрутинг', 'meets': 'Знайомства', 'linguistics': 'Лінгві...

ValueError: too many values to unpack (expected 2)
2024-03-01T01:40:54.893951+0200 INFO Bot stopped!
2024-03-01T01:40:58.387077+0200 INFO Bot started!
2024-03-01T01:41:00.431842+0200 INFO ::1 [01/Mar/2024:01:41:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:00.591642+0200 INFO Update id=925011861 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T01:41:02.612379+0200 INFO ::1 [01/Mar/2024:01:41:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:02.736043+0200 INFO Update id=925011862 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:41:05.552429+0200 INFO ::1 [01/Mar/2024:01:41:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:05.699537+0200 INFO Update id=925011863 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:41:07.129742+0200 INFO ::1 [01/Mar/2024:01:41:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:07.291336+0200 INFO Update id=925011864 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T01:41:07.964937+0200 INFO ::1 [01/Mar/2024:01:41:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:08.177026+0200 INFO Update id=925011865 is handled. Duration 217 ms by bot id=5646878393
2024-03-01T01:41:09.757054+0200 INFO ::1 [01/Mar/2024:01:41:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:09.760675+0200 ERROR Cannot get window data for state <State 'ChannelPosterOwnerMenu:show_channels'>
2024-03-01T01:41:09.761675+0200 INFO Update id=925011866 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T01:41:09.765673+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-42' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('selected_topic')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001F010BFEA50>
                   │    │          │                   │           └ {'update_id': 925011866, 'callback_query': {'id': '1663765555188812159', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001F0104635D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001F00DF3B1A0>
                   │    └ <Dispatcher '0x1f0105834d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001F010BFEA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001F0104635D0>
                 │    └ <function Dispatcher.feed_update at 0x000001F00DF3B100>
                 └ <Dispatcher '0x1f0105834d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F00DF39940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F010B24B50>
                     └ <Dispatcher '0x1f0105834d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001F0106BD390>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001F010B252D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001F010615480>
          │    │   │      │    └ KeyError('selected_topic')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001F010C40400>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001F010F273D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001F010B25690>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001F010EB9C60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001F010B30790>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001F010460710>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011866, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001F010EB9940>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1f0105834d0'>>, Update(update_id=925011866, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001F00DF3A700>
                 └ <Dispatcher '0x1f0105834d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001F010EB8C20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F00DF39940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F010B1B110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F00DF3A7A0>
                 └ <Dispatcher '0x1f0105834d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001F00DF3A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001F010EB8CC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F00DF39940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F010B26710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001F010BFF850>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001F010EB8720>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F00DF3A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001F00DF3A700>
                     └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001F010EB8680>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F00DF39940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F010BEACD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F00DF3A7A0>
                 └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001F00DF39A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F010BEACD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001F010B307D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001F010460710>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001F010BFF610>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001F00E35F100>, <function CallableObject.call at 0x000001F010EB8...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1f0105834d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765555188812159', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001F010EB8D60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001F00E3A71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
                        │    └ <function ManagerImpl.dialog at 0x000001F00E3A6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
                        │      │      └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
                        │      └ <function Window.render at 0x000001F00E3BDC60>
                        └ <Window(<State 'ChannelPosterOwnerMenu:show_channels'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
                         │    │         └ <Dialog(<StatesGroup 'ChannelPosterOwnerMenu'>)>
                         │    └ <function Window.load_data at 0x000001F00E3BDA80>
                         └ <Window(<State 'ChannelPosterOwnerMenu:show_channels'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001F00E3A8900>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001F010BE9E50>
    │    │            └ <Window(<State 'ChannelPosterOwnerMenu:show_channels'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_channel_topic': 'recruiting'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x1f0105...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_channels_in_theme at 0x000001F0104C8900>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001F010BE9E50>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_owner_menu\getters.py", line 62, in get_channels_in_theme
    selected_topic = dialog_manager.dialog_data['selected_topic']
                     │              └ <property object at 0x000001F00E3A9C10>
                     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F010F25510>

KeyError: 'selected_topic'
2024-03-01T01:41:49.247366+0200 INFO Bot stopped!
2024-03-01T01:41:52.871162+0200 INFO Bot started!
2024-03-01T01:41:53.701249+0200 INFO ::1 [01/Mar/2024:01:41:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:53.858183+0200 INFO Update id=925011867 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T01:41:54.623926+0200 INFO ::1 [01/Mar/2024:01:41:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:54.740116+0200 INFO Update id=925011868 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:41:57.702426+0200 INFO ::1 [01/Mar/2024:01:41:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:57.822732+0200 INFO Update id=925011869 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:41:58.473560+0200 INFO ::1 [01/Mar/2024:01:41:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:41:58.595080+0200 INFO Update id=925011870 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:42:26.933539+0200 INFO Bot stopped!
2024-03-01T01:42:30.508045+0200 INFO Bot started!
2024-03-01T01:42:31.330797+0200 INFO ::1 [01/Mar/2024:01:42:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:31.466492+0200 INFO Update id=925011871 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:42:32.226157+0200 INFO ::1 [01/Mar/2024:01:42:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:32.355183+0200 INFO Update id=925011872 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:42:33.456784+0200 INFO ::1 [01/Mar/2024:01:42:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:33.582296+0200 INFO Update id=925011873 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:42:34.569518+0200 INFO ::1 [01/Mar/2024:01:42:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:34.745182+0200 INFO Update id=925011874 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T01:42:35.812875+0200 INFO ::1 [01/Mar/2024:01:42:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:35.944620+0200 INFO Update id=925011875 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:42:36.962758+0200 INFO ::1 [01/Mar/2024:01:42:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:37.064474+0200 INFO Update id=925011876 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:42:37.617887+0200 INFO ::1 [01/Mar/2024:01:42:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:37.790503+0200 INFO Update id=925011877 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T01:42:38.107209+0200 INFO ::1 [01/Mar/2024:01:42:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:38.270511+0200 INFO Update id=925011878 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T01:42:39.244232+0200 INFO ::1 [01/Mar/2024:01:42:39 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:39.382749+0200 INFO Update id=925011879 is handled. Duration 139 ms by bot id=5646878393
2024-03-01T01:42:40.801698+0200 INFO ::1 [01/Mar/2024:01:42:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:41.024289+0200 INFO Update id=925011880 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T01:42:42.251786+0200 INFO ::1 [01/Mar/2024:01:42:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:42.399671+0200 INFO Update id=925011881 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:42:46.059035+0200 INFO ::1 [01/Mar/2024:01:42:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:42:46.061634+0200 ERROR Cannot get window data for state <State 'ChannelPosterAdminMenu:select_channel'>
2024-03-01T01:42:46.062633+0200 INFO Update id=925011882 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T01:42:46.066636+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-80' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError("'NoneType' object is not iterable")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000022550585C10>
                   │    │          │                   │           └ {'update_id': 925011882, 'callback_query': {'id': '1663765555091114508', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000225502C54D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002254DDAB1A0>
                   │    └ <Dispatcher '0x225504675d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000022550585C10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000225502C54D0>
                 │    └ <function Dispatcher.feed_update at 0x000002254DDAB100>
                 └ <Dispatcher '0x225504675d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002254DDA9940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022550994C10>
                     └ <Dispatcher '0x225504675d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002255041E310>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000225503F2C90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000022550E6C680>
          │    │   │      │    └ TypeError("'NoneType' object is not iterable")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000022550AB32E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000022550D68990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000022550585B10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000022550E1B1A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000022550300690>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000225502F0F90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011882, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000225505EB9C0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x225504675d0'>>, Update(update_id=925011882, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000002254DDAA700>
                 └ <Dispatcher '0x225504675d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000225505E8720>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002254DDA9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022550467810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002254DDAA7A0>
                 └ <Dispatcher '0x225504675d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000002254DDAA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000022550E1A340>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002254DDA9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022550996610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000022550A73050>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000022550D2B7E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002254DDAA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000002254DDAA700>
                     └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000022550D28900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002254DDA9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022550A1D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002254DDAA7A0>
                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000002254DDA9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022550A1D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000225502F3D50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000225502F0F90>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000022550A72ED0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000002254E1CF100>, <function CallableObject.call at 0x0000022550D29...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x225504675d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765555091114508', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000022550D291C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000002254E2171A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
                        │    └ <function ManagerImpl.dialog at 0x000002254E216520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
                        │      │      └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                        │      └ <function Window.render at 0x000002254E22DC60>
                        └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
                         │    │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                         │    └ <function Window.load_data at 0x000002254E22DA80>
                         └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000002254E218A40>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022550E5FB10>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000022550A1C310>
    │    │            └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_channel_theme': 'cryptocurrency'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x22...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offers_with_theme at 0x000002255031FBA0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000022550A1C310>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 125, in get_offers_with_theme
    'channels_list': [

TypeError: 'NoneType' object is not iterable
2024-03-01T01:43:18.052236+0200 INFO Bot stopped!
2024-03-01T01:43:21.586451+0200 INFO Bot started!
2024-03-01T01:43:34.250152+0200 INFO Bot stopped!
2024-03-01T01:43:37.738296+0200 INFO Bot started!
2024-03-01T01:43:37.772011+0200 INFO ::1 [01/Mar/2024:01:43:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:43:37.916183+0200 INFO Update id=925011883 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:43:41.694737+0200 INFO ::1 [01/Mar/2024:01:43:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:43:41.913202+0200 INFO Update id=925011884 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T01:43:42.491554+0200 INFO ::1 [01/Mar/2024:01:43:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:43:42.495275+0200 ERROR Cannot render window for state <State 'ChannelPosterAdminMenu:select_channel'>
2024-03-01T01:43:42.496278+0200 INFO Update id=925011885 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T01:43:42.500277+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('offers')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000225E2DD6390>
                   │    │          │                   │           └ {'update_id': 925011885, 'callback_query': {'id': '1663765557090865056', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000225E27E9F10>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000225E010B1A0>
                   │    └ <Dispatcher '0x225e2793650'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000225E2DD6390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000225E27E9F10>
                 │    └ <function Dispatcher.feed_update at 0x00000225E010B100>
                 └ <Dispatcher '0x225e2793650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000225E0109940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000225E27D0BD0>
                     └ <Dispatcher '0x225e2793650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000225E2652350>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000225E2653050>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000225E3101640>
          │    │   │      │    └ KeyError('offers')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000225E2E12200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000225E2DD6F50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000225E2751C10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000225E3088720>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000225E2660990>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000225E27074D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011885, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000225E3089BC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x225e2793650'>>, Update(update_id=925011885, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000225E010A700>
                 └ <Dispatcher '0x225e2793650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000225E308A340>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000225E0109940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000225E2CEE810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000225E010A7A0>
                 └ <Dispatcher '0x225e2793650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000225E010A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000225E3088B80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000225E0109940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000225E2CF5C10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000225E2DD6850>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000225E3088EA0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000225E010A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000225E010A700>
                     └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000225E30889A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000225E0109940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000225E2D80910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000225E010A7A0>
                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000225E0109A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000225E2D80910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000225E28D4310>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000225E27074D0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000225E288D690>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000225E052F100>, <function CallableObject.call at 0x00000225E3088...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x225e2793650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557090865056', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000225E30887C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000225E05771A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                        │    └ <function ManagerImpl.dialog at 0x00000225E0576520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                        │      │      └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                        │      └ <function Window.render at 0x00000225E058DC60>
                        └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 118, in render
    reply_markup=await self.render_kbd(current_data, manager),
                       │    │          │             └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                       │    │          └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                       │    └ <function Window.render_kbd at 0x00000225E058D9E0>
                       └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 75, in render_kbd
    keyboard = await self.keyboard.render_keyboard(data, manager)
                     │    │        │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                     │    │        │               └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                     │    │        └ <function Keyboard.render_keyboard at 0x00000225E0366A20>
                     │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000225E2D7F890>
                     └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                 │    │                └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                 │    └ <function Group._render_keyboard at 0x00000225E0501EE0>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000225E2D7F890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                  │ │               └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                  │ └ <function Keyboard.render_keyboard at 0x00000225E0366A20>
                  └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x00000225E2D7F650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                 │    │                └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                 │    └ <function ScrollingGroup._render_keyboard at 0x00000225E05156C0>
                 └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x00000225E2D7F650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 101, in _render_keyboard
    keyboard = await self._render_contents(data, manager)
                     │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                     │    │                └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                     │    └ <function ScrollingGroup._render_contents at 0x00000225E05154E0>
                     └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x00000225E2D7F650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 43, in _render_contents
    return await super()._render_keyboard(data, manager)
                                          │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                                          └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                  │ │               └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                  │ └ <function Keyboard.render_keyboard at 0x00000225E0366A20>
                  └ <aiogram_dialog.widgets.kbd.select.Select object at 0x00000225E2D7F610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000225E2DF2F10>
                 │    │                └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                 │    └ <function Select._render_keyboard at 0x00000225E0515DA0>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x00000225E2D7F610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 87, in _render_keyboard
    for pos, item in enumerate(self.items_getter(data))
                               │    │            └ {'dialog_data': {'selected_channel_theme': 'sport'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x225e2793650...
                               │    └ operator.itemgetter('offers')
                               └ <aiogram_dialog.widgets.kbd.select.Select object at 0x00000225E2D7F610>

KeyError: 'offers'
2024-03-01T01:43:57.213131+0200 INFO Bot stopped!
2024-03-01T01:44:00.848695+0200 INFO Bot started!
2024-03-01T01:44:01.883698+0200 INFO ::1 [01/Mar/2024:01:44:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:02.054525+0200 INFO Update id=925011886 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T01:44:02.799655+0200 INFO ::1 [01/Mar/2024:01:44:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:02.921214+0200 INFO Update id=925011887 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:44:03.579997+0200 INFO ::1 [01/Mar/2024:01:44:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:03.711387+0200 INFO Update id=925011888 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:44:47.355028+0200 INFO Bot stopped!
2024-03-01T01:44:50.755240+0200 INFO Bot started!
2024-03-01T01:44:51.494199+0200 INFO ::1 [01/Mar/2024:01:44:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:51.635200+0200 INFO Update id=925011889 is handled. Duration 139 ms by bot id=5646878393
2024-03-01T01:44:52.310981+0200 INFO ::1 [01/Mar/2024:01:44:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:52.434670+0200 INFO Update id=925011890 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:44:53.084013+0200 INFO ::1 [01/Mar/2024:01:44:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:53.204065+0200 INFO Update id=925011891 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:44:53.904206+0200 INFO ::1 [01/Mar/2024:01:44:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:54.020013+0200 INFO Update id=925011892 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:44:54.580461+0200 INFO ::1 [01/Mar/2024:01:44:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:54.749461+0200 INFO Update id=925011893 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T01:44:58.150162+0200 INFO ::1 [01/Mar/2024:01:44:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:58.268332+0200 INFO Update id=925011894 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:44:59.683065+0200 INFO ::1 [01/Mar/2024:01:44:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:44:59.827402+0200 INFO Update id=925011895 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:45:00.424001+0200 INFO ::1 [01/Mar/2024:01:45:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:45:00.648837+0200 INFO Update id=925011896 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T01:46:03.070273+0200 INFO Bot stopped!
2024-03-01T01:46:06.519279+0200 INFO Bot started!
2024-03-01T01:46:07.644969+0200 INFO ::1 [01/Mar/2024:01:46:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:46:07.797076+0200 INFO Update id=925011897 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:46:08.519342+0200 INFO ::1 [01/Mar/2024:01:46:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:46:08.666717+0200 INFO Update id=925011898 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:46:10.338548+0200 INFO ::1 [01/Mar/2024:01:46:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:46:10.459590+0200 INFO Update id=925011899 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:46:11.130085+0200 INFO ::1 [01/Mar/2024:01:46:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:46:11.251141+0200 INFO Update id=925011900 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:46:12.559883+0200 INFO ::1 [01/Mar/2024:01:46:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:46:12.565280+0200 ERROR Cannot get window data for state <State 'ChannelAdminPersonalCabinet:select_offer_status'>
2024-03-01T01:46:12.566280+0200 INFO Update id=925011901 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T01:46:12.571276+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-36' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'list' object has no attribute 'money_reserved'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E472FC2310>
                   │    │          │                   │           └ {'update_id': 925011901, 'callback_query': {'id': '1663765556585957315', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001E4731EF790>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001E470A6B1A0>
                   │    └ <Dispatcher '0x1e47312e990'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E472FC2310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001E4731EF790>
                 │    └ <function Dispatcher.feed_update at 0x000001E470A6B100>
                 └ <Dispatcher '0x1e47312e990'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E470A69940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E472E70C90>
                     └ <Dispatcher '0x1e47312e990'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001E4731ED390>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001E472E71F10>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001E473A4E800>
          │    │   │      │    └ AttributeError("'list' object has no attribute 'money_reserved'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001E473772200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001E4737568D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001E473659250>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001E4739E8A40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E473664390>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E472F85E10>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011901, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001E4739E9940>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1e47312e990'>>, Update(update_id=925011901, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001E470A6A700>
                 └ <Dispatcher '0x1e47312e990'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E4739E8B80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E470A69940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E4730DE3D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E470A6A7A0>
                 └ <Dispatcher '0x1e47312e990'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001E470A6A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E4739E8EA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E470A69940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E47365A290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001E4737371D0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E4739E8D60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E470A6A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001E470A6A700>
                     └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E4739E8900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E470A69940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E4736BF790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E470A6A7A0>
                 └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E470A69A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E4736BF790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E472FA3D10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E472F85E10>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001E4731ED9D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001E470E8F100>, <function CallableObject.call at 0x000001E4739E8...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001E4739E8720>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
          │      │                └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001E470EEDBC0>
          └ <Window(<State 'ChannelAdminMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001E470CC6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E4736BE790>
          └ <Window(<State 'ChannelAdminMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001E470E62020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E4736BE790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001E470CC6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E4736BE5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001E470E62020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E4736BE5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001E470CC6D40>
             └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000001E470CC79C0>
                 └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
          │    │        │             └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001E470CC4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001E4736BE610>
          └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
          │    │        └ CallbackQuery(id='1663765556585957315', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <bound method Start._on_click of <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001E4736BE610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\state.py", line 165, in _on_click
    await manager.start(self.state, self.start_data, self.mode)
          │       │     │    │      │    │           │    └ <StartMode.NORMAL: 'NORMAL'>
          │       │     │    │      │    │           └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
          │       │     │    │      │    └ None
          │       │     │    │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
          │       │     │    └ <State 'ChannelAdminPersonalCabinet:select_offer_status'>
          │       │     └ <aiogram_dialog.widgets.kbd.state.Start object at 0x000001E4736BE550>
          │       └ <function ManagerImpl.start at 0x000001E470ED6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'ChannelAdminPersonalCabinet:select_offer_status'>
          │    └ <function ManagerImpl._start_normal at 0x000001E470ED6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001E470ED71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
                        │    └ <function ManagerImpl.dialog at 0x000001E470ED6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
                        │      │      └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                        │      └ <function Window.render at 0x000001E470EEDC60>
                        └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
                         │    │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                         │    └ <function Window.load_data at 0x000001E470EEDA80>
                         └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001E470ED8AE0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E473A519D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001E4736C6E50>
    │    │            └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x1e47312e990'>, 'session_pool': async_session...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_personal_cabinet_data at 0x000001E472FDFB00>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001E4736C6E50>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 114, in get_personal_cabinet_data
    all_reserved_money = [order.money_reserved for order in user_offers]
                                                            └ ([],)

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 114, in <listcomp>
    all_reserved_money = [order.money_reserved for order in user_offers]
                          │                        └ []
                          └ []

AttributeError: 'list' object has no attribute 'money_reserved'
2024-03-01T01:48:05.582890+0200 INFO Bot stopped!
2024-03-01T01:48:09.130099+0200 INFO Bot started!
2024-03-01T01:48:09.872386+0200 INFO ::1 [01/Mar/2024:01:48:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:48:09.894529+0200 ERROR Cannot get window data for state <State 'ChannelAdminPersonalCabinet:select_offer_status'>
2024-03-01T01:48:09.896529+0200 INFO Update id=925011902 is not handled. Duration 30 ms by bot id=5646878393
2024-03-01T01:48:09.900530+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'list' object has no attribute 'money_reserved'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000284E4443150>
                   │    │          │                   │           └ {'update_id': 925011902, 'callback_query': {'id': '1663765556562750934', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000284E3E21D90>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000284E177B1A0>
                   │    └ <Dispatcher '0x284e3df6210'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000284E4443150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000284E3E21D90>
                 │    └ <function Dispatcher.feed_update at 0x00000284E177B100>
                 └ <Dispatcher '0x284e3df6210'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000284E1779940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000284E3CD8C90>
                     └ <Dispatcher '0x284e3df6210'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000284E3E21F10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000284E3C8FE50>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000284E4751200>
          │    │   │      │    └ AttributeError("'list' object has no attribute 'money_reserved'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000284E4486200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000284E3C94590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000284E4369910>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000284E46FC180>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000284E4374950>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000284E3DF5C50>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011902, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000284E46FCD60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x284e3df6210'>>, Update(update_id=925011902, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000284E177A700>
                 └ <Dispatcher '0x284e3df6210'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000284E46FCA40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000284E1779940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000284E435B550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000284E177A7A0>
                 └ <Dispatcher '0x284e3df6210'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000284E177A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000284E46FCCC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000284E1779940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000284E436A810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000284E44435D0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000284E46FC720>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000284E177A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000284E177A700>
                     └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000284E46FD080>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000284E1779940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000284E43CBD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000284E177A7A0>
                 └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000284E1779A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000284E43CBD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000284E3B84C90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000284E3DF5C50>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000284E3DF71D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000284E1B9F100>, <function CallableObject.call at 0x00000284E46FC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000284E46FCEA0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
          │      │                └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x00000284E1BFDBC0>
          └ <Window(<State 'ChannelAdminMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x00000284E19D6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000284E43CAD10>
          └ <Window(<State 'ChannelAdminMainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000284E1B72020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000284E43CAD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000284E19D6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000284E43CAB50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000284E1B72020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000284E43CAB50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminMainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000284E19D6D40>
             └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000284E19D79C0>
                 └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
          │    │        │             └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000284E19D4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000284E43CAB90>
          └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
          │    │        │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
          │    │        └ CallbackQuery(id='1663765556562750934', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <bound method Start._on_click of <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000284E43CAB90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\state.py", line 165, in _on_click
    await manager.start(self.state, self.start_data, self.mode)
          │       │     │    │      │    │           │    └ <StartMode.NORMAL: 'NORMAL'>
          │       │     │    │      │    │           └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
          │       │     │    │      │    └ None
          │       │     │    │      └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
          │       │     │    └ <State 'ChannelAdminPersonalCabinet:select_offer_status'>
          │       │     └ <aiogram_dialog.widgets.kbd.state.Start object at 0x00000284E43CAAD0>
          │       └ <function ManagerImpl.start at 0x00000284E1BE6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'ChannelAdminPersonalCabinet:select_offer_status'>
          │    └ <function ManagerImpl._start_normal at 0x00000284E1BE6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000284E1BE71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
                        │    └ <function ManagerImpl.dialog at 0x00000284E1BE6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
                        │      │      └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                        │      └ <function Window.render at 0x00000284E1BFDC60>
                        └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
                         │    │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                         │    └ <function Window.load_data at 0x00000284E1BFDA80>
                         └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000284E1BE89F0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000284E439B610>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000284E43CF3D0>
    │    │            └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x284e3df6210'>, 'session_pool': async_session...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_personal_cabinet_data at 0x00000284E3CEFB00>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000284E43CF3D0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 115, in get_personal_cabinet_data
    all_reserved_money = [order.money_reserved for order in user_offers]
                                                            └ ([],)

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 115, in <listcomp>
    all_reserved_money = [order.money_reserved for order in user_offers]
                          │                        └ []
                          └ []

AttributeError: 'list' object has no attribute 'money_reserved'
2024-03-01T01:48:23.548036+0200 INFO Bot stopped!
2024-03-01T01:48:26.991399+0200 INFO Bot started!
2024-03-01T01:48:36.306607+0200 INFO Bot stopped!
2024-03-01T01:48:39.834823+0200 INFO Bot started!
2024-03-01T01:48:42.632025+0200 INFO ::1 [01/Mar/2024:01:48:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:48:42.770189+0200 INFO Update id=925011903 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:48:44.556358+0200 INFO ::1 [01/Mar/2024:01:48:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:48:44.829334+0200 INFO Update id=925011904 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T01:48:45.461894+0200 INFO ::1 [01/Mar/2024:01:48:45 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:48:45.643105+0200 INFO Update id=925011905 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T01:49:14.121682+0200 INFO Bot stopped!
2024-03-01T01:49:17.623835+0200 INFO Bot started!
2024-03-01T01:49:18.692849+0200 INFO ::1 [01/Mar/2024:01:49:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:18.835380+0200 INFO Update id=925011906 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:49:19.404340+0200 INFO ::1 [01/Mar/2024:01:49:19 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:19.541023+0200 INFO Update id=925011907 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:49:27.655501+0200 INFO ::1 [01/Mar/2024:01:49:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:27.660957+0200 ERROR Cannot get window data for state <State 'AdminOffers:select_offer'>
2024-03-01T01:49:27.661959+0200 INFO Update id=925011908 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T01:49:27.666959+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'list' object has no attribute 'id'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B7C6606B90>
                   │    │          │                   │           └ {'update_id': 925011908, 'callback_query': {'id': '1663765558661470878', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001B7C6104750>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001B7C393F1A0>
                   │    └ <Dispatcher '0x1b7c6515110'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B7C6606B90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001B7C6104750>
                 │    └ <function Dispatcher.feed_update at 0x000001B7C393F100>
                 └ <Dispatcher '0x1b7c6515110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B7C393D940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B7C65292D0>
                     └ <Dispatcher '0x1b7c6515110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001B7C5E836D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001B7C6053150>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001B7C695F280>
          │    │   │      │    └ AttributeError("'list' object has no attribute 'id'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001B7C6642200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001B7C6617690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001B7C5F82F10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001B7C68B8CC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B7C6534D90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B7C5E92FD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011908, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001B7C6178720>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1b7c6515110'>>, Update(update_id=925011908, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001B7C393E700>
                 └ <Dispatcher '0x1b7c6515110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B7C68B8860>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B7C393D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B7C6517850>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B7C393E7A0>
                 └ <Dispatcher '0x1b7c6515110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B7C393E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B7C68B8720>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B7C393D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B7C652AC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001B7C66078D0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001B7C68B8900>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B7C393E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B7C393E700>
                     └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B7C68B8D60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B7C393D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B7C65986D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B7C393E7A0>
                 └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001B7C393DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B7C65986D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B7C5FE2BD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B7C5E92FD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001B7C5FB2FD0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001B7C3D5F100>, <function CallableObject.call at 0x000001B7C68BB...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1b7c6515110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001B7C68BB600>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>>, CallbackQ...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
          │      │                └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001B7C3DBDBC0>
          └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
          │    │        │                └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001B7C3B96D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B7C65936D0>
          └ <Window(<State 'ChannelAdminPersonalCabinet:select_offer_status'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                 │    │                       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001B7C3D32020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B7C65936D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
             │ │                └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001B7C3B96D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B7C6593490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
                 │    │                       └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001B7C3D32020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B7C6593490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelAdminPersonalCabinet'>)>
             │ │                └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001B7C3B96D40>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B7C6593450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x000001B7C3D45F80>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B7C6593450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001B7C3B94EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001B7C6593510>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B7C6593450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('completed',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B7C6593450>
          │    │        └ CallbackQuery(id='1663765558661470878', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_select_offer_status at 0x000001B7C5EAF1A0>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001B7C6593510>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 81, in on_select_offer_status
    await dialog_manager.start(states.AdminOffers.select_offer, data=dialog_manager.dialog_data)
          │              │     │      │           │                  │              └ <property object at 0x000001B7C3DA9CB0>
          │              │     │      │           │                  └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
          │              │     │      │           └ <State 'AdminOffers:select_offer'>
          │              │     │      └ <class 'bot.dialogs.channel_admin_menu.states.AdminOffers'>
          │              │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
          │              └ <function ManagerImpl.start at 0x000001B7C3DA6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'selected_offer_status': 'completed'}
          │    │             └ <State 'AdminOffers:select_offer'>
          │    └ <function ManagerImpl._start_normal at 0x000001B7C3DA6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001B7C3DA71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
                        │    └ <function ManagerImpl.dialog at 0x000001B7C3DA6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x000001B7C3DBDC60>
                        └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x000001B7C3DBDA80>
                         └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001B7C3DA8AE0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B7C66E8A10>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001B7C659BE10>
    │    │            └ <Window(<State 'AdminOffers:select_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_offer_status': 'completed'}, 'middleware_data': {'dp': <Dispatcher '0x1b7c651511...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_admin_offers at 0x000001B7C5EAF560>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001B7C659BE10>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 13, in get_admin_offers
    "offers_list": [

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 14, in <listcomp>
    (offer.id, f"{offer.channel_name}", offer.target_request_amount) for offer in admin_offers
     │                                  │                                └ []
     │                                  └ []
     └ []

AttributeError: 'list' object has no attribute 'id'
2024-03-01T01:49:37.294472+0200 INFO Bot stopped!
2024-03-01T01:49:40.739310+0200 INFO Bot started!
2024-03-01T01:49:41.420272+0200 INFO ::1 [01/Mar/2024:01:49:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:41.555413+0200 INFO Update id=925011909 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T01:49:42.908701+0200 INFO ::1 [01/Mar/2024:01:49:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:43.046471+0200 INFO Update id=925011910 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:49:43.483486+0200 INFO ::1 [01/Mar/2024:01:49:43 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:43.602118+0200 INFO Update id=925011911 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:49:44.337475+0200 INFO ::1 [01/Mar/2024:01:49:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:44.502988+0200 INFO Update id=925011912 is handled. Duration 170 ms by bot id=5646878393
2024-03-01T01:49:44.965761+0200 INFO ::1 [01/Mar/2024:01:49:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:45.219719+0200 INFO Update id=925011913 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T01:49:48.970716+0200 INFO ::1 [01/Mar/2024:01:49:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:49.085107+0200 INFO Update id=925011914 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:49:52.234056+0200 INFO ::1 [01/Mar/2024:01:49:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:52.386723+0200 INFO Update id=925011915 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T01:49:53.050833+0200 INFO ::1 [01/Mar/2024:01:49:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:53.163559+0200 INFO Update id=925011916 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:49:53.669921+0200 INFO ::1 [01/Mar/2024:01:49:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:49:53.812392+0200 INFO Update id=925011917 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T01:50:44.841627+0200 INFO ::1 [01/Mar/2024:01:50:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:45.027247+0200 INFO Update id=925011918 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T01:50:46.974325+0200 INFO ::1 [01/Mar/2024:01:50:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:47.078996+0200 INFO Update id=925011919 is handled. Duration 93 ms by bot id=5646878393
2024-03-01T01:50:47.728891+0200 INFO ::1 [01/Mar/2024:01:50:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:47.841659+0200 INFO Update id=925011920 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:50:48.290959+0200 INFO ::1 [01/Mar/2024:01:50:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:48.394033+0200 INFO Update id=925011921 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:50:49.263422+0200 INFO ::1 [01/Mar/2024:01:50:49 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:49.369063+0200 INFO Update id=925011922 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T01:50:52.811404+0200 INFO ::1 [01/Mar/2024:01:50:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:52.916566+0200 INFO Update id=925011923 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:50:54.230829+0200 INFO ::1 [01/Mar/2024:01:50:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:54.340380+0200 INFO Update id=925011924 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T01:50:55.226151+0200 INFO ::1 [01/Mar/2024:01:50:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:55.328939+0200 INFO Update id=925011925 is handled. Duration 93 ms by bot id=5646878393
2024-03-01T01:50:55.829712+0200 INFO ::1 [01/Mar/2024:01:50:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:55.994557+0200 INFO Update id=925011926 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T01:50:57.128540+0200 INFO ::1 [01/Mar/2024:01:50:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:57.231850+0200 INFO Update id=925011927 is handled. Duration 94 ms by bot id=5646878393
2024-03-01T01:50:57.873809+0200 INFO ::1 [01/Mar/2024:01:50:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:57.975473+0200 INFO Update id=925011928 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:50:59.568013+0200 INFO ::1 [01/Mar/2024:01:50:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:50:59.672932+0200 INFO Update id=925011929 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:51:00.242682+0200 INFO ::1 [01/Mar/2024:01:51:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:00.344201+0200 INFO Update id=925011930 is handled. Duration 93 ms by bot id=5646878393
2024-03-01T01:51:00.773039+0200 INFO ::1 [01/Mar/2024:01:51:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:00.920735+0200 INFO Update id=925011931 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:51:03.081973+0200 INFO ::1 [01/Mar/2024:01:51:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:03.190288+0200 INFO Update id=925011932 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T01:51:17.621401+0200 INFO Bot stopped!
2024-03-01T01:51:21.208094+0200 INFO Bot started!
2024-03-01T01:51:22.474495+0200 INFO ::1 [01/Mar/2024:01:51:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:22.604403+0200 INFO Update id=925011933 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T01:51:23.500452+0200 INFO ::1 [01/Mar/2024:01:51:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:23.651401+0200 INFO Update id=925011934 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T01:51:24.672676+0200 INFO ::1 [01/Mar/2024:01:51:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:24.824481+0200 INFO Update id=925011935 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:51:26.006417+0200 INFO ::1 [01/Mar/2024:01:51:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:26.117501+0200 INFO Update id=925011936 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T01:51:28.440041+0200 INFO ::1 [01/Mar/2024:01:51:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:28.591053+0200 INFO Update id=925011937 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:51:29.486401+0200 INFO ::1 [01/Mar/2024:01:51:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:29.651110+0200 INFO Update id=925011938 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T01:51:30.312800+0200 INFO ::1 [01/Mar/2024:01:51:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:51:30.315300+0200 ERROR Cannot get window data for state <State 'CreateOffer:enter_offer_data'>
2024-03-01T01:51:30.316301+0200 INFO Update id=925011939 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T01:51:30.321301+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-52' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('channel_title')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001A92541DC90>
                   │    │          │                   │           └ {'update_id': 925011939, 'callback_query': {'id': '1663765555996062409', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001A924CB5910>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001A92275B1A0>
                   │    └ <Dispatcher '0x1a924e038d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001A92541DC90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001A924CB5910>
                 │    └ <function Dispatcher.feed_update at 0x000001A92275B100>
                 └ <Dispatcher '0x1a924e038d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A922759940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A924E00DD0>
                     └ <Dispatcher '0x1a924e038d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001A924CA35D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001A924E03410>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001A9257539C0>
          │    │   │      │    └ KeyError('channel_title')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001A925462110>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001A925740D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001A924DA3810>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001A9256D8EA0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001A925350110>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001A924CA06D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011939, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001A9256DB600>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1a924e038d0'>>, Update(update_id=925011939, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001A92275A700>
                 └ <Dispatcher '0x1a924e038d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A9256DBD80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A922759940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A92533ED50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A92275A7A0>
                 └ <Dispatcher '0x1a924e038d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001A92275A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A9256DBCE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A922759940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A9253460D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001A92541EB10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001A9256DB6A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A92275A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001A92275A700>
                     └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A9256DB4C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A922759940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A9253D6890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A92275A7A0>
                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001A922759A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A9253D6890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001A925350150>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001A924CA06D0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001A92541E950>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001A922B7F100>, <function CallableObject.call at 0x000001A9256D8...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1a924e038d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765555996062409', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001A9256D8FE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOffer'>)>>, CallbackQuery(id='1663765...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001A922BC71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
                        │    └ <function ManagerImpl.dialog at 0x000001A922BC6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
                        │      │      └ <Dialog(<StatesGroup 'CreateOffer'>)>
                        │      └ <function Window.render at 0x000001A922BDDC60>
                        └ <Window(<State 'CreateOffer:enter_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
                         │    │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                         │    └ <function Window.load_data at 0x000001A922BDDA80>
                         └ <Window(<State 'CreateOffer:enter_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001A922BC8B80>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A9257535D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001A9253D4C90>
    │    │            └ <Window(<State 'CreateOffer:enter_offer_data'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Reels'}, 'start_data': None, 'middle...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_entered_offer_data at 0x000001A924CCF880>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001A9253D4C90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 67, in get_entered_offer_data
    text = (f"Назва каналу: {dialog_data['channel_title']}\n"

KeyError: 'channel_title'
2024-03-01T01:52:17.690475+0200 INFO Bot stopped!
2024-03-01T01:52:21.136168+0200 INFO Bot started!
2024-03-01T01:52:22.641481+0200 INFO ::1 [01/Mar/2024:01:52:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T01:52:22.782800+0200 INFO Update id=925011940 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T01:53:38.983024+0200 INFO Bot stopped!
2024-03-01T01:53:42.545807+0200 INFO Bot started!
2024-03-01T01:54:12.632595+0200 INFO ::1 [01/Mar/2024:01:54:12 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T01:54:12.712662+0200 INFO ::1 [01/Mar/2024:01:54:12 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T10:16:21.733430+0200 INFO ::1 [01/Mar/2024:10:16:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:21.793506+0200 INFO ::1 [01/Mar/2024:10:16:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:22.281450+0200 INFO Update id=925011941 is handled. Duration 530 ms by bot id=5646878393
2024-03-01T10:16:22.330966+0200 INFO Update id=925011942 is handled. Duration 547 ms by bot id=5646878393
2024-03-01T10:16:47.878987+0200 INFO ::1 [01/Mar/2024:10:16:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:47.926216+0200 INFO ::1 [01/Mar/2024:10:16:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:47.974752+0200 INFO ::1 [01/Mar/2024:10:16:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:48.023023+0200 INFO ::1 [01/Mar/2024:10:16:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:16:48.096908+0200 INFO Update id=925011943 is handled. Duration 219 ms by bot id=5646878393
2024-03-01T10:16:48.126911+0200 INFO Update id=925011944 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T10:16:48.189123+0200 INFO Update id=925011945 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T10:16:48.534734+0200 INFO Update id=925011946 is handled. Duration 516 ms by bot id=5646878393
2024-03-01T10:17:20.581814+0200 INFO ::1 [01/Mar/2024:10:17:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:21.196281+0200 INFO Update id=925011947 is handled. Duration 608 ms by bot id=5646878393
2024-03-01T10:17:26.719629+0200 INFO ::1 [01/Mar/2024:10:17:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:27.269082+0200 INFO Update id=925011948 is handled. Duration 546 ms by bot id=5646878393
2024-03-01T10:17:31.378037+0200 INFO ::1 [01/Mar/2024:10:17:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:31.574998+0200 INFO Update id=925011949 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T10:17:32.354413+0200 INFO ::1 [01/Mar/2024:10:17:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:32.531886+0200 INFO Update id=925011950 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T10:17:38.168418+0200 INFO ::1 [01/Mar/2024:10:17:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:38.357435+0200 INFO Update id=925011951 is handled. Duration 187 ms by bot id=5646878393
2024-03-01T10:17:47.936198+0200 INFO ::1 [01/Mar/2024:10:17:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:17:48.244288+0200 INFO Update id=925011952 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T10:18:00.732869+0200 INFO ::1 [01/Mar/2024:10:18:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:01.193267+0200 INFO Update id=925011953 is handled. Duration 468 ms by bot id=5646878393
2024-03-01T10:18:06.914876+0200 INFO ::1 [01/Mar/2024:10:18:06 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:07.115440+0200 INFO Update id=925011954 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T10:18:09.679974+0200 INFO ::1 [01/Mar/2024:10:18:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:09.939037+0200 INFO Update id=925011955 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T10:18:11.558885+0200 INFO ::1 [01/Mar/2024:10:18:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:11.715301+0200 INFO Update id=925011956 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T10:18:17.410344+0200 INFO ::1 [01/Mar/2024:10:18:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:17.414709+0200 INFO Update id=925011957 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T10:18:17.438304+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-111' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`")>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 106, in _current_window
    return self.windows[manager.current_context().state]
           │    │       │       └ <function ManagerImpl.current_context at 0x000001CA3C0C65C0>
           │    │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
           │    └ {<State 'CreateOfferFromTGTraffic:select_criteria_for_sort'>: <Window(<State 'CreateOfferFromTGTraffic:select_criteria_for_so...
           └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>

KeyError: <State 'CreateOfferFromTGTraffic:select_topic'>


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
                   │    │          │                   │           └ {'update_id': 925011957, 'callback_query': {'id': '2193789068309763770', 'from': {'id': 510781320, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001CA3BC5B1A0>
                   │    └ <Dispatcher '0x1ca3e2d3a90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function Dispatcher.feed_update at 0x000001CA3BC5B100>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E2D1B50>
                     └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001CA3E424490>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001CA3E176790>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001CA3EE68FC0>
          │    │   │      │    └ UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `Create...
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001CA3E9626B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001CA3EE802D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001CA3E2A2A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001CA3EC17920>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E847E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011957, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001CA3EBDCA40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1ca3e2d3a90'>>, Update(update_id=925011957, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001CA3BC5A700>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC179C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E336890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC15A80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E845E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001CA3E922B10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC177E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC17560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │        └ <function TelegramEventObserver.trigger at 0x000001CA3BC59A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E1A3CD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001CA3E922990>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<function context_saver_middleware at 0x000001CA3C07F100>, <function CallableObject.call at 0x000001CA3EE4C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                   └ <function CallableObject.call at 0x000001CA3EE4C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOffer'>)>>, CallbackQuery(id='2193789...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
          │      │                │                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │      │                └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │      └ <function Window.process_callback at 0x000001CA3C0DDBC0>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
          │    │        │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │    │        │                └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │        └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x000001CA3C065F80>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001CA3BEB4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('Телеграм канал',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
          │    │        └ CallbackQuery(id='2193789068309763770', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    └ <function on_select_traffic_source at 0x000001CA3E1CCF40>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 38, in on_select_traffic_source
    return await dialog_manager.start(states.CreateOfferFromTGTraffic.select_topic)
                 │              │     │      │                        └ <State 'CreateOfferFromTGTraffic:select_topic'>
                 │              │     │      └ <class 'bot.dialogs.channel_admin_menu.states.CreateOfferFromTGTraffic'>
                 │              │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
                 │              └ <function ManagerImpl.start at 0x000001CA3C0C6C00>
                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'CreateOfferFromTGTraffic:select_topic'>
          │    └ <function ManagerImpl._start_normal at 0x000001CA3C0C6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001CA3C0C71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
                        │    └ <function ManagerImpl.dialog at 0x000001CA3C0C6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 122, in render
    window = await self._current_window(manager)
                   │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EE83190>
                   │    └ <function Dialog._current_window at 0x000001CA3C07E2A0>
                   └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 108, in _current_window
    raise UnregisteredWindowError(
          └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>

aiogram_dialog.api.exceptions.UnregisteredWindowError: No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`
2024-03-01T10:18:25.577114+0200 INFO ::1 [01/Mar/2024:10:18:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:25.581231+0200 INFO Update id=925011958 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T10:18:25.584228+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-115' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`")>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 106, in _current_window
    return self.windows[manager.current_context().state]
           │    │       │       └ <function ManagerImpl.current_context at 0x000001CA3C0C65C0>
           │    │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
           │    └ {<State 'CreateOfferFromTGTraffic:select_criteria_for_sort'>: <Window(<State 'CreateOfferFromTGTraffic:select_criteria_for_so...
           └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>

KeyError: <State 'CreateOfferFromTGTraffic:select_topic'>


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
                   │    │          │                   │           └ {'update_id': 925011958, 'callback_query': {'id': '2193789066264738857', 'from': {'id': 510781320, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001CA3BC5B1A0>
                   │    └ <Dispatcher '0x1ca3e2d3a90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function Dispatcher.feed_update at 0x000001CA3BC5B100>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E2D1B50>
                     └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001CA3E424490>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001CA3E176790>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001CA3EEFB8C0>
          │    │   │      │    └ UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `Create...
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001CA3E962020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001CA3EF02010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001CA3E2A2A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001CA3EE4D940>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E847E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011958, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001CA3EE4DA80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1ca3e2d3a90'>>, Update(update_id=925011958, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001CA3BC5A700>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4D9E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E336890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DD00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E845E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001CA3E922B10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DC60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DDA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │        └ <function TelegramEventObserver.trigger at 0x000001CA3BC59A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E1A3CD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001CA3E922990>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<function context_saver_middleware at 0x000001CA3C07F100>, <function CallableObject.call at 0x000001CA3EE4D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                   └ <function CallableObject.call at 0x000001CA3EE4DE40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOffer'>)>>, CallbackQuery(id='2193789...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
          │      │                │                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │      │                └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │      └ <function Window.process_callback at 0x000001CA3C0DDBC0>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
          │    │        │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │    │        │                └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │        └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x000001CA3C065F80>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001CA3BEB4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('Телеграм канал',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
          │    │        └ CallbackQuery(id='2193789066264738857', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    └ <function on_select_traffic_source at 0x000001CA3E1CCF40>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 38, in on_select_traffic_source
    return await dialog_manager.start(states.CreateOfferFromTGTraffic.select_topic)
                 │              │     │      │                        └ <State 'CreateOfferFromTGTraffic:select_topic'>
                 │              │     │      └ <class 'bot.dialogs.channel_admin_menu.states.CreateOfferFromTGTraffic'>
                 │              │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
                 │              └ <function ManagerImpl.start at 0x000001CA3C0C6C00>
                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'CreateOfferFromTGTraffic:select_topic'>
          │    └ <function ManagerImpl._start_normal at 0x000001CA3C0C6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001CA3C0C71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
                        │    └ <function ManagerImpl.dialog at 0x000001CA3C0C6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 122, in render
    window = await self._current_window(manager)
                   │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEF84D0>
                   │    └ <function Dialog._current_window at 0x000001CA3C07E2A0>
                   └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 108, in _current_window
    raise UnregisteredWindowError(
          └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>

aiogram_dialog.api.exceptions.UnregisteredWindowError: No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`
2024-03-01T10:18:27.901481+0200 INFO ::1 [01/Mar/2024:10:18:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:28.166619+0200 INFO Update id=925011959 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T10:18:29.752708+0200 INFO ::1 [01/Mar/2024:10:18:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:29.871384+0200 INFO Update id=925011960 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T10:18:31.747863+0200 INFO ::1 [01/Mar/2024:10:18:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:32.010554+0200 INFO Update id=925011961 is handled. Duration 264 ms by bot id=5646878393
2024-03-01T10:18:32.917817+0200 INFO ::1 [01/Mar/2024:10:18:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:32.922422+0200 INFO Update id=925011962 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T10:18:32.925421+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-139' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`")>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 106, in _current_window
    return self.windows[manager.current_context().state]
           │    │       │       └ <function ManagerImpl.current_context at 0x000001CA3C0C65C0>
           │    │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
           │    └ {<State 'CreateOfferFromTGTraffic:select_criteria_for_sort'>: <Window(<State 'CreateOfferFromTGTraffic:select_criteria_for_so...
           └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>

KeyError: <State 'CreateOfferFromTGTraffic:select_topic'>


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
                   │    │          │                   │           └ {'update_id': 925011962, 'callback_query': {'id': '2193789064923223146', 'from': {'id': 510781320, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001CA3BC5B1A0>
                   │    └ <Dispatcher '0x1ca3e2d3a90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function Dispatcher.feed_update at 0x000001CA3BC5B100>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E2D1B50>
                     └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001CA3E424490>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001CA3E176790>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001CA3EEF45C0>
          │    │   │      │    └ UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `Create...
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001CA3E962020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001CA3EE2A350>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001CA3E2A2A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001CA3EE4DF80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E847E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011962, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001CA3EE4DEE0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1ca3e2d3a90'>>, Update(update_id=925011962, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001CA3BC5A700>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DD00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E336890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DC60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E845E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001CA3E922B10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DE40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4DB20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │        └ <function TelegramEventObserver.trigger at 0x000001CA3BC59A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E1A3CD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001CA3E922990>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<function context_saver_middleware at 0x000001CA3C07F100>, <function CallableObject.call at 0x000001CA3EE4D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                   └ <function CallableObject.call at 0x000001CA3EE4D800>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOffer'>)>>, CallbackQuery(id='2193789...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
          │      │                │                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │      │                └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │      └ <function Window.process_callback at 0x000001CA3C0DDBC0>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
          │    │        │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │    │        │                └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │        └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x000001CA3C065F80>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001CA3BEB4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('Телеграм канал',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
          │    │        └ CallbackQuery(id='2193789064923223146', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    └ <function on_select_traffic_source at 0x000001CA3E1CCF40>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 38, in on_select_traffic_source
    return await dialog_manager.start(states.CreateOfferFromTGTraffic.select_topic)
                 │              │     │      │                        └ <State 'CreateOfferFromTGTraffic:select_topic'>
                 │              │     │      └ <class 'bot.dialogs.channel_admin_menu.states.CreateOfferFromTGTraffic'>
                 │              │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
                 │              └ <function ManagerImpl.start at 0x000001CA3C0C6C00>
                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'CreateOfferFromTGTraffic:select_topic'>
          │    └ <function ManagerImpl._start_normal at 0x000001CA3C0C6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001CA3C0C71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
                        │    └ <function ManagerImpl.dialog at 0x000001CA3C0C6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 122, in render
    window = await self._current_window(manager)
                   │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EEFBE50>
                   │    └ <function Dialog._current_window at 0x000001CA3C07E2A0>
                   └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 108, in _current_window
    raise UnregisteredWindowError(
          └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>

aiogram_dialog.api.exceptions.UnregisteredWindowError: No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`
2024-03-01T10:18:35.038747+0200 INFO ::1 [01/Mar/2024:10:18:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:35.181673+0200 INFO Update id=925011963 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T10:18:36.303553+0200 INFO ::1 [01/Mar/2024:10:18:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:36.494870+0200 INFO Update id=925011964 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T10:18:37.990553+0200 INFO ::1 [01/Mar/2024:10:18:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:38.197408+0200 INFO Update id=925011965 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T10:18:41.042374+0200 INFO ::1 [01/Mar/2024:10:18:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:41.196423+0200 INFO Update id=925011966 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T10:18:48.509136+0200 INFO ::1 [01/Mar/2024:10:18:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:48.637694+0200 INFO Update id=925011967 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T10:18:51.734886+0200 INFO ::1 [01/Mar/2024:10:18:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:51.920579+0200 INFO Update id=925011968 is not handled. Duration 171 ms by bot id=5646878393
2024-03-01T10:18:51.927581+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-173' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
                   │    │          │                   │           └ {'update_id': 925011968, 'callback_query': {'id': '2193789067120731995', 'from': {'id': 510781320, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001CA3BC5B1A0>
                   │    └ <Dispatcher '0x1ca3e2d3a90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function Dispatcher.feed_update at 0x000001CA3BC5B100>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E2D1B50>
                     └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001CA3E424490>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001CA3E176790>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001CA3EF11180>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001CA3E960400>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001CA3EA0C7D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001CA3E2A2A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001CA3EC17380>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E847E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011968, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001CA3EC17920>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1ca3e2d3a90'>>, Update(update_id=925011968, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001CA3BC5A700>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4E0C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E336890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4C720>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E845E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001CA3E922B10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EE4E660>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC177E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E861290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                     │        └ <function TelegramEventObserver.trigger at 0x000001CA3BC59A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E861290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E1A3CD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001CA3E922990>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 └ functools.partial(<function context_saver_middleware at 0x000001CA3C07F100>, <function CallableObject.call at 0x000001CA3EE4E...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                   └ <function CallableObject.call at 0x000001CA3EE4E2A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='2193789067...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │      └ <function Window.process_callback at 0x000001CA3C0DDBC0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │        └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E1B0050>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E1B0050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E1A1F90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E1A1F90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001CA3E853ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000001CA3BEB79C0>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001CA3E853ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001CA3E853ED0>
          │    │        │             └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001CA3BEB4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E372C90>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001CA3E853ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001CA3E853ED0>
          │    │        └ CallbackQuery(id='2193789067120731995', from_user=User(id=510781320, is_bot=False, first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    └ <function on_start_select_offer at 0x000001CA3E1CD580>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E372C90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x000001CA3C0C6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x000001CA3C0C6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001CA3C0C71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3EF13010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │                 │    └ NewMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
          │    └ <function MessageManager.edit_message_safe at 0x000001CA3C0DC9A0>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001CA3E2D3AD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │            │    └ NewMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function MessageManager.edit_message at 0x000001CA3C0DCA40>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001CA3E2D3AD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │         │    └ NewMessage(chat=Chat(id=510781320, type='private', title=None, username='more_other', first_name='No Gunᅠᅠࣩࣩࣩࣩࣩࣩࣩࣩࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧࣧ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function MessageManager.edit_text at 0x000001CA3C0DCB80>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001CA3E2D3AD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x000001CA3BBE98A0>
                 └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=510781320, message_id=62606, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=510781320, message_id=62606, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001CA3E4242D0>
                 └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=510781320, message_id=62606, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x000001CA35CB04A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x000001CA3BBB2700>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001CA3E4242D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=510781320, message_id=62606, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T10:18:58.181551+0200 INFO ::1 [01/Mar/2024:10:18:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T10:18:58.345692+0200 INFO Update id=925011969 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T11:08:48.000727+0200 INFO ::1 [01/Mar/2024:11:08:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:08:48.302160+0200 INFO Update id=925011970 is handled. Duration 297 ms by bot id=5646878393
2024-03-01T11:09:01.052135+0200 INFO ::1 [01/Mar/2024:11:09:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:01.469283+0200 INFO Update id=925011971 is handled. Duration 407 ms by bot id=5646878393
2024-03-01T11:09:06.341168+0200 INFO ::1 [01/Mar/2024:11:09:06 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:06.603801+0200 INFO Update id=925011972 is handled. Duration 265 ms by bot id=5646878393
2024-03-01T11:09:08.697089+0200 INFO ::1 [01/Mar/2024:11:09:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:08.875614+0200 INFO Update id=925011973 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T11:09:11.145218+0200 INFO ::1 [01/Mar/2024:11:09:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:11.389230+0200 INFO Update id=925011974 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T11:09:13.497478+0200 INFO ::1 [01/Mar/2024:11:09:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:13.730812+0200 INFO Update id=925011975 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T11:09:15.316010+0200 INFO ::1 [01/Mar/2024:11:09:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:15.608808+0200 INFO Update id=925011976 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T11:09:17.116182+0200 INFO ::1 [01/Mar/2024:11:09:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:17.391518+0200 INFO Update id=925011977 is handled. Duration 264 ms by bot id=5646878393
2024-03-01T11:09:21.878279+0200 INFO ::1 [01/Mar/2024:11:09:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:22.175948+0200 INFO Update id=925011978 is handled. Duration 297 ms by bot id=5646878393
2024-03-01T11:09:23.191534+0200 INFO ::1 [01/Mar/2024:11:09:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:23.568096+0200 INFO Update id=925011979 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T11:09:24.677971+0200 INFO ::1 [01/Mar/2024:11:09:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:25.096782+0200 INFO Update id=925011980 is handled. Duration 422 ms by bot id=5646878393
2024-03-01T11:09:26.462179+0200 INFO ::1 [01/Mar/2024:11:09:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:09:26.649298+0200 INFO Update id=925011981 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T11:10:00.273510+0200 INFO ::1 [01/Mar/2024:11:10:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:10:00.589134+0200 INFO Update id=925011982 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T11:10:11.150153+0200 INFO ::1 [01/Mar/2024:11:10:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:10:11.282052+0200 INFO Update id=925011983 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T11:10:13.405714+0200 INFO ::1 [01/Mar/2024:11:10:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:10:13.527488+0200 INFO Update id=925011984 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T11:10:14.544902+0200 INFO ::1 [01/Mar/2024:11:10:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:10:14.674360+0200 INFO Update id=925011985 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T11:58:32.383308+0200 INFO ::1 [01/Mar/2024:11:58:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:32.753409+0200 INFO Update id=925011986 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T11:58:36.328099+0200 INFO ::1 [01/Mar/2024:11:58:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:36.480092+0200 INFO Update id=925011987 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T11:58:37.650536+0200 INFO ::1 [01/Mar/2024:11:58:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:37.879880+0200 INFO Update id=925011988 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T11:58:38.732887+0200 INFO ::1 [01/Mar/2024:11:58:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:39.042243+0200 INFO Update id=925011989 is handled. Duration 312 ms by bot id=5646878393
2024-03-01T11:58:40.138550+0200 INFO ::1 [01/Mar/2024:11:58:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:40.444563+0200 INFO Update id=925011990 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T11:58:41.273848+0200 INFO ::1 [01/Mar/2024:11:58:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T11:58:41.278173+0200 INFO Update id=925011991 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T11:58:41.281234+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-317' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`")>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 106, in _current_window
    return self.windows[manager.current_context().state]
           │    │       │       └ <function ManagerImpl.current_context at 0x000001CA3C0C65C0>
           │    │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
           │    └ {<State 'CreateOfferFromTGTraffic:select_criteria_for_sort'>: <Window(<State 'CreateOfferFromTGTraffic:select_criteria_for_so...
           └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>

KeyError: <State 'CreateOfferFromTGTraffic:select_topic'>


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
                   │    │          │                   │           └ {'update_id': 925011991, 'callback_query': {'id': '1663765556143649428', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001CA3BC5B1A0>
                   │    └ <Dispatcher '0x1ca3e2d3a90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001CA3E1A1610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001CA3E182050>
                 │    └ <function Dispatcher.feed_update at 0x000001CA3BC5B100>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E2D1B50>
                     └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001CA3E424490>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001CA3E176790>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001CA3ED11280>
          │    │   │      │    └ UnregisteredWindowError("No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `Create...
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001CA3E962020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001CA3EE29010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001CA3E2A2A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001CA3EC15E40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E847E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011991, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001CA3EC163E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1ca3e2d3a90'>>, Update(update_id=925011991, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001CA3BC5A700>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC16660>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E336890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dispatcher '0x1ca3e2d3a90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EC177E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E845E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001CA3E922B10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EF8DBC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001CA3BC5A700>
                     └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001CA3EF8DC60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001CA3BC59940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001CA3BC5A7A0>
                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001CA3BC59A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001CA3E8D6510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001CA3E1A3CD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001CA3E175DD0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001CA3E922990>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001CA3C07F100>, <function CallableObject.call at 0x000001CA3EF8D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1ca3e2d3a90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001CA3EF8DD00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOffer'>)>>, CallbackQuery(id='1663765...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
          │      │                │                 └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │      │                └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001CA3C0DDBC0>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
          │    │        │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
          │    │        │                └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
          └ <Window(<State 'CreateOffer:select_traffic_source'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D4410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                 │    │                       └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001CA3C052020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001CA3E8D41D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
             │ │                └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001CA3BEB6D40>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x000001CA3C065F80>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001CA3BEB4EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('Телеграм канал',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001CA3E8D4190>
          │    │        └ CallbackQuery(id='1663765556143649428', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_select_traffic_source at 0x000001CA3E1CCF40>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001CA3E8D4250>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 38, in on_select_traffic_source
    return await dialog_manager.start(states.CreateOfferFromTGTraffic.select_topic)
                 │              │     │      │                        └ <State 'CreateOfferFromTGTraffic:select_topic'>
                 │              │     │      └ <class 'bot.dialogs.channel_admin_menu.states.CreateOfferFromTGTraffic'>
                 │              │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
                 │              └ <function ManagerImpl.start at 0x000001CA3C0C6C00>
                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'CreateOfferFromTGTraffic:select_topic'>
          │    └ <function ManagerImpl._start_normal at 0x000001CA3C0C6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001CA3C0C71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
                        │    └ <function ManagerImpl.dialog at 0x000001CA3C0C6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 122, in render
    window = await self._current_window(manager)
                   │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001CA3ED3D210>
                   │    └ <function Dialog._current_window at 0x000001CA3C07E2A0>
                   └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 108, in _current_window
    raise UnregisteredWindowError(
          └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>

aiogram_dialog.api.exceptions.UnregisteredWindowError: No window found for `<State 'CreateOfferFromTGTraffic:select_topic'>` Current state group is `CreateOfferFromTGTraffic`
2024-03-01T12:00:23.319304+0200 INFO Bot stopped!
2024-03-01T12:00:27.629655+0200 INFO Bot started!
2024-03-01T12:00:28.558599+0200 INFO ::1 [01/Mar/2024:12:00:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:00:29.139903+0200 INFO Update id=925011992 is handled. Duration 577 ms by bot id=5646878393
2024-03-01T12:00:30.209580+0200 INFO ::1 [01/Mar/2024:12:00:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:00:30.346299+0200 INFO Update id=925011993 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T12:00:31.366466+0200 INFO ::1 [01/Mar/2024:12:00:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:00:31.533036+0200 INFO Update id=925011994 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T12:02:30.898388+0200 INFO Bot stopped!
2024-03-01T12:02:34.362307+0200 INFO Bot started!
2024-03-01T12:02:36.238391+0200 INFO ::1 [01/Mar/2024:12:02:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:02:36.609507+0200 INFO Update id=925011995 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T12:02:37.210531+0200 INFO ::1 [01/Mar/2024:12:02:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:02:37.389307+0200 INFO Update id=925011996 is handled. Duration 170 ms by bot id=5646878393
2024-03-01T12:03:21.225564+0200 INFO Bot stopped!
2024-03-01T12:03:24.636676+0200 INFO Bot started!
2024-03-01T12:03:25.845604+0200 INFO ::1 [01/Mar/2024:12:03:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:03:26.023891+0200 INFO Update id=925011997 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T12:03:26.568196+0200 INFO ::1 [01/Mar/2024:12:03:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:03:26.767249+0200 INFO Update id=925011998 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T12:03:27.557088+0200 INFO ::1 [01/Mar/2024:12:03:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:03:27.560295+0200 INFO Update id=925011999 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:03:27.577292+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('sort_criteria')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000023357BF7850>
                   │    │          │                   │           └ {'update_id': 925011999, 'callback_query': {'id': '1663765555681365735', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000023357330FD0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000023354F2F1A0>
                   │    └ <Dispatcher '0x2335759ee10'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000023357BF7850>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000023357330FD0>
                 │    └ <function Dispatcher.feed_update at 0x0000023354F2F100>
                 └ <Dispatcher '0x2335759ee10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000023354F2D940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000023357B18750>
                     └ <Dispatcher '0x2335759ee10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000023357B18E10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000023357B18A90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000023357F36D40>
          │    │   │      │    └ KeyError('sort_criteria')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000023357C32110>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000023357BF78D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000023357B19210>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000233577685E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000023357B24390>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000233575D2B10>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925011999, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000023357EACCC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2335759ee10'>>, Update(update_id=925011999, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000023354F2E700>
                 └ <Dispatcher '0x2335759ee10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000023357EAC9A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000023354F2D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000023357B0ECD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000023354F2E7A0>
                 └ <Dispatcher '0x2335759ee10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000023354F2E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000023357EAC860>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000023354F2D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000023357B1A290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000023357BF6D50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000023357EAD8A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000023354F2E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000023354F2E700>
                     └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000023357EAF380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000023354F2D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000023357BC0590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000023354F2E7A0>
                 └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x0000023354F2DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000023357BC0590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000233575D2A90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000233575D2B10>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000233576BD050>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000002335534F100>, <function CallableObject.call at 0x0000023357EAF...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x2335759ee10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000023357EAF4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>>, CallbackQuer...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
          │      │                │                 └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
          │      │                └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x00000233553ADBC0>
          └ <Window(<State 'CreateOfferFromTGTraffic:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
          │    │        │                │         └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
          │    │        │                └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x0000023355186D40>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000023357BB2850>
          └ <Window(<State 'CreateOfferFromTGTraffic:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
                 │    │                       │         └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
                 │    │                       └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x0000023355322020>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000023357BB2850>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
             │ │                │         └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
             │ │                └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x0000023355186D40>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x0000023357BB2490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000233551879C0>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x0000023357BB2490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x0000023357BB2490>
          │    │        │             └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x0000023355184EA0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000023357BB2510>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x0000023357BB2490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x0000023357BB2490>
          │    │        └ CallbackQuery(id='1663765555681365735', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_change_sort_criteria at 0x000002335749EF20>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000023357BB2510>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 58, in on_change_sort_criteria
    current_sort_criteria = dialog_manager.dialog_data['sort_criteria']
                            │              └ <property object at 0x0000023355399C10>
                            └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000023357C15FD0>

KeyError: 'sort_criteria'
2024-03-01T12:03:46.863265+0200 INFO Bot stopped!
2024-03-01T12:03:50.372629+0200 INFO Bot started!
2024-03-01T12:03:51.226519+0200 INFO ::1 [01/Mar/2024:12:03:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:03:51.231479+0200 ERROR Cannot get window data for state <State 'CreateOfferFromTGTraffic:select_channel'>
2024-03-01T12:03:51.232481+0200 INFO Update id=925012000 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:03:51.238480+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("type object 'Channels' has no attribute 'channel_id'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000191DBBC2E90>
                   │    │          │                   │           └ {'update_id': 925012000, 'callback_query': {'id': '1663765554900949014', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000191DBCEA110>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000191D966B1A0>
                   │    └ <Dispatcher '0x191dc24e3d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000191DBBC2E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000191DBCEA110>
                 │    └ <function Dispatcher.feed_update at 0x00000191D966B100>
                 └ <Dispatcher '0x191dc24e3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000191D9669940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000191DBD452D0>
                     └ <Dispatcher '0x191dc24e3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000191DBB860D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000191DC2548D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000191DC40CF00>
          │    │   │      │    └ AttributeError("type object 'Channels' has no attribute 'channel_id'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000191DC372020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000191DC42B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000191DBB936D0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000191DC5EC680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000191DBB7BD50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000191DC255050>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012000, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000191DC5ECCC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x191dc24e3d0'>>, Update(update_id=925012000, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000191D966A700>
                 └ <Dispatcher '0x191dc24e3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000191DC5EC9A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000191D9669940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000191DBD13CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000191D966A7A0>
                 └ <Dispatcher '0x191dc24e3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000191D966A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000191DC5ECC20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000191D9669940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000191DC256090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000191DC336E90>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000191DC5EC5E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000191D966A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000191D966A700>
                     └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000191DC5EC860>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000191D9669940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000191DC2FC790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000191D966A7A0>
                 └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000191D9669A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000191DC2FC790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000191DBE34310>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000191DC255050>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000191DBD87F90>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000191D9A8F100>, <function CallableObject.call at 0x00000191DC5EC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x191dc24e3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765554900949014', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000191DC5ECE00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>>, CallbackQuer...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000191D9AD71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
                        │    └ <function ManagerImpl.dialog at 0x00000191D9AD6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
                        │      │      └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
                        │      └ <function Window.render at 0x00000191D9AEDC60>
                        └ <Window(<State 'CreateOfferFromTGTraffic:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
                         │    │         └ <Dialog(<StatesGroup 'CreateOfferFromTGTraffic'>)>
                         │    └ <function Window.load_data at 0x00000191D9AEDA80>
                         └ <Window(<State 'CreateOfferFromTGTraffic:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000191D9AD8A40>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000191DBBB3610>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000191DC2EEB50>
    │    │            └ <Window(<State 'CreateOfferFromTGTraffic:select_channel'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_topic': 'linguistics', 'selected_criteria_for_sort': 'amount_subs', 'sort_criteria': 'desc'}, 'sta...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_channels_with_criteria at 0x00000191DBBDF920>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000191DC2EEB50>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 103, in get_channels_with_criteria
    channels_model = await repo.channel_repo.get_channels(sort_type=sort_criteria)
                           │    │            │                      └ 'desc'
                           │    │            └ <function ChannelRequestsRepo.get_channels at 0x00000191DBAD7D80>
                           │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x00000191DC40F790>
                           └ <bot.db.Repo object at 0x00000191DC40F910>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 41, in get_channels
    query = select(Channels).order_by(Channels.subs_amount.asc() if sort_type == "asc" else Channels.channel_id.desc())
            │      │                  │        │           │        │                       └ <class 'bot.db.models.models.Channels'>
            │      │                  │        │           │        └ 'desc'
            │      │                  │        │           └ <function ColumnOperators.asc at 0x00000191DB0EE520>
            │      │                  │        └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000191DBA7ED40>
            │      │                  └ <class 'bot.db.models.models.Channels'>
            │      └ <class 'bot.db.models.models.Channels'>
            └ <function select at 0x00000191DB406C00>

AttributeError: type object 'Channels' has no attribute 'channel_id'
2024-03-01T12:04:20.682782+0200 INFO Bot stopped!
2024-03-01T12:04:24.215817+0200 INFO Bot started!
2024-03-01T12:04:25.550678+0200 INFO ::1 [01/Mar/2024:12:04:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:04:25.706727+0200 INFO Update id=925012001 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T12:04:26.409081+0200 INFO ::1 [01/Mar/2024:12:04:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:04:26.554916+0200 INFO Update id=925012002 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T12:04:29.061533+0200 INFO ::1 [01/Mar/2024:12:04:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:04:29.301385+0200 INFO Update id=925012003 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T12:04:30.532150+0200 INFO ::1 [01/Mar/2024:12:04:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:04:30.683271+0200 INFO Update id=925012004 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T12:05:50.033699+0200 INFO ::1 [01/Mar/2024:12:05:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:50.315120+0200 INFO Update id=925012005 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T12:05:50.921391+0200 INFO ::1 [01/Mar/2024:12:05:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:51.049779+0200 INFO Update id=925012006 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T12:05:52.119465+0200 INFO ::1 [01/Mar/2024:12:05:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:52.271052+0200 INFO Update id=925012007 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T12:05:53.605549+0200 INFO ::1 [01/Mar/2024:12:05:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:53.906653+0200 INFO Update id=925012008 is handled. Duration 296 ms by bot id=5646878393
2024-03-01T12:05:54.617198+0200 INFO ::1 [01/Mar/2024:12:05:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:55.087341+0200 INFO Update id=925012009 is handled. Duration 468 ms by bot id=5646878393
2024-03-01T12:05:56.974802+0200 INFO ::1 [01/Mar/2024:12:05:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:57.186164+0200 INFO Update id=925012010 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T12:05:59.558748+0200 INFO ::1 [01/Mar/2024:12:05:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:05:59.872869+0200 INFO Update id=925012011 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T12:06:00.815466+0200 INFO ::1 [01/Mar/2024:12:06:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:06:01.105984+0200 INFO Update id=925012012 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T12:06:02.131958+0200 INFO ::1 [01/Mar/2024:12:06:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:06:02.262528+0200 INFO Update id=925012013 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T12:06:03.068354+0200 INFO ::1 [01/Mar/2024:12:06:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:06:03.191972+0200 INFO Update id=925012014 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T12:06:43.998149+0200 INFO ::1 [01/Mar/2024:12:06:43 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:06:44.381027+0200 INFO ::1 [01/Mar/2024:12:06:44 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:25:56.742631+0200 INFO ::1 [01/Mar/2024:12:25:56 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"
2024-03-01T12:25:56.835632+0200 INFO ::1 [01/Mar/2024:12:25:56 +0200] "POST /withdraw-request HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"
2024-03-01T12:27:11.265225+0200 INFO ::1 [01/Mar/2024:12:27:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:27:11.485144+0200 INFO Update id=925012015 is handled. Duration 219 ms by bot id=5646878393
2024-03-01T12:27:14.999818+0200 INFO ::1 [01/Mar/2024:12:27:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:27:15.212682+0200 INFO Update id=925012016 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T12:28:28.924195+0200 INFO ::1 [01/Mar/2024:12:28:28 +0200] "OPTIONS /add-channel HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_7_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"
2024-03-01T12:28:29.235515+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 132, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000024B94F4D440>
    │       └ <function run at 0x0000024B8C82C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000024B94E1E040>
           │      └ <function Runner.run at 0x0000024B8C8BC900>
           └ <asyncio.runners.Runner object at 0x0000024B8D2A1390>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000024B8C8BA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000024B8D2A1390>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000024B8C98A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000024B8C8BC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000024B8C7FDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /add-channel >
                 └ <bound method Application._handle of <Application 0x24b954d6f50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /add-channel >
                 └ <function handle_add_channel at 0x0000024B94F4D300>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 96, in handle_add_channel
    channel_theme = 'news'

ValueError: invalid literal for int() with base 10: 'Xbdj'
2024-03-01T12:28:29.300730+0200 INFO ::1 [01/Mar/2024:12:28:29 +0200] "POST /add-channel HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_7_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"
2024-03-01T12:31:10.043318+0200 INFO Bot stopped!
2024-03-01T12:31:13.478500+0200 INFO Bot started!
2024-03-01T12:31:56.006645+0200 INFO ::1 [01/Mar/2024:12:31:56 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:31:56.240367+0200 INFO ::1 [01/Mar/2024:12:31:56 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:31:56.245625+0200 ERROR Cannot get window data for state <State 'CreateOffer:confirm_offer_data'>
2024-03-01T12:31:56.251628+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('channel_title')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000187913EA700>
          │    └ <Dispatcher '0x18793fc8250'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x0000018793907410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000187944349A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000187913E9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018793930950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000018793B0CAD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000018793FCB090>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000018793907880>
          │    │   │      │    └ KeyError('channel_title')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000187940F24D0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001879438C590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000018793AC72D0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000018794434A40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000187913EA7A0>
                 └ <Dispatcher '0x18793fc8250'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000187913E9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018793930950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000018793B07110>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000018793FCB650>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000018794434B80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x18793fc8250'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000187913EA700>
                 └ <Dispatcher '0x18793fc8250'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000018794434CC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000187913EA7A0>
                 └ <Dispatcher '0x18793fc8250'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000187913EA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018794434400>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000187913E9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018793FDE5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000187940AD710>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000018794434360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000187913EA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000187913E9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018793FDE5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000187940AD550>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x000001879180F100>, <function CallableObject.call at 0x0000018794435...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000018793A2FC50>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x0000018794435260>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000001879186C040>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 29, in handle_update
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000187918571A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
                        │    └ <function ManagerImpl.dialog at 0x0000018791856520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
                        │      │      └ <Dialog(<StatesGroup 'CreateOffer'>)>
                        │      └ <function Window.render at 0x000001879186DC60>
                        └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
                         │    │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                         │    └ <function Window.load_data at 0x000001879186DA80>
                         └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000018791858AE0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018793FDE910>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001879405FB90>
    │    │            └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_entered_offer_data at 0x000001879395F6A0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001879405FB90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 67, in get_entered_offer_data
    text = (f"Назва каналу: {dialog_data['channel_title']}\n"

KeyError: 'channel_title'
2024-03-01T12:32:32.883690+0200 INFO Bot stopped!
2024-03-01T12:32:36.472154+0200 INFO Bot started!
2024-03-01T12:32:47.781222+0200 INFO ::1 [01/Mar/2024:12:32:47 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:32:48.012370+0200 INFO ::1 [01/Mar/2024:12:32:47 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:32:48.203405+0200 ERROR Cannot get window data for state <State 'CreateOffer:confirm_offer_data'>
2024-03-01T12:32:48.207881+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("'NoneType' object is not iterable")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000246F0E9E700>
          │    └ <Dispatcher '0x246f3516c10'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000246F3B5FC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000246F3EFCAE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246F0E9D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246F3A7AC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000246F33E3710>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000246F35B8B90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000246F3B80D00>
          │    │   │      │    └ TypeError("'NoneType' object is not iterable")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000246F3BA27A0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000246F355DAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000246F36DB5D0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000246F3EFCB80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246F0E9E7A0>
                 └ <Dispatcher '0x246f3516c10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000246F0E9DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246F3A7AC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000246F3A8E5D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000246F33C1ED0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000246F1095E40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x246f3516c10'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000246F0E9E700>
                 └ <Dispatcher '0x246f3516c10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000246F10962A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246F0E9E7A0>
                 └ <Dispatcher '0x246f3516c10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000246F0E9E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000246F1095EE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246F0E9D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246F33B6CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000246F3B5D790>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000246F3EFC5E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246F0E9E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000246F0E9DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246F33B6CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000246F3AB57D0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x00000246F12BF100>, <function CallableObject.call at 0x00000246F36CC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000246F34E2690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x00000246F36CCFE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000246F131C040>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 29, in handle_update
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000246F13071A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
                        │    └ <function ManagerImpl.dialog at 0x00000246F1306520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
                        │      │      └ <Dialog(<StatesGroup 'CreateOffer'>)>
                        │      └ <function Window.render at 0x00000246F131DC60>
                        └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
                         │    │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                         │    └ <function Window.load_data at 0x00000246F131DA80>
                         └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000246F1308A90>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246F404A2D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000246F3B0F9D0>
    │    │            └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok', 'channel_title': 'test', '...

TypeError: 'NoneType' object is not iterable
2024-03-01T12:33:34.691932+0200 INFO Bot stopped!
2024-03-01T12:33:38.052480+0200 INFO Bot started!
2024-03-01T12:33:46.457551+0200 INFO ::1 [01/Mar/2024:12:33:46 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:33:46.694460+0200 INFO ::1 [01/Mar/2024:12:33:46 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:33:46.699468+0200 ERROR Cannot get window data for state <State 'CreateOffer:confirm_offer_data'>
2024-03-01T12:33:46.705466+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('contacts')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000001C43CFCA700>
          │    └ <Dispatcher '0x1c43f4e3a10'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000001C43F510050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001C44002CAE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001C43CFC9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001C43F6A6150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001C43FBABC10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001C43FBAB890>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001C43FF6FC80>
          │    │   │      │    └ KeyError('contacts')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001C43FCD27A0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001C43FC8E590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001C43FBABF50>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001C44002CB80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001C43CFCA7A0>
                 └ <Dispatcher '0x1c43f4e3a10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000001C43CFC9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001C43F6A6150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001C43FBBB050>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001C43F613690>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000001C44002D080>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1c43f4e3a10'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000001C43CFCA700>
                 └ <Dispatcher '0x1c43f4e3a10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001C44002C540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001C43CFCA7A0>
                 └ <Dispatcher '0x1c43f4e3a10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000001C43CFCA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001C44002CCC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001C43CFC9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001C43F6A6290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001C43FC8DDD0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001C44002CFE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001C43CFCA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x000001C43CFC9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001C43F6A6290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001C43FBE5C90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x000001C43D3EF100>, <function CallableObject.call at 0x000001C43FF4C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001C43F763690>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x000001C43FF4C220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000001C43D44C040>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 29, in handle_update
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001C43D4371A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
                        │    └ <function ManagerImpl.dialog at 0x000001C43D436520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
                        │      │      └ <Dialog(<StatesGroup 'CreateOffer'>)>
                        │      └ <function Window.render at 0x000001C43D44DC60>
                        └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
                         │    │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                         │    └ <function Window.load_data at 0x000001C43D44DA80>
                         └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001C43D438A40>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001C43FF6C7D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001C43FC442D0>
    │    │            └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok', 'channel_title': 'test', '...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_entered_offer_data at 0x000001C43F53F6A0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001C43FC442D0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 75, in get_entered_offer_data
    f"Контакти для звязку: {dialog_data['contacts']}\n"

KeyError: 'contacts'
2024-03-01T12:33:57.706445+0200 INFO Bot stopped!
2024-03-01T12:34:01.418203+0200 INFO Bot started!
2024-03-01T12:34:13.969039+0200 INFO ::1 [01/Mar/2024:12:34:13 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:34:14.207489+0200 INFO ::1 [01/Mar/2024:12:34:14 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:34:14.212653+0200 ERROR Cannot get window data for state <State 'CreateOffer:confirm_offer_data'>
2024-03-01T12:34:14.218651+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('contacts')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x0000022D7FA7A700>
          │    └ <Dispatcher '0x22d02201510'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x0000022D0297AD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000022D02ADCAE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000022D7FA79940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022D01FC0610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000022D012EA650>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000022D02217350>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000022D02A2A700>
          │    │   │      │    └ KeyError('contacts')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000022D0277E6B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000022D020C1F90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000022D0265B6D0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000022D02ADCB80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000022D7FA7A7A0>
                 └ <Dispatcher '0x22d02201510'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x0000022D7FA79A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022D01FC0610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000022D0266E790>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000022D0265B7D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000022D02ADD080>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x22d02201510'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x0000022D7FA7A700>
                 └ <Dispatcher '0x22d02201510'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000022D02ADC540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000022D7FA7A7A0>
                 └ <Dispatcher '0x22d02201510'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x0000022D7FA7A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000022D02ADCCC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000022D7FA79940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022D0266E750>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000022D0273D750>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000022D02ADCFE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000022D7FA7A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x0000022D7FA79A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000022D0266E750>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000022D0273D590>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x0000022D7FE9F100>, <function CallableObject.call at 0x0000022D029F8...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000022D0213D990>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x0000022D029F8220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000022D7FEFC040>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 29, in handle_update
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x0000022D7FEE71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
                        │    └ <function ManagerImpl.dialog at 0x0000022D7FEE6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
                        │      │      └ <Dialog(<StatesGroup 'CreateOffer'>)>
                        │      └ <function Window.render at 0x0000022D7FEFDC60>
                        └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
                         │    │         └ <Dialog(<StatesGroup 'CreateOffer'>)>
                         │    └ <function Window.load_data at 0x0000022D7FEFDA80>
                         └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000022D7FEE8A40>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000022D02122350>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000022D026EFC50>
    │    │            └ <Window(<State 'CreateOffer:confirm_offer_data'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok', 'channel_title': 'test', '...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_entered_offer_data at 0x0000022D01FEF6A0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000022D026EFC50>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 75, in get_entered_offer_data
    f"Контакти для звязку: {dialog_data['contacts']}\n"

KeyError: 'contacts'
2024-03-01T12:34:48.701497+0200 INFO Bot stopped!
2024-03-01T12:34:52.214947+0200 INFO Bot started!
2024-03-01T12:35:00.684476+0200 INFO ::1 [01/Mar/2024:12:35:00 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:00.920641+0200 INFO ::1 [01/Mar/2024:12:35:00 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:21.092872+0200 INFO ::1 [01/Mar/2024:12:35:21 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:21.173573+0200 INFO ::1 [01/Mar/2024:12:35:21 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:31.922554+0200 INFO Bot stopped!
2024-03-01T12:35:35.376253+0200 INFO Bot started!
2024-03-01T12:35:48.920450+0200 INFO ::1 [01/Mar/2024:12:35:48 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:49.162617+0200 INFO ::1 [01/Mar/2024:12:35:49 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T12:35:54.335842+0200 INFO ::1 [01/Mar/2024:12:35:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:35:54.523111+0200 INFO Update id=925012017 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T12:35:59.505737+0200 INFO ::1 [01/Mar/2024:12:35:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:35:59.595138+0200 INFO Update id=925012018 is not handled. Duration 94 ms by bot id=5646878393
2024-03-01T12:35:59.599139+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-29' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'BgManager' object has no attribute 'dialog_data'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002035088D710>
                   │    │          │                   │           └ {'update_id': 925012018, 'my_chat_member': {'chat': {'id': -1002030387989, 'title': 'Test #3', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000020350121AD0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002034DBCB1A0>
                   │    └ <Dispatcher '0x203500f3690'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002035088D710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000020350121AD0>
                 │    └ <function Dispatcher.feed_update at 0x000002034DBCB100>
                 └ <Dispatcher '0x203500f3690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002034DBC9940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000203507AAB10>
                     └ <Dispatcher '0x203500f3690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002035028FE10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000020350113810>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000020350122340>
          │    │   │      │    └ AttributeError("'BgManager' object has no attribute 'dialog_data'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000203508CEE30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002035096E490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000203507AB450>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000020350C33240>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000203507BE590>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000203507AB710>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012018, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000020350C30AE0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x203500f3690'>>, Update(update_id=925012018, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000002034DBCA700>
                 └ <Dispatcher '0x203500f3690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000020350C332E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002034DBC9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000203507A9950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002034DBCA7A0>
                 └ <Dispatcher '0x203500f3690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002034DBCA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000020350C30C20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002034DBC9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000203507BD110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002035088DB90>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000020350C30F40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002034DBCA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002034DBCA700>
                     └ <Router '0x203501239d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000020350C30FE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002034DBC9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002035030CF50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002034DBCA7A0>
                 └ <Router '0x203501239d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x000002034DBC9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002035030CF50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002035088D9D0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x000002034DFEF100>, <function CallableObject.call at 0x0000020350C30...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x203500f3690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x0000020350C30B80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x0000020350308AE0>, ChatMemberUpdated(chat=Chat(id=-1002030387989, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 40, in add_bot_handler
    dialog_data = bg.dialog_data
                  └ <aiogram_dialog.manager.bg_manager.BgManager object at 0x0000020350243310>

AttributeError: 'BgManager' object has no attribute 'dialog_data'
2024-03-01T12:44:59.977609+0200 INFO Bot stopped!
2024-03-01T12:45:03.660679+0200 INFO Bot started!
2024-03-01T12:45:12.699378+0200 INFO ::1 [01/Mar/2024:12:45:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:45:12.737739+0200 INFO Update id=925012019 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T12:45:12.741722+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'BgManager' object has no attribute 'load_data'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002C4E59322D0>
                   │    │          │                   │           └ {'update_id': 925012019, 'my_chat_member': {'chat': {'id': -1001812565202, 'title': 'Test #1', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000002C4E5262A50>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002C4E2D0B1A0>
                   │    └ <Dispatcher '0x2c4e58ec690'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002C4E59322D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000002C4E5262A50>
                 │    └ <function Dispatcher.feed_update at 0x000002C4E2D0B100>
                 └ <Dispatcher '0x2c4e58ec690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002C4E2D09940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002C4E53E66D0>
                     └ <Dispatcher '0x2c4e58ec690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002C4E5243650>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002C4E53B4F90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002C4E59D3480>
          │    │   │      │    └ AttributeError("'BgManager' object has no attribute 'load_data'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002C4E5A11F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002C4E5115510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002C4E5226E50>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000002C4E5B1B920>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002C4E53D2E10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002C4E58EF3D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012019, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000002C4E5C8C540>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2c4e58ec690'>>, Update(update_id=925012019, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000002C4E2D0A700>
                 └ <Dispatcher '0x2c4e58ec690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002C4E5C8C360>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002C4E2D09940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002C4E58ED610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002C4E2D0A7A0>
                 └ <Dispatcher '0x2c4e58ec690'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002C4E2D0A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002C4E5C8C2C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002C4E2D09940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002C4E58FCE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002C4E59D0CD0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002C4E5C8C4A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002C4E2D0A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002C4E2D0A700>
                     └ <Router '0x2c4e5252fd0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002C4E5C8C7C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002C4E2D09940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002C4E5451690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002C4E2D0A7A0>
                 └ <Router '0x2c4e5252fd0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x000002C4E2D09A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002C4E5451690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002C4E5115610>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x000002C4E312F100>, <function CallableObject.call at 0x000002C4E5C8C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x2c4e58ec690'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x000002C4E5C8C0E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000002C4E5444AE0>, ChatMemberUpdated(chat=Chat(id=-1001812565202, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 40, in add_bot_handler
    dialog_data = bg.load_data()
                  └ <aiogram_dialog.manager.bg_manager.BgManager object at 0x000002C4E5989890>

AttributeError: 'BgManager' object has no attribute 'load_data'
2024-03-01T12:49:24.694570+0200 INFO Bot stopped!
2024-03-01T12:49:28.391281+0200 INFO Bot started!
2024-03-01T12:50:04.644111+0200 INFO ::1 [01/Mar/2024:12:50:04 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:50:04.826416+0200 INFO Update id=925012020 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T12:50:04.833006+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-13' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'dialog_manager'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x0000021E6452E700>
          │    └ <Dispatcher '0x21e67108750'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x0000021E66A50250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000021E647262A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000021E6452D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000021E66C06B10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000021E6710B3D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000021E6710B150>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000021E66C451C0>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'dialog_manager'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000021E674B8F40>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000021E66935B50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000021E66A82690>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000021E64726200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000021E6452E7A0>
                 └ <Dispatcher '0x21e67108750'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x0000021E6452DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000021E66C06B10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000021E66A44710>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000021E66A73610>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000021E6733FF60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x21e67108750'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x0000021E6452E700>
                 └ <Dispatcher '0x21e67108750'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000021E674B0400>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000021E6452E7A0>
                 └ <Dispatcher '0x21e67108750'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x0000021E6452E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000021E674B0180>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000021E6452D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000021E6711E910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000021E671ED750>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000021E674B1A80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000021E6452E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x0000021E6452DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000021E6711E910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000021E671ED610>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000021E6494F100>, <function CallableObject.call at 0x0000021E674B0...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021E66CB0F90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x0000021E674B0900>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000021E649AC040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x0000021E64996C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x0000021E64996DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>
          │    └ <function ManagerImpl.dialog at 0x0000021E64996520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x0000021E66B33C40>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x0000021E6494E200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021E67211F10>)
          └ <function on_start_purchase at 0x0000021E66B33C40>

TypeError: on_start_purchase() missing 1 required positional argument: 'dialog_manager'
2024-03-01T12:50:20.275455+0200 INFO Bot stopped!
2024-03-01T12:50:33.545273+0200 INFO Bot started!
2024-03-01T12:50:38.925981+0200 INFO ::1 [01/Mar/2024:12:50:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:50:38.930627+0200 INFO Update id=925012021 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:50:46.866320+0200 INFO ::1 [01/Mar/2024:12:50:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:50:46.869927+0200 INFO Update id=925012022 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:51:05.368188+0200 INFO ::1 [01/Mar/2024:12:51:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:51:05.371798+0200 INFO Update id=925012023 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:51:43.512574+0200 INFO ::1 [01/Mar/2024:12:51:43 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:51:43.516067+0200 INFO Update id=925012024 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:51:48.398925+0200 INFO Bot stopped!
2024-03-01T12:51:51.724999+0200 INFO Bot started!
2024-03-01T12:51:56.226164+0200 INFO ::1 [01/Mar/2024:12:51:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:51:56.231900+0200 INFO Update id=925012025 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T12:52:02.337767+0200 INFO ::1 [01/Mar/2024:12:52:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:52:02.478166+0200 INFO Update id=925012026 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T12:52:03.444418+0200 INFO ::1 [01/Mar/2024:12:52:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:52:03.631561+0200 INFO Update id=925012027 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T12:52:09.557835+0200 INFO ::1 [01/Mar/2024:12:52:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:52:09.739765+0200 INFO Update id=925012028 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T12:52:09.744762+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'result'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000001F51859A700>
          │    └ <Dispatcher '0x1f51ac77610'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000001F51B1C2C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001F51B5F1A80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F518599940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F51AC1E1D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001F51B17BAD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001F51B17B750>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001F51B686880>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'result'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001F51B5206D0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001F51B687190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001F51B17BE90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001F518796200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F51859A7A0>
                 └ <Dispatcher '0x1f51ac77610'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000001F518599A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F51AC1E1D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001F51B18EFD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001F51AC75910>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000001F51B518040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1f51ac77610'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000001F51859A700>
                 └ <Dispatcher '0x1f51ac77610'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001F51B51A160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F51859A7A0>
                 └ <Dispatcher '0x1f51ac77610'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000001F51859A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001F51B51B060>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001F518599940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F51AC5F550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001F51B25D990>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001F51B51B380>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001F51859A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000001F518599A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001F51AC5F550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001F51B25D810>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x000001F5189BF100>, <function CallableObject.call at 0x000001F51B51B...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001F518911B90>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000001F51B51B560>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000001F518A1C040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x000001F518A06C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x000001F518A06DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>
          │    └ <function ManagerImpl.dialog at 0x000001F518A06520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x000001F51AB0FF60>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x000001F5189BE200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001F51B34E390>)
          └ <function on_start_purchase at 0x000001F51AB0FF60>

TypeError: on_start_purchase() missing 1 required positional argument: 'result'
2024-03-01T12:53:25.012534+0200 INFO Bot stopped!
2024-03-01T12:53:28.774687+0200 INFO Bot started!
2024-03-01T12:53:33.446401+0200 INFO ::1 [01/Mar/2024:12:53:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:53:33.677507+0200 INFO Update id=925012029 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T12:53:34.270352+0200 INFO ::1 [01/Mar/2024:12:53:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:53:34.528307+0200 INFO Update id=925012030 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T12:53:43.882317+0200 INFO ::1 [01/Mar/2024:12:53:43 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:53:44.060549+0200 INFO Update id=925012031 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T12:53:44.066548+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'data'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000127E30BA700>
          │    └ <Dispatcher '0x127e5c9c350'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000127E5CEE890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000127E32B62A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000127E30B9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000127E5842ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000127E56FF750>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000127E56FFFD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000127E5FBB900>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'data'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000127E60405E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000127E5732790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000127E5C9EF90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000127E32B6200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000127E30BA7A0>
                 └ <Dispatcher '0x127e5c9c350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000127E30B9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000127E5842ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000127E5CADF50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000127E5732850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000127E603F380>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x127e5c9c350'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000127E30BA700>
                 └ <Dispatcher '0x127e5c9c350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000127E603C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000127E30BA7A0>
                 └ <Dispatcher '0x127e5c9c350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000127E30BA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000127E603C540>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000127E30B9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000127E5CAE310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000127E5D80CD0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000127E603C220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000127E30BA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x00000127E30B9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000127E5CAE310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000127E5D80B10>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x00000127E34DF100>, <function CallableObject.call at 0x00000127E603D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000127E5732E50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x00000127E603D9E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000127E353C040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x00000127E3526C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x00000127E3526DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>
          │    └ <function ManagerImpl.dialog at 0x00000127E3526520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x00000127E48554E0>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x00000127E34DE200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000127E5C9EA90>)
          └ <function on_start_purchase at 0x00000127E48554E0>

TypeError: on_start_purchase() missing 1 required positional argument: 'data'
2024-03-01T12:53:57.181158+0200 INFO Bot stopped!
2024-03-01T12:54:00.823777+0200 INFO Bot started!
2024-03-01T12:54:03.103827+0200 INFO ::1 [01/Mar/2024:12:54:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:54:03.349081+0200 INFO Update id=925012032 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T12:54:03.956863+0200 INFO ::1 [01/Mar/2024:12:54:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:54:04.337500+0200 INFO Update id=925012033 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T12:54:07.573645+0200 INFO ::1 [01/Mar/2024:12:54:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:54:07.751229+0200 INFO Update id=925012034 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T12:54:07.757229+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'dialog_manager'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000002136081E700>
          │    └ <Dispatcher '0x213633fc350'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000213635088D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000021360A162A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002136081D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000213633FE490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002136202A650>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000021362EC7850>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000213635EABC0>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'dialog_manager'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000213637A05E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000021362EC7910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000021362D34950>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000021360A16200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002136081E7A0>
                 └ <Dispatcher '0x213633fc350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000002136081DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000213633FE490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002136340DF10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000021362D71ED0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000213634F4360>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x213633fc350'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000002136081E700>
                 └ <Dispatcher '0x213633fc350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002136379C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002136081E7A0>
                 └ <Dispatcher '0x213633fc350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000002136081E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002136379C040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002136081D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002136340DE90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000213634DD150>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002136379C540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002136081E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000002136081DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002136340DE90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000021362EC7510>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000021360C3F100>, <function CallableObject.call at 0x000002136379D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000021362D71E10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000002136379D9E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000021360C9C040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x0000021360C86C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x0000021360C86DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>
          │    └ <function ManagerImpl.dialog at 0x0000021360C86520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x0000021360FE54E0>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x0000021360C3E200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000021362D35B50>)
          └ <function on_start_purchase at 0x0000021360FE54E0>

TypeError: on_start_purchase() missing 1 required positional argument: 'dialog_manager'
2024-03-01T12:56:46.077948+0200 INFO Bot stopped!
2024-03-01T12:56:49.627999+0200 INFO Bot started!
2024-03-01T12:56:50.579159+0200 INFO ::1 [01/Mar/2024:12:56:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:56:50.737073+0200 INFO Update id=925012035 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T12:56:52.224179+0200 INFO ::1 [01/Mar/2024:12:56:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:56:52.415120+0200 INFO Update id=925012036 is handled. Duration 187 ms by bot id=5646878393
2024-03-01T12:56:55.868013+0200 INFO ::1 [01/Mar/2024:12:56:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:56:56.046489+0200 INFO Update id=925012037 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T12:56:56.053485+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'data'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000001E2D48EA700>
          │    └ <Dispatcher '0x1e2d61352d0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000001E2D78D3290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E2D4AE62A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2D48E9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E2D74CAB90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001E2D6E05BD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001E2D6E431D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001E2D79D5F80>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'data'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001E2D78745E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001E2D7892310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001E2D6F92F10>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E2D4AE6200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2D48EA7A0>
                 └ <Dispatcher '0x1e2d61352d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E2D48E9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E2D74CAB90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E2D74DE5D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E2D6F33DD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000001E2D786F560>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1e2d61352d0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000001E2D48EA700>
                 └ <Dispatcher '0x1e2d61352d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E2D786C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2D48EA7A0>
                 └ <Dispatcher '0x1e2d61352d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000001E2D48EA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E2D786D9E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2D48E9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E2D6FC6C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001E2D75AD750>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E2D786F4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2D48EA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E2D48E9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E2D6FC6C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001E2D6FC5590>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x000001E2D4D0F100>, <function CallableObject.call at 0x000001E2D711C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001E2CF047290>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000001E2D711CF40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000001E2D4D6C040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x000001E2D4D56C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x000001E2D4D56DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>
          │    └ <function ManagerImpl.dialog at 0x000001E2D4D56520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x000001E2D6E5FF60>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x000001E2D4D0E200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E2D7A33D50>)
          └ <function on_start_purchase at 0x000001E2D6E5FF60>

TypeError: on_start_purchase() missing 1 required positional argument: 'data'
2024-03-01T12:57:08.757653+0200 INFO Bot stopped!
2024-03-01T12:57:12.170900+0200 INFO Bot started!
2024-03-01T12:57:46.969395+0200 INFO ::1 [01/Mar/2024:12:57:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:57:47.201635+0200 INFO Update id=925012038 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T12:57:47.682221+0200 INFO ::1 [01/Mar/2024:12:57:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:57:47.871805+0200 INFO Update id=925012039 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T12:57:57.610558+0200 INFO ::1 [01/Mar/2024:12:57:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:57:57.788230+0200 INFO Update id=925012040 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T12:57:57.794346+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("on_start_purchase() missing 1 required positional argument: 'data'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000001D6140CE700>
          │    └ <Dispatcher '0x1d616620890'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000001D6170D8CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001D6142C62A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D6140CD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D6165E5150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001D6167A7A50>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001D616CAB690>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001D6170B7D40>
          │    │   │      │    └ TypeError("on_start_purchase() missing 1 required positional argument: 'data'")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001D6170546D0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001D6165E7550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001D616CABA10>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001D6142C6200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D6140CE7A0>
                 └ <Dispatcher '0x1d616620890'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000001D6140CDA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D6165E5150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001D616CBEA50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001D6167E9BD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000001D616EDFE20>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1d616620890'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000001D6140CE700>
                 └ <Dispatcher '0x1d616620890'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001D61704C040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D6140CE7A0>
                 └ <Dispatcher '0x1d616620890'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000001D6140CE700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001D61704C400>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D6140CD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D616CBEE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001D616D8D990>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001D61704C360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D6140CE7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000001D6140CDA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D616CBEE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001D616755910>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x000001D6144EF100>, <function CallableObject.call at 0x000001D61704F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001D61688F790>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000001D61704F420>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000001D61454C040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x000001D614536C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x000001D614536DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 261, in _start_normal
    await self.dialog().process_start(self, data, state)
          │    │                      │     │     └ <State 'TopUpOperations:select_pament_method'>
          │    │                      │     └ {'payment_type': 'offer_purchase'}
          │    │                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>
          │    └ <function ManagerImpl.dialog at 0x000001D614536520>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 94, in process_start
    await self._process_callback(self.on_start, start_data, manager)
          │    │                 │    │         │           └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>
          │    │                 │    │         └ {'payment_type': 'offer_purchase'}
          │    │                 │    └ <function on_start_purchase at 0x000001D6148954E0>
          │    │                 └ <Dialog(<StatesGroup 'TopUpOperations'>)>
          │    └ <function Dialog._process_callback at 0x000001D6144EE200>
          └ <Dialog(<StatesGroup 'TopUpOperations'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 100, in _process_callback
    await callback(*args, **kwargs)
          │         │       └ {}
          │         └ ({'payment_type': 'offer_purchase'}, <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001D616EA5CD0>)
          └ <function on_start_purchase at 0x000001D6148954E0>

TypeError: on_start_purchase() missing 1 required positional argument: 'data'
2024-03-01T12:59:36.425519+0200 INFO Bot stopped!
2024-03-01T12:59:39.978272+0200 INFO Bot started!
2024-03-01T12:59:42.465294+0200 INFO Bot stopped!
2024-03-01T12:59:45.842935+0200 INFO Bot started!
2024-03-01T12:59:47.443119+0200 INFO ::1 [01/Mar/2024:12:59:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:59:47.626609+0200 INFO Update id=925012041 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T12:59:48.025818+0200 INFO ::1 [01/Mar/2024:12:59:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:59:48.338076+0200 INFO Update id=925012042 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T12:59:50.848327+0200 INFO ::1 [01/Mar/2024:12:59:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T12:59:51.031061+0200 INFO Update id=925012043 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T12:59:51.032788+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T12:59:51.038790+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('crypto_bot_client')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000252B827A700>
          │    └ <Dispatcher '0x252bae58390'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000252BB25B810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000252B84762A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000252B8279940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000252BA923450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000252BA955C10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000252BAE5AD50>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000252BB365300>
          │    │   │      │    └ KeyError('crypto_bot_client')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000252BB2005E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000252BAE94F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000252BA8F2910>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000252B8476200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252B827A7A0>
                 └ <Dispatcher '0x252bae58390'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000252B8279A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000252BA923450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000252B872D690>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000252BA7C0D50>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000252BAAA3EC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x252bae58390'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000252B827A700>
                 └ <Dispatcher '0x252bae58390'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000252BB1FC180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252B827A7A0>
                 └ <Dispatcher '0x252bae58390'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000252B827A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000252BB1FC040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000252B8279940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000252BA93E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000252BAF40BD0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000252BB1FC680>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252B827A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x00000252B8279A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000252BA93E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000252BAF40AD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x00000252B869F100>, <function CallableObject.call at 0x00000252BB2E9...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000252BA8BF910>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x00000252BB2E9D00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000252B86FC040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x00000252B86E6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x00000252B86E6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000252B86E71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
                        │    └ <function ManagerImpl.dialog at 0x00000252B86E6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x00000252B86FDC60>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x00000252B86FDA80>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000252B86E8B30>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000252BAF2BB90>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'payment_type': 'offer_purchase'}, 'middleware_data': {'bot': <aiogram.client.bot.Bot obje...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x00000252BA883D80>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000252BAF2BB90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 17, in get_price
    crypto_bot_client: AioCryptoPay = dialog_manager.middleware_data['crypto_bot_client']
                                      │              └ <property object at 0x00000252B86E8B30>
                                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000252BA9FE050>

KeyError: 'crypto_bot_client'
2024-03-01T13:40:46.964501+0200 INFO Bot stopped!
2024-03-01T13:40:50.820384+0200 INFO Bot started!
2024-03-01T13:41:02.107081+0200 INFO ::1 [01/Mar/2024:13:41:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:41:02.326182+0200 INFO Update id=925012044 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T13:41:03.083363+0200 INFO ::1 [01/Mar/2024:13:41:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:41:03.353363+0200 INFO Update id=925012045 is handled. Duration 265 ms by bot id=5646878393
2024-03-01T13:41:07.698300+0200 INFO ::1 [01/Mar/2024:13:41:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:41:07.735942+0200 INFO Update id=925012046 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T13:41:07.742780+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=ArgumentError('Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000220F34FD250>
                   │    │          │                   │           └ {'update_id': 925012046, 'my_chat_member': {'chat': {'id': -1002030387989, 'title': 'Test #3', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000220F2F17710>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000220F083B1A0>
                   │    └ <Dispatcher '0x220f2f17d90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000220F34FD250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000220F2F17710>
                 │    └ <function Dispatcher.feed_update at 0x00000220F083B100>
                 └ <Dispatcher '0x220f2f17d90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000220F0839940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000220F2EE2490>
                     └ <Dispatcher '0x220f2f17d90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000220F2D7AFD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000220F0CE4E90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000220F3821480>
          │    │   │      │    └ ArgumentError('Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.')
          │    │   │      └ <class 'sqlalchemy.exc.ArgumentError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000220F3542110>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000220F35EC950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000220F2C40A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000220F3063F60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000220F342E890>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000220F2D4BE90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012046, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000220F3514400>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x220f2f17d90'>>, Update(update_id=925012046, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x00000220F083A700>
                 └ <Dispatcher '0x220f2f17d90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000220F37BDA80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000220F0839940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000220F3419BD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000220F083A7A0>
                 └ <Dispatcher '0x220f2f17d90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x00000220F083A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000220F37BF420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000220F0839940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000220F342D350>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000220F34FCF50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000220F37BC5E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000220F083A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x00000220F083A700>
                     └ <Router '0x220f2f15b10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000220F37BC540>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000220F0839940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000220F2F86010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000220F083A7A0>
                 └ <Router '0x220f2f15b10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x00000220F0839A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000220F2F86010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000220F3455550>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x00000220F0C5F100>, <function CallableObject.call at 0x00000220F37BC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x220f2f17d90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x00000220F37BC180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x00000220F2F7CB80>, ChatMemberUpdated(chat=Chat(id=-1002030387989, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 48, in add_bot_handler
    await repo.channel_repo.add_channe_for_traffic(*channel_data)
          │    │            │                       └ {'channel_id': -1002030387989, 'channel_title': 'Test #3', 'channel_owner_id': 387375605}
          │    │            └ <function ChannelRequestsRepo.add_channe_for_traffic at 0x00000220F2CA7D80>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x00000220F35DEF50>
          └ <bot.db.Repo object at 0x00000220F35DFA50>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 46, in add_channe_for_traffic
    query = insert(ChannelsForTraffic).values(
            │      └ <class 'bot.db.models.models.ChannelsForTraffic'>
            └ <function insert at 0x00000220F2BE3BA0>

  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 280, in _generative
    x = fn(self, *args, **kw)
        │  │      │       └ {}
        │  │      └ ('channel_id', 'channel_title', 'channel_owner_id')
        │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x00000220F3853B90>
        └ <function ValuesBase.values at 0x00000220F2593740>
  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 313, in check
    return fn(self, *args, **kw)
           │  │      │       └ {}
           │  │      └ ('channel_id', 'channel_title', 'channel_owner_id')
           │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x00000220F3853B90>
           └ <function ValuesBase.values at 0x00000220F25936A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\dml.py", line 1117, in values
    raise exc.ArgumentError(
          │   └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.ArgumentError: Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.
2024-03-01T13:43:37.870072+0200 INFO Bot stopped!
2024-03-01T13:43:41.602895+0200 INFO Bot started!
2024-03-01T13:45:35.346147+0200 INFO ::1 [01/Mar/2024:13:45:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:45:35.618316+0200 INFO Update id=925012047 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T13:45:36.302913+0200 INFO ::1 [01/Mar/2024:13:45:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:45:36.469771+0200 INFO Update id=925012048 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T13:45:40.711271+0200 INFO ::1 [01/Mar/2024:13:45:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:45:40.748621+0200 INFO Update id=925012049 is not handled. Duration 31 ms by bot id=5646878393
2024-03-01T13:45:40.752829+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=ArgumentError('Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002372FB8C9D0>
                   │    │          │                   │           └ {'update_id': 925012049, 'my_chat_member': {'chat': {'id': -1002030387989, 'title': 'Test #3', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000002372F3E1810>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002372CECF1A0>
                   │    └ <Dispatcher '0x2372f3ee290'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002372FB8C9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000002372F3E1810>
                 │    └ <function Dispatcher.feed_update at 0x000002372CECF100>
                 └ <Dispatcher '0x2372f3ee290'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002372CECD940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002372F513410>
                     └ <Dispatcher '0x2372f3ee290'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002372F5AAA10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002372F574ED0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002372FEABD80>
          │    │   │      │    └ ArgumentError('Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.')
          │    │   │      └ <class 'sqlalchemy.exc.ArgumentError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002372FBD5D50>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002372FC76A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002372F4134D0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000002372F6FC040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002372F592050>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002372F652990>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012049, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000002372FBA40E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2372f3ee290'>>, Update(update_id=925012049, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000002372CECE700>
                 └ <Dispatcher '0x2372f3ee290'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002372FE4C040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002372CECD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002372FAA9590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002372CECE7A0>
                 └ <Dispatcher '0x2372f3ee290'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002372CECE700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002372FE4D4E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002372CECD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002372FABCC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002372FB8D590>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002372FE4C220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002372CECE7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002372CECE700>
                     └ <Router '0x2372f413e10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002372FE4D300>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002372CECD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002372F614E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002372CECE7A0>
                 └ <Router '0x2372f413e10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x000002372CECDA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002372F614E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002372FB8D390>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x000002372D2EF100>, <function CallableObject.call at 0x000002372FE4F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x2372f3ee290'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x000002372FE4F420>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000002372F60CCC0>, ChatMemberUpdated(chat=Chat(id=-1002030387989, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 48, in add_bot_handler
    await repo.channel_repo.add_channe_for_traffic(*channel_data)
          │    │            │                       └ {'channel_id': -1002030387989, 'channel_title': 'Test #3', 'channel_owner_id': 387375605}
          │    │            └ <function ChannelRequestsRepo.add_channe_for_traffic at 0x000002372F33BEC0>
          │    └ <bot.db.requests.channel_requests.ChannelRequestsRepo object at 0x000002372F3EC910>
          └ <bot.db.Repo object at 0x000002372FC77010>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\channel_requests.py", line 46, in add_channe_for_traffic
    query = insert(ChannelsForTraffic).values(
            │      └ <class 'bot.db.models.models.ChannelsForTraffic'>
            └ <function insert at 0x000002372F277BA0>

  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 280, in _generative
    x = fn(self, *args, **kw)
        │  │      │       └ {}
        │  │      └ ('channel_id', 'channel_title', 'channel_owner_id')
        │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000002372FEAA290>
        └ <function ValuesBase.values at 0x000002372EC23740>
  File "<string>", line 2, in values
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\base.py", line 313, in check
    return fn(self, *args, **kw)
           │  │      │       └ {}
           │  │      └ ('channel_id', 'channel_title', 'channel_owner_id')
           │  └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000002372FEAA290>
           └ <function ValuesBase.values at 0x000002372EC236A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\dml.py", line 1117, in values
    raise exc.ArgumentError(
          │   └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.ArgumentError: Only a single dictionary/tuple or list of dictionaries/tuples is accepted positionally.
2024-03-01T13:46:04.014433+0200 INFO Bot stopped!
2024-03-01T13:46:07.692995+0200 INFO Bot started!
2024-03-01T13:46:17.720310+0200 INFO Bot stopped!
2024-03-01T13:46:21.074184+0200 INFO Bot started!
2024-03-01T13:46:21.446697+0200 INFO ::1 [01/Mar/2024:13:46:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:46:21.599416+0200 INFO Update id=925012050 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T13:46:23.183794+0200 INFO ::1 [01/Mar/2024:13:46:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:46:23.394598+0200 INFO Update id=925012051 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T13:46:26.687779+0200 INFO ::1 [01/Mar/2024:13:46:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:46:26.806753+0200 INFO Update id=925012052 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T13:46:31.866816+0200 INFO ::1 [01/Mar/2024:13:46:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:46:32.187199+0200 INFO Update id=925012053 is not handled. Duration 311 ms by bot id=5646878393
2024-03-01T13:46:32.190200+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-29' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError('__init__() takes 1 positional argument but 2 were given')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E8D90EE250>
                   │    │          │                   │           └ {'update_id': 925012053, 'my_chat_member': {'chat': {'id': -1002030387989, 'title': 'Test #3', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001E8D8943ED0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001E8D642F1A0>
                   │    └ <Dispatcher '0x1e8d8984f50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E8D90EE250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001E8D8943ED0>
                 │    └ <function Dispatcher.feed_update at 0x000001E8D642F100>
                 └ <Dispatcher '0x1e8d8984f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8D642D940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8D8AF0A50>
                     └ <Dispatcher '0x1e8d8984f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001E8D8A779D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001E8D8975690>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001E8D9565280>
          │    │   │      │    └ TypeError('__init__() takes 1 positional argument but 2 were given')
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001E8D9135D50>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001E8D9433BD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001E8D8ACBE90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001E8D8C5C040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E8D901E890>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E8D8AD81D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012053, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001E8D91044A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1e8d8984f50'>>, Update(update_id=925012053, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000001E8D642E700>
                 └ <Dispatcher '0x1e8d8984f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8D93A42C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8D642D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8D900DD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8D642E7A0>
                 └ <Dispatcher '0x1e8d8984f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001E8D642E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8D93A5B20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8D642D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8D901D390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001E8D90EDF10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8D93A76A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8D642E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001E8D642E700>
                     └ <Router '0x1e8d8ab5150'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8D93A7560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8D642D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8D8B719D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8D642E7A0>
                 └ <Router '0x1e8d8ab5150'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E8D642DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8D8B719D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001E8D90EDCD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x000001E8D684F100>, <function CallableObject.call at 0x000001E8D93A7...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1e8d8984f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1002030387989, type='channel', title='Test #3', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x000001E8D93A71A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000001E8D8B68CC0>, ChatMemberUpdated(chat=Chat(id=-1002030387989, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 68, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(**offer_data)
                        │    │          │           └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1002030387989, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x000001E8D88C8220>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001E8D941AA50>
                        └ <bot.db.Repo object at 0x000001E8D901EA90>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 13, in add_offer
    query = Offers(
            └ <class 'bot.db.models.models.Offers'>

TypeError: __init__() takes 1 positional argument but 2 were given
2024-03-01T13:46:48.128128+0200 INFO Bot stopped!
2024-03-01T13:46:51.621109+0200 INFO Bot started!
2024-03-01T13:47:20.302709+0200 INFO Bot stopped!
2024-03-01T13:47:23.721399+0200 INFO Bot started!
2024-03-01T13:47:24.334896+0200 INFO ::1 [01/Mar/2024:13:47:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:47:24.653343+0200 INFO Update id=925012054 is handled. Duration 311 ms by bot id=5646878393
2024-03-01T13:47:25.326139+0200 INFO ::1 [01/Mar/2024:13:47:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:47:25.655937+0200 INFO Update id=925012055 is handled. Duration 327 ms by bot id=5646878393
2024-03-01T13:47:29.635971+0200 INFO ::1 [01/Mar/2024:13:47:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:47:29.678785+0200 INFO Update id=925012056 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T13:47:29.681785+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError('__init__() takes 1 positional argument but 2 were given')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000024F29B7AC50>
                   │    │          │                   │           └ {'update_id': 925012056, 'my_chat_member': {'chat': {'id': -1001812565202, 'title': 'Test #1', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000024F273A7650>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000024F26EFB1A0>
                   │    └ <Dispatcher '0x24f295a0d50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000024F29B7AC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000024F273A7650>
                 │    └ <function Dispatcher.feed_update at 0x0000024F26EFB100>
                 └ <Dispatcher '0x24f295a0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024F26EF9940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024F29560D50>
                     └ <Dispatcher '0x24f295a0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000024F29ADFC90>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000024F29ADFCD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000024F29AEB600>
          │    │   │      │    └ TypeError('__init__() takes 1 positional argument but 2 were given')
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000024F29C06020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000024F29C9EE50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000024F29AE8390>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000024F29BD40E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000024F29AEB450>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000024F295D7950>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012056, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000024F29E7C180>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x24f295a0d50'>>, Update(update_id=925012056, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x0000024F26EFA700>
                 └ <Dispatcher '0x24f295a0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024F29E7C4A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024F26EF9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024F29ADE710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024F26EFA7A0>
                 └ <Dispatcher '0x24f295a0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x0000024F26EFA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024F29E7F4C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024F26EF9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024F29AE9E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000024F29BBE790>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000024F29E7C680>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024F26EFA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x0000024F26EFA700>
                     └ <Router '0x24f29418b50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024F29E7C040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024F26EF9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024F2963A510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024F26EFA7A0>
                 └ <Router '0x24f29418b50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x0000024F26EF9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024F2963A510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000024F29BBE6D0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x0000024F2731F100>, <function CallableObject.call at 0x0000024F29E7D...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x24f295a0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x0000024F29E7DB20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x0000024F2963CB80>, ChatMemberUpdated(chat=Chat(id=-1001812565202, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 68, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(**offer_data)
                        │    │          │           └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001812565202, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x0000024F29398220>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x0000024F2941BF10>
                        └ <bot.db.Repo object at 0x0000024F2941AE50>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 13, in add_offer
    query = Offers(
            └ <class 'bot.db.models.models.Offers'>

TypeError: __init__() takes 1 positional argument but 2 were given
2024-03-01T13:49:21.687741+0200 INFO Bot stopped!
2024-03-01T13:49:25.234866+0200 INFO Bot started!
2024-03-01T13:49:27.286726+0200 INFO ::1 [01/Mar/2024:13:49:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:49:27.656275+0200 INFO Update id=925012057 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T13:49:28.108885+0200 INFO ::1 [01/Mar/2024:13:49:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:49:28.265660+0200 INFO Update id=925012058 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T13:49:36.612536+0200 INFO ::1 [01/Mar/2024:13:49:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:49:36.633023+0200 INFO Update id=925012059 is not handled. Duration 14 ms by bot id=5646878393
2024-03-01T13:49:36.638019+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyNotFoundError('channel_already_added')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000025142B22010>
                   │    │          │                   │           └ {'update_id': 925012059, 'my_chat_member': {'chat': {'id': -1001812565202, 'title': 'Test #1', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000025142B22A10>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002514047F1A0>
                   │    └ <Dispatcher '0x25142b20d50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000025142B22010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000025142B22A10>
                 │    └ <function Dispatcher.feed_update at 0x000002514047F100>
                 └ <Dispatcher '0x25142b20d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002514047D940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000251429D0B50>
                     └ <Dispatcher '0x25142b20d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000251429B2790>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000025142990710>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000025142AC3400>
          │    │   │      │    └ KeyNotFoundError('channel_already_added')
          │    │   │      └ <class 'aiogram_i18n.exceptions.KeyNotFoundError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000025143186020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002514341F110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002514305B2D0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000025142CAC040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002514306E390>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000025142B56ED0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012059, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000251431544A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x25142b20d50'>>, Update(update_id=925012059, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000002514047E700>
                 └ <Dispatcher '0x25142b20d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000251433F9B20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002514047D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025142B3FFD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002514047E7A0>
                 └ <Dispatcher '0x25142b20d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002514047E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000251433F8680>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002514047D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002514306CDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002514313D410>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000251433F8360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002514047E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000002514047E700>
                     └ <Router '0x25142ac3e10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000251433F87C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002514047D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025142BC21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002514047E7A0>
                 └ <Router '0x25142ac3e10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x000002514047DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025142BC21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000025142B57B90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x000002514089F100>, <function CallableObject.call at 0x00000251433FB...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x25142b20d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x00000251433FB4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x0000025142BB8CC0>, ChatMemberUpdated(chat=Chat(id=-1001812565202, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 35, in add_bot_handler
    return await bot.send_message(inviter_id, i18n.get("channel_already_added"))
                 │   │            │           │    └ <function I18nContext.get at 0x0000025140910FE0>
                 │   │            │           └ <aiogram_i18n.context.I18nContext object at 0x000002514313E810>
                 │   │            └ 387375605
                 │   └ <function Bot.send_message at 0x000002514040AF20>
                 └ <aiogram.client.bot.Bot object at 0x0000025142B22A10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_i18n\context.py", line 39, in get
    return self.core.get(key, self.locale, **kwargs)
           │    │    │   │    │    │         └ {}
           │    │    │   │    │    └ 'uk'
           │    │    │   │    └ <aiogram_i18n.context.I18nContext object at 0x000002514313E810>
           │    │    │   └ 'channel_already_added'
           │    │    └ <function FluentRuntimeCore.get at 0x0000025141B9FF60>
           │    └ <aiogram_i18n.cores.fluent_runtime_core.FluentRuntimeCore object at 0x000002514305B150>
           └ <aiogram_i18n.context.I18nContext object at 0x000002514313E810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_i18n\cores\fluent_runtime_core.py", line 49, in get
    raise KeyNotFoundError(message_id) from None
          │                └ 'channel_already_added'
          └ <class 'aiogram_i18n.exceptions.KeyNotFoundError'>

aiogram_i18n.exceptions.KeyNotFoundError: Key 'channel_already_added' not found.
2024-03-01T13:50:03.009434+0200 INFO Bot stopped!
2024-03-01T13:50:06.486282+0200 INFO Bot started!
2024-03-01T13:50:09.294209+0200 INFO ::1 [01/Mar/2024:13:50:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:50:09.337738+0200 INFO Update id=925012060 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T13:50:09.340735+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError('OfferRequestsRepo.add_offer() takes 1 positional argument but 16 were given')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E8C2D2D7D0>
                   │    │          │                   │           └ {'update_id': 925012060, 'my_chat_member': {'chat': {'id': -1001960731769, 'title': 'Test #2', 'username': 'test1231324124', ...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001E8C04F5290>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001E8C006B1A0>
                   │    └ <Dispatcher '0x1e8c25ac090'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E8C2D2D7D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001E8C04F5290>
                 │    └ <function Dispatcher.feed_update at 0x000001E8C006B100>
                 └ <Dispatcher '0x1e8c25ac090'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8C0069940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8C26E4190>
                     └ <Dispatcher '0x1e8c25ac090'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001E8C27127D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001E8C2C4BB50>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001E8C302CE40>
          │    │   │      │    └ TypeError('OfferRequestsRepo.add_offer() takes 1 positional argument but 16 were given')
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001E8C2D75E40>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001E8C26E4050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001E8C2C4BF10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001E8C2E7FA60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E8C2C5F010>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E8C2728190>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012060, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001E8C2FEC680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1e8c25ac090'>>, Update(update_id=925012060, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000001E8C006A700>
                 └ <Dispatcher '0x1e8c25ac090'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8C2FEC540>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8C0069940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8C2C4A290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8C006A7A0>
                 └ <Dispatcher '0x1e8c25ac090'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001E8C006A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8C2FEC5E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8C0069940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8C2C5DAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001E8C2D2DC50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8C2FEC040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8C006A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001E8C006A700>
                     └ <Router '0x1e8c2728110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E8C2FEC900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E8C0069940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8C27AA3D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E8C006A7A0>
                 └ <Router '0x1e8c2728110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E8C0069A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E8C27AA3D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001E8C2D2DA90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<function context_saver_middleware at 0x000001E8C048F100>, <function CallableObject.call at 0x000001E8C2FEC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1e8c25ac090'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                   └ <function CallableObject.call at 0x000001E8C2FEC220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000001E8C27ACB80>, ChatMemberUpdated(chat=Chat(id=-1001960731769, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 66, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(*offer_data)
                        │    │          │          └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001960731769, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x000001E8C25000E0>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001E8C2E2B390>
                        └ <bot.db.Repo object at 0x000001E8C2E387D0>

TypeError: OfferRequestsRepo.add_offer() takes 1 positional argument but 16 were given
2024-03-01T13:51:15.452832+0200 INFO Bot stopped!
2024-03-01T13:51:19.035023+0200 INFO Bot started!
2024-03-01T13:51:22.993621+0200 INFO ::1 [01/Mar/2024:13:51:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:51:23.180555+0200 INFO Update id=925012061 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T13:51:24.022839+0200 INFO ::1 [01/Mar/2024:13:51:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:51:24.535786+0200 INFO Update id=925012062 is handled. Duration 516 ms by bot id=5646878393
2024-03-01T13:51:27.321668+0200 INFO ::1 [01/Mar/2024:13:51:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:51:27.478551+0200 INFO Update id=925012063 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T13:51:35.412619+0200 INFO ::1 [01/Mar/2024:13:51:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:51:35.617001+0200 INFO Update id=925012064 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T13:51:42.009359+0200 INFO ::1 [01/Mar/2024:13:51:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:51:42.192760+0200 INFO Update id=925012065 is not handled. Duration 188 ms by bot id=5646878393
2024-03-01T13:51:42.199756+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-33' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError("'price_per_request' is an invalid keyword argument for Offers")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001D09A49D110>
                   │    │          │                   │           └ {'update_id': 925012065, 'my_chat_member': {'chat': {'id': -1001893185794, 'title': 'test 2032345023', 'username': 'sd234223'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001D099BE0E50>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001D0977DB1A0>
                   │    └ <Dispatcher '0x1d099d35f90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001D09A49D110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001D099BE0E50>
                 │    └ <function Dispatcher.feed_update at 0x000001D0977DB100>
                 └ <Dispatcher '0x1d099d35f90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D0977D9940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D099D00E10>
                     └ <Dispatcher '0x1d099d35f90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001D099E57790>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001D099E56D90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001D09A914400>
          │    │   │      │    └ TypeError("'price_per_request' is an invalid keyword argument for Offers")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001D09A4E5F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001D09A7E7C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001D09A3BFE10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001D09A75C5E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001D09A3CEF50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001D099CF6290>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012065, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001D09A4B44A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1d099d35f90'>>, Update(update_id=925012065, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000001D0977DA700>
                 └ <Dispatcher '0x1d099d35f90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001D09A75C2C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D0977D9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D099E839D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D0977DA7A0>
                 └ <Dispatcher '0x1d099d35f90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001D0977DA700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001D09A75C360>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D0977D9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D09A3CDA10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001D09A49E010>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001D09A75F740>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D0977DA7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001D0977DA700>
                     └ <Router '0x1d099e99790'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001D09A75F560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001D0977D9940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D099F1B050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001D0977DA7A0>
                 └ <Router '0x1d099e99790'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                     │        └ <function TelegramEventObserver.trigger at 0x000001D0977D9A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001D099F1B050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001D09A49DE90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                 └ functools.partial(<function context_saver_middleware at 0x000001D097BFF100>, <function CallableObject.call at 0x000001D09A75F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1d099d35f90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001893185794, type='channel', title='test 2032345023', username='sd234223', first_name=None,...
                   └ <function CallableObject.call at 0x000001D09A75F1A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000001D099F1CCC0>, ChatMemberUpdated(chat=Chat(id=-1001893185794, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 66, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(offer_data)
                        │    │          │         └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001893185794, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x000001D099C7C220>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001D09A7C0490>
                        └ <bot.db.Repo object at 0x000001D09A794390>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 13, in add_offer
    query = Offers(
            └ <class 'bot.db.models.models.Offers'>

  File "<string>", line 4, in __init__
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 564, in _initialize_instance
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001D09A4C2D40>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ TypeError("'price_per_request' is an invalid keyword argument for Offers")
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 562, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
    │       │              │            └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001893185794, 'channel...
    │       │              └ (<sqlalchemy.orm.state.InstanceState object at 0x000001D0977579B0>, <bot.db.models.models.Offers object at 0x000001D099E55D50>)
    │       └ <function _declarative_constructor at 0x000001D0999BEF20>
    └ <ClassManager of <class 'bot.db.models.models.Offers'> at 1d099bedb50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\decl_base.py", line 2139, in _declarative_constructor
    raise TypeError(

TypeError: 'price_per_request' is an invalid keyword argument for Offers
2024-03-01T13:52:01.964074+0200 INFO Bot stopped!
2024-03-01T13:52:05.371180+0200 INFO Bot started!
2024-03-01T13:52:09.243048+0200 INFO ::1 [01/Mar/2024:13:52:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:52:09.287296+0200 INFO Update id=925012066 is not handled. Duration 46 ms by bot id=5646878393
2024-03-01T13:52:09.292297+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TypeError("'offer_deadlin' is an invalid keyword argument for Offers")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000024DF9F1D050>
                   │    │          │                   │           └ {'update_id': 925012066, 'my_chat_member': {'chat': {'id': -1001989664341, 'title': 'test', 'username': 'dsadlkjaskd', 'type'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000024DF99545D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000024DF725F1A0>
                   │    └ <Dispatcher '0x24df98f0d50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000024DF9F1D050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000024DF99545D0>
                 │    └ <function Dispatcher.feed_update at 0x0000024DF725F100>
                 └ <Dispatcher '0x24df98f0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024DF725D940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024DF9E3B190>
                     └ <Dispatcher '0x24df98f0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000024DF98A2FD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000024DF9903910>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000024DF9777080>
          │    │   │      │    └ TypeError("'offer_deadlin' is an invalid keyword argument for Offers")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000024DF9F65E40>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000024DF9F41710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000024DF9E3BC10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000024DFA06FA60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000024DF9E4EC90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000024DF9935210>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012066, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000024DFA1DC680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x24df98f0d50'>>, Update(update_id=925012066, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x0000024DF725E700>
                 └ <Dispatcher '0x24df98f0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024DFA1DC540>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024DF725D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024DF9E39F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024DF725E7A0>
                 └ <Dispatcher '0x24df98f0d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x0000024DF725E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024DFA1DC5E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024DF725D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024DF9E4D750>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000024DF9F1DC50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000024DFA1DC040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024DF725E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x0000024DF725E700>
                     └ <Router '0x24df9972610'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024DFA1DC900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024DF725D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024DF999A950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024DF725E7A0>
                 └ <Router '0x24df9972610'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                     │        └ <function TelegramEventObserver.trigger at 0x0000024DF725DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024DF999A950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000024DF9F1DA90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                 └ functools.partial(<function context_saver_middleware at 0x0000024DF767F100>, <function CallableObject.call at 0x0000024DFA1DC...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x24df98f0d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001989664341, type='channel', title='test', username='dsadlkjaskd', first_name=None, last_na...
                   └ <function CallableObject.call at 0x0000024DFA1DC220>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x0000024DF999CCC0>, ChatMemberUpdated(chat=Chat(id=-1001989664341, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 66, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(offer_data)
                        │    │          │         └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001989664341, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x0000024DF96F00E0>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x0000024DF98A27D0>
                        └ <bot.db.Repo object at 0x0000024DF9EDA310>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 13, in add_offer
    query = Offers(
            └ <class 'bot.db.models.models.Offers'>

  File "<string>", line 4, in __init__
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 564, in _initialize_instance
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000024DF98A3080>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ TypeError("'offer_deadlin' is an invalid keyword argument for Offers")
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 562, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
    │       │              │            └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001989664341, 'channel...
    │       │              └ (<sqlalchemy.orm.state.InstanceState object at 0x0000024DF966EE10>, <bot.db.models.models.Offers object at 0x0000024DF9901850>)
    │       └ <function _declarative_constructor at 0x0000024DF943EF20>
    └ <ClassManager of <class 'bot.db.models.models.Offers'> at 24df966cf50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\decl_base.py", line 2139, in _declarative_constructor
    raise TypeError(

TypeError: 'offer_deadlin' is an invalid keyword argument for Offers
2024-03-01T13:52:16.919764+0200 INFO Bot stopped!
2024-03-01T13:52:20.432831+0200 INFO Bot started!
2024-03-01T13:52:37.861296+0200 INFO ::1 [01/Mar/2024:13:52:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:52:38.100855+0200 INFO Update id=925012067 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T13:52:38.899498+0200 INFO ::1 [01/Mar/2024:13:52:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:52:39.076931+0200 INFO Update id=925012068 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T13:52:42.678768+0200 INFO ::1 [01/Mar/2024:13:52:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:52:42.845591+0200 INFO Update id=925012069 is not handled. Duration 172 ms by bot id=5646878393
2024-03-01T13:52:42.864588+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=ProgrammingError('(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Контакты" зв\'язку "offers" не існує')>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 514, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                      │                └ <function AsyncAdapt_asyncpg_connection._prepare at 0x000001B904C4B7E0>
                                      └ <AdaptedConnection <asyncpg.connection.Connection object at 0x000001B9050C2110>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 765, in _prepare
    prepared_stmt = await self._connection.prepare(
                          │    └ <member '_connection' of 'AdaptedConnection' objects>
                          └ <AdaptedConnection <asyncpg.connection.Connection object at 0x000001B9050C2110>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
                 │    └ <function Connection._prepare at 0x000001B9050AB9C0>
                 └ <asyncpg.connection.Connection object at 0x000001B9050C2110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
                 │    └ <function Connection._get_statement at 0x000001B9050AB6A0>
                 └ <asyncpg.connection.Connection object at 0x000001B9050C2110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                      │    └ <member '_protocol' of 'Connection' objects>
                      └ <asyncpg.connection.Connection object at 0x000001B9050C2110>
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare

asyncpg.exceptions.UndefinedColumnError: стовпець "Контакты" зв'язку "offers" не існує


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001B904747880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001B904EEFED0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001960731769, 'Test #2', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
    │      │       └ 'INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала",...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001B904C4AB60>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001B9055BCEE0>
           └ <_AsyncIoGreenlet object at 0x000001B904E02E80 (otid=0x000001B90410F8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object Transaction.rollback at 0x000001B9059B98A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001B904C4A980>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ UndefinedColumnError('стовпець "Контакты" зв\'язку "offers" не існує')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ UndefinedColumnError('стовпець "Контакты" зв\'язку "offers" не існує')
          └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Контакты" зв\'язку "offers" не існує')

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: стовпець "Контакты" зв'язку "offers" не існує


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B904DC2D90>
                   │    │          │                   │           └ {'update_id': 925012069, 'my_chat_member': {'chat': {'id': -1001960731769, 'title': 'Test #2', 'username': 'test1231324124', ...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001B904EEF490>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001B9028AF1A0>
                   │    └ <Dispatcher '0x1b904f50d50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B904DC2D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001B904EEF490>
                 │    └ <function Dispatcher.feed_update at 0x000001B9028AF100>
                 └ <Dispatcher '0x1b904f50d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B9028AD940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B90548B390>
                     └ <Dispatcher '0x1b904f50d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001B904E020D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001B90548BB50>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001B905996140>
          │    │   │      │    └ ProgrammingError('(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class \'asyncpg.exceptions.UndefinedColumnError\...
          │    │   │      └ <class 'sqlalchemy.exc.ProgrammingError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001B9055B5D50>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001B90565E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001B904CB1A10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001B9055880E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B90549EDD0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B904E00690>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012069, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001B905830540>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1b904f50d50'>>, Update(update_id=925012069, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000001B9028AE700>
                 └ <Dispatcher '0x1b904f50d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B905831B20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B9028AD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B904E03210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B9028AE7A0>
                 └ <Dispatcher '0x1b904f50d50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001B9028AE700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B9058334C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B9028AD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B90549D890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001B90556E450>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001B9058304A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B9028AE7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001B9028AE700>
                     └ <Router '0x1b904eee9d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B905831300>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B9028AD940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B904FEAC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B9028AE7A0>
                 └ <Router '0x1b904eee9d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                     │        └ <function TelegramEventObserver.trigger at 0x000001B9028ADA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B904FEAC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001B90556E210>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                 └ functools.partial(<function context_saver_middleware at 0x000001B902CCF100>, <function CallableObject.call at 0x000001B905830...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1b904f50d50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001960731769, type='channel', title='Test #2', username='test1231324124', first_name=None, l...
                   └ <function CallableObject.call at 0x000001B9058300E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000001B904FECCC0>, ChatMemberUpdated(chat=Chat(id=-1001960731769, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 66, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(offer_data)
                        │    │          │         └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001960731769, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x000001B904D400E0>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001B90565FC90>
                        └ <bot.db.Repo object at 0x000001B90565C2D0>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 17, in add_offer
    await self.session.commit()
          │    │       └ <function AsyncSession.commit at 0x000001B904B2ECA0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001B904F20410>
          └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001B90565FC90>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
          │              │    │            └ <function Session.commit at 0x000001B904A5D440>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x000001B9054C1ED0>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001B904F20410>
          └ <function greenlet_spawn at 0x000001B904174040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 199, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001B904E02E80 (otid=0x000001B90410F8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1972, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000001B904A5C540>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B904D028A0>
  File "<string>", line 2, in commit
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B904D028A0>
                └ <function SessionTransaction.commit at 0x000001B904A5C360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1257, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000001B904A5C220>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B904D028A0>
  File "<string>", line 2, in _prepare_impl
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B904D028A0>
                └ <function SessionTransaction._prepare_impl at 0x000001B904A5C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1232, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000001B904A64360>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001B9054C1ED0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001B904D028A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4296, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001B904A64540>
    └ <sqlalchemy.orm.session.Session object at 0x000001B9054C1ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4431, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001B9059979C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ ProgrammingError('(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class \'asyncpg.exceptions.UndefinedColumnError\...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4392, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001B904A38EA0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001B904F22090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001B904F22090>
    │   └ <function SaveUpdateAll.execute at 0x000001B904A399E0>
    └ SaveUpdateAll(Mapper[Offers(offers)])
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001B904A06B60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persiste...
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\preloade...
    └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x000001B904A07B00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x000001B9046AFA60>
             └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001B905862290>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001B9046AFD80>
           └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001B9046AFF60>
          └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001B9046B4040>
           └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001B9046B42C0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Контакты" зв\'язку "offers" не існує')
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError'>, ProgrammingError('<class \'async...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ ProgrammingError('(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class \'asyncpg.exceptions.UndefinedColumnError\...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001B904747880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001B904EEFED0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B905524450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001960731769, 'Test #2', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
    │      │       └ 'INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала",...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001B904C4AB60>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001B9055BCEE0>
           └ <_AsyncIoGreenlet object at 0x000001B904E02E80 (otid=0x000001B90410F8D0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object Transaction.rollback at 0x000001B9059B98A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001B904C4A980>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ UndefinedColumnError('стовпець "Контакты" зв\'язку "offers" не існує')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001B9058C8DC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ UndefinedColumnError('стовпець "Контакты" зв\'язку "offers" не існує')
          └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Контакты" зв\'язку "offers" не існує')

sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: стовпець "Контакты" зв'язку "offers" не існує
[SQL: INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала", "Кастомна Тематика канала", "Сумма запроса", "Цена за запрос от админа канала", "Цена за запрос от админа бота", "Зарезервированная сумма", "Дедлайн оффера", "Правила трафика", "Комментарий", "Контакты", status) VALUES ($1::BIGINT, $2::VARCHAR, $3::trafficsource, $4::BIGINT, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR, $16::offerstatus) RETURNING offers.id]
[parameters: (387375605, 'Телеграм канал', 'TIK_TOK', -1001960731769, 'Test #2', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '23243', 'WAIT_FOR_PAYMENT')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-03-01T13:53:10.611823+0200 INFO Bot stopped!
2024-03-01T13:53:14.046371+0200 INFO Bot started!
2024-03-01T13:53:52.012028+0200 INFO ::1 [01/Mar/2024:13:53:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:53:52.324857+0200 INFO Update id=925012070 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T13:53:52.871129+0200 INFO ::1 [01/Mar/2024:13:53:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:53:53.091698+0200 INFO Update id=925012071 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T13:53:57.725491+0200 INFO ::1 [01/Mar/2024:13:53:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:53:57.867939+0200 INFO Update id=925012072 is not handled. Duration 141 ms by bot id=5646878393
2024-03-01T13:53:57.877938+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження\nDETAIL:  Помилковий рядок містить (1, 387375605, Телеграм канал, TIK_TOK, -1001812565202, Test #1, news, null, 3452, 52, null, 0, null, aboa, test, WAIT_FOR_PAYMENT, 23243).')>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001812565202, 'Test #1', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
    │    │             │             └ <function PreparedStatement.fetch at 0x000001816B999440>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001816C1B51C0>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001812565202, 'Test #1', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001816C1B51C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000001816C1B51C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x000001816B9BC5D0>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x000001816B9CD260>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.NotNullViolationError: null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, Телеграм канал, TIK_TOK, -1001812565202, Test #1, news, null, 3452, 52, null, 0, null, aboa, test, WAIT_FOR_PAYMENT, 23243).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001816B037880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001816B8409D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001812565202, 'Test #1', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
    │      │       └ 'INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала",...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001816B536B60>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001816BEACEE0>
           └ <_AsyncIoGreenlet object at 0x000001816B874740 (otid=0x000001816A9F7960) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object Transaction.rollback at 0x000001816C2A98A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001816B536980>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Дедлайн оффера" відношення "of...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, Телеграм канал, TIK_TOK, -1001812565202, Test #1, news, null, 3452, 52, null, 0, null, aboa, test, WAIT_FOR_PAYMENT, 23243).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001816BE5CD50>
                   │    │          │                   │           └ {'update_id': 925012072, 'my_chat_member': {'chat': {'id': -1001812565202, 'title': 'Test #1', 'type': 'channel'}, 'from': {'...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001816B6B7050>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001816919B1A0>
                   │    └ <Dispatcher '0x1816b59ded0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001816BE5CD50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001816B6B7050>
                 │    └ <function Dispatcher.feed_update at 0x000001816919B100>
                 └ <Dispatcher '0x1816b59ded0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018169199940>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001816BD7AE10>
                     └ <Dispatcher '0x1816b59ded0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001816BD7B310>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001816BD7B150>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001816C282400>
          │    │   │      │    └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>:...
          │    │   │      └ <class 'sqlalchemy.exc.IntegrityError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001816BEA5D50>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001816BE5D650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001816BD7B9D0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001816BE780E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001816BD8EA50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001816B85D450>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012072, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001816C120040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1816b59ded0'>>, Update(update_id=925012072, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │    │                           └ 'my_chat_member'
                 │    └ <function Router.propagate_event at 0x000001816919A700>
                 └ <Dispatcher '0x1816b59ded0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001816C120540>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018169199940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001816B877190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001816919A7A0>
                 └ <Dispatcher '0x1816b59ded0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001816919A700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001816C1234C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018169199940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001816BD8D5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 205, in process_my_chat_member
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001816BE5DC50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001816C1204A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001816919A7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │      │                           └ 'my_chat_member'
                     │      └ <function Router.propagate_event at 0x000001816919A700>
                     └ <Router '0x1816b8340d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001816C121300>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018169199940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001816B8E1650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001816919A7A0>
                 └ <Router '0x1816b8340d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                     │        └ <function TelegramEventObserver.trigger at 0x0000018169199A80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001816B8E1650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001816B6D7290>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                 └ functools.partial(<function context_saver_middleware at 0x00000181695BF100>, <function CallableObject.call at 0x000001816C121...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1816b59ded0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ ChatMemberUpdated(chat=Chat(id=-1001812565202, type='channel', title='Test #1', username=None, first_name=None, last_name=Non...
                   └ <function CallableObject.call at 0x000001816C121B20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function add_bot_handler at 0x000001816B8DCB80>, ChatMemberUpdated(chat=Chat(id=-1001812565202, type='chan...

  File "E:\PythonProjects\Arbitrix\bot\handlers\user_handlers.py", line 66, in add_bot_handler
    offer_model = await repo.offer_repo.add_offer(offer_data)
                        │    │          │         └ {'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': 'Tik-Tok', 'channel_id': -1001812565202, 'channel...
                        │    │          └ <function OfferRequestsRepo.add_offer at 0x000001816B6340E0>
                        │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001816BE5EFD0>
                        └ <bot.db.Repo object at 0x000001816BE5E6D0>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\offer_requests.py", line 17, in add_offer
    await self.session.commit()
          │    │       └ <function AsyncSession.commit at 0x000001816B41ECA0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001816BF4DF50>
          └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001816BE5EFD0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
          │              │    │            └ <function Session.commit at 0x000001816B34D440>
          │              │    └ <sqlalchemy.orm.session.Session object at 0x000001816BE5E390>
          │              └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001816BF4DF50>
          └ <function greenlet_spawn at 0x000001816AA64040>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 199, in greenlet_spawn
    result = context.switch(value)
             │       │      └ None
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000001816B874740 (otid=0x000001816A9F7960) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1972, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000001816B34C540>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001816C1B7980>
  File "<string>", line 2, in commit
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001816C1B7980>
                └ <function SessionTransaction.commit at 0x000001816B34C360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1257, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000001816B34C220>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001816C1B7980>
  File "<string>", line 2, in _prepare_impl
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001816C1B7980>
                └ <function SessionTransaction._prepare_impl at 0x000001816B34C180>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1232, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000001816B354360>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001816BE5E390>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001816C1B7980>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4296, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001816B354540>
    └ <sqlalchemy.orm.session.Session object at 0x000001816BE5E390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4431, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001816C282200>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>:...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4392, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001816B32CEA0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001816C0A0490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001816C0A0490>
    │   └ <function SaveUpdateAll.execute at 0x000001816B32D9E0>
    └ SaveUpdateAll(Mapper[Offers(offers)])
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001816B2F6B60>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persiste...
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\preloade...
    └ <module 'sqlalchemy.util' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x000001816B2F7B00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x000001816AF9FA60>
             └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001816B6F94D0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001816AF9FD80>
           └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001816AF9FF60>
          └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001816AFA4040>
           └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001816AFA42C0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Дедлайн оффера" відношення "of...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError'>, IntegrityError('<class \'asyncpg.e...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>:...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001816B037880>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000001816B8409D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001816B81A5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Телеграм канал', 'TIK_TOK', -1001812565202, 'Test #1', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '2...
    │      │       └ 'INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала",...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000001816B536B60>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000001816BEACEE0>
           └ <_AsyncIoGreenlet object at 0x000001816B874740 (otid=0x000001816A9F7960) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object Transaction.rollback at 0x000001816C2A98A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000001816B536980>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000001816C19B760>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "Дедлайн оффера" відношення "of...

sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "Дедлайн оффера" відношення "offers" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, Телеграм канал, TIK_TOK, -1001812565202, Test #1, news, null, 3452, 52, null, 0, null, aboa, test, WAIT_FOR_PAYMENT, 23243).
[SQL: INSERT INTO offers ("ID пользователя", "Источник трафика", "Тип трафика", "ID канала", "Название канала", "Тематика канала", "Кастомна Тематика канала", "Сумма запроса", "Цена за запрос от админа канала", "Цена за запрос от админа бота", "Зарезервированная сумма", "Дедлайн оффера", "Правила трафика", "Комментарий", contacts, status) VALUES ($1::BIGINT, $2::VARCHAR, $3::trafficsource, $4::BIGINT, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR, $16::offerstatus) RETURNING offers.id]
[parameters: (387375605, 'Телеграм канал', 'TIK_TOK', -1001812565202, 'Test #1', 'news', None, 3452, 52, None, 0, None, 'aboa', 'test', '23243', 'WAIT_FOR_PAYMENT')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-03-01T13:54:19.150863+0200 INFO Bot stopped!
2024-03-01T13:54:22.727953+0200 INFO Bot started!
2024-03-01T13:54:35.021041+0200 INFO ::1 [01/Mar/2024:13:54:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:54:35.421761+0200 INFO Update id=925012073 is handled. Duration 391 ms by bot id=5646878393
2024-03-01T13:54:35.824011+0200 INFO ::1 [01/Mar/2024:13:54:35 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:54:36.186808+0200 INFO Update id=925012074 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T13:54:40.035606+0200 INFO ::1 [01/Mar/2024:13:54:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:54:40.150780+0200 INFO Update id=925012075 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T13:54:45.483961+0200 INFO ::1 [01/Mar/2024:13:54:45 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:54:45.931166+0200 INFO Update id=925012076 is handled. Duration 452 ms by bot id=5646878393
2024-03-01T13:54:45.933167+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T13:54:45.940168+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('crypto_bot_client')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000224F1B4E700>
          │    └ <Dispatcher '0x224f41c2010'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000224F4C3E310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000224F1D462A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000224F1B4D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000224F408EFD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000224F42621D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000224F42082D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000224F4D04B00>
          │    │   │      │    └ KeyError('crypto_bot_client')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000224F4AD54E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000224F4065C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000224F3F51A10>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000224F1D46200>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000224F1B4E7A0>
                 └ <Dispatcher '0x224f41c2010'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000224F1B4DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000224F408EFD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000224F4192D50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000224F472B1D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000224F4ACF6A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x224f41c2010'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000224F1B4E700>
                 └ <Dispatcher '0x224f41c2010'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000224F4ACC7C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000224F1B4E7A0>
                 └ <Dispatcher '0x224f41c2010'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000224F1B4E700>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000224F4ACC5E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000224F1B4D940>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000224F473E1D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000224F480D510>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000224F4ACC2C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000224F1B4E7A0>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x00000224F1B4DA80>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000224F473E1D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000224F480D310>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x00000224F1F6F100>, <function CallableObject.call at 0x00000224F4828...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000224F42CF690>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x00000224F48280E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000224F1FCC040>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x00000224F1FB6C00>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 2, 'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x00000224F1FB6DE0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000224F1FB71A0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
                        │    └ <function ManagerImpl.dialog at 0x00000224F1FB6520>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x00000224F1FCDC60>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x00000224F1FCDA80>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000224F1FB8B80>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000224F4800110>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'offer_id': 2, 'payment_type': 'offer_purchase'}, 'middleware_data': {'bot': <aiogram.clie...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x00000224F4153E20>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000224F4800110>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 17, in get_price
    crypto_bot_client: AioCryptoPay = dialog_manager.middleware_data['crypto_bot_client']
                                      │              └ <property object at 0x00000224F1FB8B80>
                                      └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000224F41C1ED0>

KeyError: 'crypto_bot_client'
2024-03-01T13:55:24.001558+0200 INFO ::1 [01/Mar/2024:13:55:23 +0200] "GET /crypto_bot_webhook HTTP/1.1" 405 212 "-" "TelegramBot (like TwitterBot)"
2024-03-01T13:56:09.774833+0200 INFO Bot stopped!
2024-03-01T13:56:13.240399+0200 INFO Bot started!
2024-03-01T13:57:05.270497+0200 INFO ::1 [01/Mar/2024:13:57:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:57:05.649527+0200 INFO Update id=925012077 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T13:57:08.336284+0200 INFO ::1 [01/Mar/2024:13:57:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:57:08.701897+0200 INFO Update id=925012078 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T13:57:12.223197+0200 INFO ::1 [01/Mar/2024:13:57:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:57:12.455554+0200 INFO Update id=925012079 is handled. Duration 234 ms by bot id=5646878393
2024-03-01T13:57:12.465551+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T13:57:12.470551+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('price_per_request')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000252364BD1C0>
          │    └ <Dispatcher '0x2523a411410'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000002523ABB9D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002523AD15F80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000252364BC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002523A200190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002523A413CD0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002523A413910>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002523A8A1EC0>
          │    │   │      │    └ KeyError('price_per_request')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002523ABDC6D0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002523A846C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002523A41C090>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002523AB51800>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252364BD260>
                 └ <Dispatcher '0x2523a411410'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000252364BC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002523A200190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002523A41F250>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002523A201A10>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000002523A9DFEC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2523a411410'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000252364BD1C0>
                 └ <Dispatcher '0x2523a411410'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002523A9DFE20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252364BD260>
                 └ <Dispatcher '0x2523a411410'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000252364BD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002523A9DFD80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000252364BC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002523A41F550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002523A84B1D0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002523A9DFBA0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000252364BD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x00000252364BC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002523A41F550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002523A1C2A90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000025238079B20>, <function CallableObject.call at 0x000002523AB53...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002523A1CE810>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000002523AB53B00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000252380B2A20>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x00000252380B1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 3, 'payment_type': 'offer_purchase'}
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x00000252380B1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000252380B1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
                        │    └ <function ManagerImpl.dialog at 0x00000252380B0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x00000252380C4680>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x00000252380C44A0>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000252380ADD00>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025237E75C90>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000002523A839F50>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'offer_id': 3, 'payment_type': 'offer_purchase'}, 'middleware_data': {'bot': <aiogram.clie...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x000002523A29E840>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000002523A839F50>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 27, in get_price
    price = int(start_data['price_per_request']) * int(start_data['amount_requests'])
                │                                      └ {'offer_id': 3, 'payment_type': 'offer_purchase'}
                └ {'offer_id': 3, 'payment_type': 'offer_purchase'}

KeyError: 'price_per_request'
2024-03-01T13:58:02.600250+0200 INFO Bot stopped!
2024-03-01T13:58:06.082010+0200 INFO Bot started!
2024-03-01T13:58:07.488217+0200 INFO ::1 [01/Mar/2024:13:58:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:58:07.973128+0200 INFO Update id=925012080 is handled. Duration 483 ms by bot id=5646878393
2024-03-01T13:58:08.430687+0200 INFO ::1 [01/Mar/2024:13:58:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:58:08.707823+0200 INFO Update id=925012081 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T13:58:14.121011+0200 INFO ::1 [01/Mar/2024:13:58:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:58:14.284740+0200 INFO Update id=925012082 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T13:58:20.431878+0200 INFO ::1 [01/Mar/2024:13:58:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:58:20.639161+0200 INFO Update id=925012083 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T13:58:20.647749+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T13:58:20.653746+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('price_per_request')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000001720676D1C0>
          │    └ <Dispatcher '0x1720a6b1190'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000001720ACB1DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001720810CE00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001720676C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001720825DD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001720A54DB10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001720A6B3A10>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001720B0EFF80>
          │    │   │      │    └ KeyError('price_per_request')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001720ADF54E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001720B0ED550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001720A4886D0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001720810CD60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001720676D260>
                 └ <Dispatcher '0x1720a6b1190'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000001720676C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001720825DD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001720A6C2F90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001720A489A10>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000001720AB0C4A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1720a6b1190'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000001720676D1C0>
                 └ <Dispatcher '0x1720a6b1190'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001720ADF0360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001720676D260>
                 └ <Dispatcher '0x1720a6b1190'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000001720676D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001720ADF3E20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001720676C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001720A6C2E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001720AAEAD10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001720ADF3C40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001720676D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000001720676C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001720A6C2E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001720AAEAB90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000017208319B20>, <function CallableObject.call at 0x000001720AB0C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000001720A4479D0>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000001720AB0C0E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000017208352A20>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x0000017208351620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 4, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x0000017208351800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x0000017208351BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
                        │    └ <function ManagerImpl.dialog at 0x0000017208350F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x0000017208364680>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x00000172083644A0>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001720834DC60>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001720AAEB6D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001720AAD9A10>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'offer_id': 4, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Т...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x000001720A53E840>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001720AAD9A10>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 27, in get_price
    price = int(start_data['price_per_request']) * int(start_data['amount_requests'])
                │                                      └ {'offer_id': 4, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...
                └ {'offer_id': 4, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...

KeyError: 'price_per_request'
2024-03-01T13:58:36.969106+0200 INFO Bot stopped!
2024-03-01T13:58:40.407233+0200 INFO Bot started!
2024-03-01T13:58:59.550075+0200 INFO ::1 [01/Mar/2024:13:58:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:58:59.555778+0200 INFO Update id=925012084 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T13:59:02.444006+0200 INFO ::1 [01/Mar/2024:13:59:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:02.711603+0200 INFO Update id=925012085 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T13:59:03.271807+0200 INFO ::1 [01/Mar/2024:13:59:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:03.452733+0200 INFO Update id=925012086 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T13:59:06.001066+0200 INFO ::1 [01/Mar/2024:13:59:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:06.233549+0200 INFO Update id=925012087 is handled. Duration 219 ms by bot id=5646878393
2024-03-01T13:59:06.242568+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T13:59:06.247570+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=KeyError('amount_requests')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000002AD5F7C11C0>
          │    └ <Dispatcher '0x2ad63710b10'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000002AD634EA5D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002AD6116CE00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002AD5F7C0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002AD634E9BD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002AD63503010>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002AD63713490>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002AD63500FC0>
          │    │   │      │    └ KeyError('amount_requests')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002AD63E5C8B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002AD63B0EC50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002AD63713850>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002AD6116CD60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002AD5F7C1260>
                 └ <Dispatcher '0x2ad63710b10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000002AD5F7C0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002AD634E9BD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002AD63722A50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002AD63713AD0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x000002AD63E53C40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2ad63710b10'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000002AD5F7C11C0>
                 └ <Dispatcher '0x2ad63710b10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002AD63CDFD80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002AD5F7C1260>
                 └ <Dispatcher '0x2ad63710b10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000002AD5F7C11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002AD63CDFBA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002AD5F7C0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002AD63722950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002AD63B4EC50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002AD63CDFE20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002AD5F7C1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x000002AD5F7C0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002AD63722950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002AD63B4EA50>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x000002AD61379B20>, <function CallableObject.call at 0x000002AD63F2B...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002AD634CCD50>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x000002AD63F2B9C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x000002AD613B2A20>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x000002AD613B1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 5, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x000002AD613B1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000002AD613B1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
                        │    └ <function ManagerImpl.dialog at 0x000002AD613B0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x000002AD613C4680>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x000002AD613C44A0>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000002AD613ADCB0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002AD63B4FAD0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000002AD63B3D910>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'offer_id': 5, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Т...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x000002AD6359E8E0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000002AD63B3D910>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 27, in get_price
    price = int(start_data['first_price_per_request']) * int(start_data['amount_requests'])
                │                                            └ {'offer_id': 5, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...
                └ {'offer_id': 5, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...

KeyError: 'amount_requests'
2024-03-01T13:59:30.815487+0200 INFO Bot stopped!
2024-03-01T13:59:34.255212+0200 INFO Bot started!
2024-03-01T13:59:36.251495+0200 INFO ::1 [01/Mar/2024:13:59:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:36.406555+0200 INFO Update id=925012088 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T13:59:38.330448+0200 INFO ::1 [01/Mar/2024:13:59:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:38.484296+0200 INFO Update id=925012089 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T13:59:41.684285+0200 INFO ::1 [01/Mar/2024:13:59:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T13:59:41.873588+0200 INFO Update id=925012090 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T13:59:41.892894+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T13:59:41.903895+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=TypeError("Invalid variable type: value should be str, int or float, got {'user_id': 387375605} of type <class 'dict'>")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x0000024E8F4CD1C0>
          │    └ <Dispatcher '0x24e93410dd0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x0000024E93A23E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024E93B51620>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024E8F4CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024E931EABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000024E93413690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000024E93413310>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000024E93D0B800>
          │    │   │      │    └ TypeError("Invalid variable type: value should be str, int or float, got {'user_id': 387375605} of type <class 'dict'>")
          │    │   │      └ <class 'TypeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000024E93B545E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000024E9385A810>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000024E93413AD0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000024E93B516C0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024E8F4CD260>
                 └ <Dispatcher '0x24e93410dd0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x0000024E8F4CC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024E931EABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000024E93422F10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000024E93413C50>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000024E933E0040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x24e93410dd0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x0000024E8F4CD1C0>
                 └ <Dispatcher '0x24e93410dd0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000024E939DFF60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024E8F4CD260>
                 └ <Dispatcher '0x24e93410dd0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x0000024E8F4CD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000024E938684A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000024E8F4CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024E93423190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000024E9384B090>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000024E93B53D80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000024E8F4CD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x0000024E8F4CC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000024E93423190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000024E93315E90>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000024E91079B20>, <function CallableObject.call at 0x0000024E93B53...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000024E9309A710>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x0000024E93B53B00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000024E910B2A20>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x0000024E910B1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 6, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': ...
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x0000024E910B1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x0000024E910B1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
                        │    └ <function ManagerImpl.dialog at 0x0000024E910B0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x0000024E910C4680>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x0000024E910C44A0>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000024E910ADD00>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000024E931EBE10>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000024E93839E10>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'price': 179504}, 'start_data': {'offer_id': 6, 'payment_type': 'offer_purchase', 'user_id': 387375605, 'tar...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x0000024E9329E8E0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000024E93839E10>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 38, in get_price
    crypto_invoice = await create_invoice(crypto_bot_client, price, description_for_invoice, payload_data)
                           │              │                  │      │                        └ {'user_id': 387375605}
                           │              │                  │      └ 'Оплата за розміщення оффера на платформі'
                           │              │                  └ 179504
                           │              └ <aiocryptopay.api.AioCryptoPay object at 0x0000024E910E64D0>
                           └ <function create_invoice at 0x0000024E9329EAC0>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 10, in create_invoice
    invoice: Invoice = await client.create_invoice(
                             │      └ <function AioCryptoPay.create_invoice at 0x0000024E8C53EDE0>
                             └ <aiocryptopay.api.AioCryptoPay object at 0x0000024E910E64D0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 184, in create_invoice
    response = await self._make_request(
                     │    └ <function BaseClient._make_request at 0x0000024E8B82FC40>
                     └ <aiocryptopay.api.AioCryptoPay object at 0x0000024E910E64D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\base.py", line 46, in _make_request
    async with session.request(method, url, **kwargs) as response:
               │       │       │       │      └ {'params': {'asset': 'USDT', 'amount': 179504, 'description': 'Оплата за розміщення оффера на платформі', 'payload': {'user_i...
               │       │       │       └ 'https://testnet-pay.crypt.bot/api/createInvoice'
               │       │       └ <HTTPMethods.GET: 'GET'>
               │       └ <function ClientSession.request at 0x0000024E8B6A63E0>
               └ <aiohttp.client.ClientSession object at 0x0000024E93CAD550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\client.py", line 1194, in __aenter__
    self._resp = await self._coro
    │    │             │    └ <member '_coro' of '_BaseRequestContextManager' objects>
    │    │             └ <aiohttp.client._RequestContextManager object at 0x0000024E93B77880>
    │    └ <member '_resp' of '_BaseRequestContextManager' objects>
    └ <aiohttp.client._RequestContextManager object at 0x0000024E93B77880>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\client.py", line 545, in _request
    req = self._request_class(
          │    └ <class 'aiohttp.client_reqrep.ClientRequest'>
          └ <aiohttp.client.ClientSession object at 0x0000024E93CAD550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\client_reqrep.py", line 303, in __init__
    url2 = url.with_query(params)
           │   │          └ {'asset': 'USDT', 'amount': 179504, 'description': 'Оплата за розміщення оффера на платформі', 'payload': {'user_id': 3873756...
           │   └ <function URL.with_query at 0x0000024E8B2F7CE0>
           └ URL('https://testnet-pay.crypt.bot/api/createInvoice')
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\yarl\_url.py", line 1010, in with_query
    new_query = self._get_str_query(*args, **kwargs) or ""
                │    │               │       └ {}
                │    │               └ ({'asset': 'USDT', 'amount': 179504, 'description': 'Оплата за розміщення оффера на платформі', 'payload': {'user_id': 387375...
                │    └ <function URL._get_str_query at 0x0000024E8B2F7C40>
                └ URL('https://testnet-pay.crypt.bot/api/createInvoice')
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\yarl\_url.py", line 971, in _get_str_query
    query = "&".join(self._query_seq_pairs(quoter, query.items()))
                     │    │                │       │     └ <method 'items' of 'dict' objects>
                     │    │                │       └ {'asset': 'USDT', 'amount': 179504, 'description': 'Оплата за розміщення оффера на платформі', 'payload': {'user_id': 3873756...
                     │    │                └ <yarl._quoting_c._Quoter object at 0x0000024E8B2EF330>
                     │    └ <classmethod(<function URL._query_seq_pairs at 0x0000024E8B2F7B00>)>
                     └ URL('https://testnet-pay.crypt.bot/api/createInvoice')
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\yarl\_url.py", line 934, in _query_seq_pairs
    yield quoter(key) + "=" + quoter(cls._query_var(val))
          │      │            │      │   │          └ {'user_id': 387375605}
          │      │            │      │   └ <staticmethod(<function URL._query_var at 0x0000024E8B2F7BA0>)>
          │      │            │      └ <class 'yarl.URL'>
          │      │            └ <yarl._quoting_c._Quoter object at 0x0000024E8B2EF330>
          │      └ 'payload'
          └ <yarl._quoting_c._Quoter object at 0x0000024E8B2EF330>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\yarl\_url.py", line 949, in _query_var
    raise TypeError(

TypeError: Invalid variable type: value should be str, int or float, got {'user_id': 387375605} of type <class 'dict'>
2024-03-01T14:02:22.416979+0200 INFO Bot stopped!
2024-03-01T14:02:25.864779+0200 INFO Bot started!
2024-03-01T14:02:26.658965+0200 INFO ::1 [01/Mar/2024:14:02:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:02:26.898235+0200 INFO Update id=925012091 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T14:02:27.552526+0200 INFO ::1 [01/Mar/2024:14:02:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:02:27.963077+0200 INFO Update id=925012092 is handled. Duration 407 ms by bot id=5646878393
2024-03-01T14:02:31.274638+0200 INFO ::1 [01/Mar/2024:14:02:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:02:31.396547+0200 INFO Update id=925012093 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:02:37.945444+0200 INFO ::1 [01/Mar/2024:14:02:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:02:38.081322+0200 INFO Update id=925012094 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:02:42.411856+0200 INFO ::1 [01/Mar/2024:14:02:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:02:42.625408+0200 INFO Update id=925012095 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T14:03:32.074704+0200 INFO ::1 [01/Mar/2024:14:03:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:03:32.486016+0200 INFO Update id=925012096 is handled. Duration 422 ms by bot id=5646878393
2024-03-01T14:03:52.078635+0200 INFO Bot stopped!
2024-03-01T14:03:55.820803+0200 INFO Bot started!
2024-03-01T14:04:47.105541+0200 INFO ::1 [01/Mar/2024:14:04:47 +0200] "OPTIONS /payment-confirm HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T14:04:47.185427+0200 INFO ::1 [01/Mar/2024:14:04:47 +0200] "POST /payment-confirm HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T14:25:54.363622+0200 INFO ::1 [01/Mar/2024:14:25:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:25:54.652401+0200 INFO Update id=925012097 is handled. Duration 280 ms by bot id=5646878393
2024-03-01T14:25:56.285579+0200 INFO ::1 [01/Mar/2024:14:25:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:25:56.787070+0200 INFO Update id=925012098 is handled. Duration 500 ms by bot id=5646878393
2024-03-01T14:26:07.800419+0200 INFO ::1 [01/Mar/2024:14:26:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:26:08.089129+0200 INFO Update id=925012099 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T14:26:13.903095+0200 INFO ::1 [01/Mar/2024:14:26:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:26:14.462939+0200 INFO Update id=925012100 is handled. Duration 563 ms by bot id=5646878393
2024-03-01T14:26:17.825170+0200 INFO ::1 [01/Mar/2024:14:26:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:26:17.954868+0200 INFO Update id=925012101 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:26:20.807748+0200 INFO ::1 [01/Mar/2024:14:26:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:26:21.372616+0200 INFO Update id=925012102 is handled. Duration 563 ms by bot id=5646878393
2024-03-01T14:38:21.292914+0200 INFO ::1 [01/Mar/2024:14:38:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:21.632931+0200 INFO Update id=925012103 is handled. Duration 342 ms by bot id=5646878393
2024-03-01T14:38:23.883233+0200 INFO ::1 [01/Mar/2024:14:38:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:24.008913+0200 INFO Update id=925012104 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:38:25.300230+0200 INFO ::1 [01/Mar/2024:14:38:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:25.420253+0200 INFO Update id=925012105 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T14:38:26.863093+0200 INFO ::1 [01/Mar/2024:14:38:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:27.080530+0200 INFO Update id=925012106 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T14:38:28.373614+0200 INFO ::1 [01/Mar/2024:14:38:28 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:28.526240+0200 INFO Update id=925012107 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T14:38:29.718547+0200 INFO ::1 [01/Mar/2024:14:38:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:29.832731+0200 INFO Update id=925012108 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:38:30.398486+0200 INFO ::1 [01/Mar/2024:14:38:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:30.446860+0200 INFO Update id=925012109 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T14:38:30.461860+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-92' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012109, 'callback_query': {'id': '7898361887936235767', 'from': {'id': 6133947978, 'is_bot': False, 'first_n...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1982E80>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B16B6200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B18B1490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B16440E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012109, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B1931080>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012109, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B19FAA20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B19FBBA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B19F9DA0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B19FAD40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B19FB...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                   └ <function CallableObject.call at 0x00000188B19FB420>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='7898361887...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='7898361887936235767', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B00C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:38:30.840183+0200 INFO ::1 [01/Mar/2024:14:38:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:30.965973+0200 INFO Update id=925012110 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:38:33.055769+0200 INFO ::1 [01/Mar/2024:14:38:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:33.184360+0200 INFO Update id=925012111 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:38:34.196827+0200 INFO ::1 [01/Mar/2024:14:38:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:34.333991+0200 INFO Update id=925012112 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:38:34.784383+0200 INFO ::1 [01/Mar/2024:14:38:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:34.829299+0200 INFO Update id=925012113 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T14:38:34.831299+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-115' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012113, 'callback_query': {'id': '7898361887617162763', 'from': {'id': 6133947978, 'is_bot': False, 'first_n...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1BF8140>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B1BC8B80>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B1BF5C10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B19FADE0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012113, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B19FAFC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012113, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1933740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1933600>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB8D60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1930180>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B1BB8...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                   └ <function CallableObject.call at 0x00000188B1BB8B80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='7898361887...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='7898361887617162763', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1BF1210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:38:36.298175+0200 INFO ::1 [01/Mar/2024:14:38:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:36.607245+0200 INFO ::1 [01/Mar/2024:14:38:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:36.744629+0200 INFO Update id=925012114 is handled. Duration 438 ms by bot id=5646878393
2024-03-01T14:38:37.064351+0200 INFO Update id=925012115 is handled. Duration 452 ms by bot id=5646878393
2024-03-01T14:38:37.550157+0200 INFO ::1 [01/Mar/2024:14:38:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:37.872723+0200 INFO Update id=925012116 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T14:38:38.137387+0200 INFO ::1 [01/Mar/2024:14:38:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:38.408276+0200 INFO Update id=925012117 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T14:38:38.825041+0200 INFO ::1 [01/Mar/2024:14:38:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:39.095232+0200 INFO ::1 [01/Mar/2024:14:38:39 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:39.178391+0200 INFO Update id=925012118 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T14:38:39.234016+0200 INFO Update id=925012119 is not handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:38:39.237012+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-149' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012119, 'callback_query': {'id': '7898361890239302192', 'from': {'id': 6133947978, 'is_bot': False, 'first_n...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1C1F2C0>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B11CB970>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B1B02FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B19FAC00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012119, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B19F9EE0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012119, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBA5C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBA700>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBA8E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBA840>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B1BBA...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                   └ <function CallableObject.call at 0x00000188B1BBAA20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='7898361890...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='7898361890239302192', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1B01FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:38:39.890969+0200 INFO ::1 [01/Mar/2024:14:38:39 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:40.140201+0200 INFO Update id=925012120 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:38:40.581636+0200 INFO ::1 [01/Mar/2024:14:38:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:40.883205+0200 INFO Update id=925012121 is handled. Duration 295 ms by bot id=5646878393
2024-03-01T14:38:43.369440+0200 INFO ::1 [01/Mar/2024:14:38:43 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:43.631424+0200 INFO Update id=925012122 is handled. Duration 264 ms by bot id=5646878393
2024-03-01T14:38:44.576793+0200 INFO ::1 [01/Mar/2024:14:38:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:44.798537+0200 INFO Update id=925012123 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T14:38:46.095198+0200 INFO ::1 [01/Mar/2024:14:38:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:46.406593+0200 INFO Update id=925012124 is handled. Duration 296 ms by bot id=5646878393
2024-03-01T14:38:48.259986+0200 INFO ::1 [01/Mar/2024:14:38:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:48.524974+0200 INFO Update id=925012125 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:38:49.092826+0200 INFO ::1 [01/Mar/2024:14:38:49 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:49.150156+0200 INFO Update id=925012126 is not handled. Duration 61 ms by bot id=5646878393
2024-03-01T14:38:49.152159+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-192' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012126, 'callback_query': {'id': '1663765556554343115', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1BE3840>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B11CB970>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B1C03E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B19F8B80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012126, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B17BFCE0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012126, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBAD40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBB240>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB9440>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B11C0040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B1BB9...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000188B1BB9620>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='1663765556...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='1663765556554343115', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C4BBD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:38:51.375005+0200 INFO ::1 [01/Mar/2024:14:38:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:51.894806+0200 INFO Update id=925012127 is handled. Duration 530 ms by bot id=5646878393
2024-03-01T14:38:52.479683+0200 INFO ::1 [01/Mar/2024:14:38:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:38:52.527787+0200 INFO Update id=925012128 is not handled. Duration 46 ms by bot id=5646878393
2024-03-01T14:38:52.530788+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-203' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012128, 'callback_query': {'id': '7898361889229561720', 'from': {'id': 6133947978, 'is_bot': False, 'first_n...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1C65C00>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B16B6C50>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B1C65010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B19F94E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012128, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B1931080>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012128, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBBB00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB98A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB8CC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B19F9EE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B1BBB...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                   └ <function CallableObject.call at 0x00000188B1BBBA60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='7898361889...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='7898361889229561720', from_user=User(id=6133947978, is_bot=False, first_name='Easy Life Manager', last_name...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1AEE6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         │    └ NewMessage(chat=Chat(id=6133947978, type='private', title=None, username='EasyLife_Manager', first_name='Easy Life Manager', ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=6133947978, message_id=62624, inline_message_id=None, parse_mode=<Default('parse_mode')>, en...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:39:02.878573+0200 INFO ::1 [01/Mar/2024:14:39:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:03.000436+0200 INFO Update id=925012129 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T14:39:04.563625+0200 INFO ::1 [01/Mar/2024:14:39:04 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:04.730923+0200 INFO Update id=925012130 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T14:39:07.383797+0200 INFO ::1 [01/Mar/2024:14:39:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:07.484678+0200 INFO ::1 [01/Mar/2024:14:39:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:07.634991+0200 INFO Update id=925012131 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:39:07.745468+0200 INFO Update id=925012132 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:39:08.573268+0200 INFO ::1 [01/Mar/2024:14:39:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:08.813247+0200 INFO Update id=925012133 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T14:39:11.814781+0200 INFO ::1 [01/Mar/2024:14:39:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:11.967487+0200 INFO Update id=925012134 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:39:13.068102+0200 INFO ::1 [01/Mar/2024:14:39:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:13.219281+0200 INFO Update id=925012135 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:39:13.680516+0200 INFO ::1 [01/Mar/2024:14:39:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:13.895369+0200 INFO Update id=925012136 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T14:39:18.816476+0200 INFO ::1 [01/Mar/2024:14:39:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:20.201740+0200 INFO Update id=925012137 is handled. Duration 1375 ms by bot id=5646878393
2024-03-01T14:39:26.466699+0200 INFO ::1 [01/Mar/2024:14:39:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:26.608118+0200 INFO Update id=925012138 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T14:39:27.199560+0200 INFO ::1 [01/Mar/2024:14:39:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:27.255672+0200 INFO Update id=925012139 is not handled. Duration 61 ms by bot id=5646878393
2024-03-01T14:39:27.257668+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-269' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
                   │    │          │                   │           └ {'update_id': 925012139, 'callback_query': {'id': '1663765558217218937', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000188AD29DC60>
                   │    └ <Dispatcher '0x188b11f19d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000188B162ABD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function Dispatcher.feed_update at 0x00000188AD29DBC0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F3C10>
                     └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000188B0F9E2D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000188B11F3FD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000188B1C9B100>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000188B16B6020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000188B1BF3410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000188B0FCAD90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000188B19F94E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB7D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012139, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000188B19FB6A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x188b11f19d0'>>, Update(update_id=925012139, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000188AD29D1C0>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB8B80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F21D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dispatcher '0x188b11f19d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BB9580>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B11F96D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000188B162BA50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBBEC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000188AD29D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188B1BBA7A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000188AD29C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000188AD29D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000188AD29C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188B120D190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000188B11FB810>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000188B11F8850>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188B162B7D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000188AEE59B20>, <function CallableObject.call at 0x00000188B1BBA...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x188b11f19d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000188B1BBAD40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='1663765558...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x00000188AEEA45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x00000188AEC918A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B1207E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x00000188AEE18A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x00000188B0F9D210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x00000188AEC918A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x00000188AEC92020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        │             └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x00000188AEC739C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x00000188B12078D0>
          │    │        └ CallbackQuery(id='1663765558217218937', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_start_select_offer at 0x00000188B0F8FF60>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x00000188B1080810>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x00000188AEE91620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x00000188AEE91800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x00000188AEE91BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000188B1C73E10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
          │    └ <function MessageManager.edit_message_safe at 0x00000188AEE93380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_message at 0x00000188AEE93420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <function MessageManager.edit_text at 0x00000188AEE93560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x00000188B162B710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x00000188AD510360>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
                 └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x00000188B0FF4210>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x00000188A8A604A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x00000188A6AB36A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x00000188B11CC650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=387375605, message_id=62626, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T14:39:27.939597+0200 INFO ::1 [01/Mar/2024:14:39:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:39:28.074286+0200 INFO Update id=925012140 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:41:18.510751+0200 INFO ::1 [01/Mar/2024:14:41:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:18.780023+0200 INFO Update id=925012141 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:41:19.720147+0200 INFO ::1 [01/Mar/2024:14:41:19 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:19.977124+0200 INFO Update id=925012142 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:41:21.170210+0200 INFO ::1 [01/Mar/2024:14:41:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:21.597171+0200 INFO Update id=925012143 is handled. Duration 437 ms by bot id=5646878393
2024-03-01T14:41:23.327269+0200 INFO ::1 [01/Mar/2024:14:41:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:23.670443+0200 INFO Update id=925012144 is handled. Duration 343 ms by bot id=5646878393
2024-03-01T14:41:24.269851+0200 INFO ::1 [01/Mar/2024:14:41:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:24.535964+0200 INFO Update id=925012145 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:41:25.440046+0200 INFO ::1 [01/Mar/2024:14:41:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:25.575372+0200 INFO Update id=925012146 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:41:37.425473+0200 INFO ::1 [01/Mar/2024:14:41:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:37.578388+0200 INFO Update id=925012147 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:41:38.069948+0200 INFO ::1 [01/Mar/2024:14:41:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:38.225466+0200 INFO Update id=925012148 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T14:41:39.641478+0200 INFO ::1 [01/Mar/2024:14:41:39 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:39.832700+0200 INFO Update id=925012149 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T14:41:46.498521+0200 INFO ::1 [01/Mar/2024:14:41:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:46.639543+0200 INFO Update id=925012150 is handled. Duration 139 ms by bot id=5646878393
2024-03-01T14:41:47.728577+0200 INFO ::1 [01/Mar/2024:14:41:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:47.853578+0200 INFO Update id=925012151 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:41:50.924511+0200 INFO ::1 [01/Mar/2024:14:41:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:51.175639+0200 INFO Update id=925012152 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:41:52.597348+0200 INFO ::1 [01/Mar/2024:14:41:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:52.731651+0200 INFO Update id=925012153 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:41:54.678846+0200 INFO ::1 [01/Mar/2024:14:41:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:54.871964+0200 INFO Update id=925012154 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T14:41:55.963486+0200 INFO ::1 [01/Mar/2024:14:41:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:41:56.291704+0200 INFO Update id=925012155 is handled. Duration 327 ms by bot id=5646878393
2024-03-01T14:42:12.850486+0200 INFO ::1 [01/Mar/2024:14:42:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:13.117760+0200 INFO Update id=925012156 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:42:15.025041+0200 INFO ::1 [01/Mar/2024:14:42:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:15.158431+0200 INFO Update id=925012157 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:42:15.643695+0200 INFO ::1 [01/Mar/2024:14:42:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:15.766757+0200 INFO Update id=925012158 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:42:16.440668+0200 INFO ::1 [01/Mar/2024:14:42:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:16.585652+0200 INFO Update id=925012159 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T14:42:17.023294+0200 INFO ::1 [01/Mar/2024:14:42:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:17.148725+0200 INFO Update id=925012160 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:42:18.107658+0200 INFO ::1 [01/Mar/2024:14:42:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:18.359510+0200 INFO Update id=925012161 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:42:18.860362+0200 INFO ::1 [01/Mar/2024:14:42:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:18.988584+0200 INFO Update id=925012162 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:42:19.381399+0200 INFO ::1 [01/Mar/2024:14:42:19 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:19.534043+0200 INFO Update id=925012163 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T14:42:20.016408+0200 INFO ::1 [01/Mar/2024:14:42:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:20.223701+0200 INFO Update id=925012164 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T14:42:20.381882+0200 INFO ::1 [01/Mar/2024:14:42:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:42:20.712740+0200 INFO Update id=925012165 is handled. Duration 329 ms by bot id=5646878393
2024-03-01T14:53:30.814526+0200 INFO ::1 [01/Mar/2024:14:53:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:53:31.152332+0200 INFO Update id=925012166 is handled. Duration 327 ms by bot id=5646878393
2024-03-01T14:53:31.757491+0200 INFO ::1 [01/Mar/2024:14:53:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:53:31.941200+0200 INFO Update id=925012167 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T14:53:33.277322+0200 INFO ::1 [01/Mar/2024:14:53:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:53:33.447918+0200 INFO Update id=925012168 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T14:53:34.108480+0200 INFO ::1 [01/Mar/2024:14:53:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:53:34.355752+0200 INFO Update id=925012169 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T14:54:03.282269+0200 INFO ::1 [01/Mar/2024:14:54:03 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T14:54:03.422055+0200 INFO ::1 [01/Mar/2024:14:54:03 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T14:54:08.470537+0200 INFO ::1 [01/Mar/2024:14:54:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:54:08.743801+0200 INFO Update id=925012170 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T14:54:14.087417+0200 INFO ::1 [01/Mar/2024:14:54:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:54:14.218621+0200 INFO Update id=925012171 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T14:54:44.821237+0200 INFO Bot stopped!
2024-03-01T14:58:27.747799+0200 INFO Bot started!
2024-03-01T14:58:38.654594+0200 INFO ::1 [01/Mar/2024:14:58:38 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T14:58:38.932162+0200 INFO Update id=925012172 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T14:58:46.289705+0200 INFO ::1 [01/Mar/2024:14:58:46 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:09:55.368574+0200 INFO Bot stopped!
2024-03-01T15:09:58.737158+0200 INFO Bot started!
2024-03-01T15:10:16.987878+0200 INFO ::1 [01/Mar/2024:15:10:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:17.556510+0200 INFO Update id=925012173 is handled. Duration 561 ms by bot id=5646878393
2024-03-01T15:10:18.378553+0200 INFO ::1 [01/Mar/2024:15:10:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:18.783992+0200 INFO Update id=925012174 is handled. Duration 407 ms by bot id=5646878393
2024-03-01T15:10:22.439317+0200 INFO ::1 [01/Mar/2024:15:10:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:22.677042+0200 INFO Update id=925012175 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:10:22.685641+0200 ERROR Payment type is empty user-id:387375605
2024-03-01T15:10:22.686636+0200 ERROR Cannot get window data for state <State 'TopUpOperations:select_pament_method'>
2024-03-01T15:10:22.705640+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=ValueError('Payment type is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x0000019AB3AE11C0>
          │    └ <Dispatcher '0x19ab7a31590'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x0000019AB83B3410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000019AB548CE00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000019AB3AE0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019AB7808CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000019AB780BB90>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000019AB7A33B10>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000019AB7A78780>
          │    │   │      │    └ ValueError('Payment type is empty')
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000019AB82797B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000019AB7A78090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000019AB7A402D0>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000019AB548CD60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000019AB3AE1260>
                 └ <Dispatcher '0x19ab7a31590'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x0000019AB3AE0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019AB7808CD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000019AB7A434D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000019AB7A40450>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000019AB7E74400>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x19ab7a31590'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │    │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x0000019AB3AE11C0>
                 └ <Dispatcher '0x19ab7a31590'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000019AB7A053A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000019AB3AE1260>
                 └ <Dispatcher '0x19ab7a31590'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │      │                           │                  └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x0000019AB3AE11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │        │                     │               └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000019AB8170180>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000019AB3AE0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019AB7A43490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000019AB7E73A50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000019AB8172840>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000019AB3AE1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                     │        │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                     │        └ <function TelegramEventObserver.trigger at 0x0000019AB3AE0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019AB7A43490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │             └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000019AB7E73850>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                 │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                 └ functools.partial(<function context_saver_middleware at 0x0000019AB5699B20>, <function CallableObject.call at 0x0000019AB83E4...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x0000019AB77ECE10>, 'event_from_user': User(id=387375605, is_bot=False, first_name...
                   │       └ DialogStartEvent(from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, username='s0larm0v3', lan...
                   └ <function CallableObject.call at 0x0000019AB83E4360>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000019AB56D2A20>, DialogStartEvent(from_user=User(id=387375605, is_bot=False,...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 20, in handle_update
    await dialog_manager.start(
          │              └ <function ManagerImpl.start at 0x0000019AB56D1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'offer_id': 9, 'payment_for': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Телеграм канал', 'traffic_source': '...
          │    │             └ <State 'TopUpOperations:select_pament_method'>
          │    └ <function ManagerImpl._start_normal at 0x0000019AB56D1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x0000019AB56D1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
                        │    └ <function ManagerImpl.dialog at 0x0000019AB56D0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
                        │      │      └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                        │      └ <function Window.render at 0x0000019AB56E4680>
                        └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
                         │    │         └ <Dialog(<StatesGroup 'TopUpOperations'>)>
                         │    └ <function Window.load_data at 0x0000019AB56E44A0>
                         └ <Window(<State 'TopUpOperations:select_pament_method'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000019AB56CDD00>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000019AB8341FD0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000019AB7E624D0>
    │    │            └ <Window(<State 'TopUpOperations:select_pament_method'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'offer_id': 9, 'payment_for': 'offer_purchase', 'user_id': 387375605, 'target_source': 'Те...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_price at 0x0000019AB78BEAC0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000019AB7E624D0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\purchase_menu\getters.py", line 25, in get_price
    raise ValueError('Payment type is empty')

ValueError: Payment type is empty
2024-03-01T15:10:42.220477+0200 INFO Bot stopped!
2024-03-01T15:10:45.666031+0200 INFO Bot started!
2024-03-01T15:10:53.061765+0200 INFO ::1 [01/Mar/2024:15:10:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:53.226398+0200 INFO Update id=925012176 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T15:10:53.853467+0200 INFO ::1 [01/Mar/2024:15:10:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:54.036268+0200 INFO Update id=925012177 is handled. Duration 187 ms by bot id=5646878393
2024-03-01T15:10:56.597657+0200 INFO ::1 [01/Mar/2024:15:10:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:10:56.824388+0200 INFO Update id=925012178 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T15:11:05.276156+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BB9D3B5080>
    │       └ <function run at 0x000001BB94D1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BB9D372140>
           │      └ <function Runner.run at 0x000001BB94DAC900>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BB94DAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BB94E7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BB94DAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BB94CEDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DD8A7D0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001BB9DD8A7D0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001BB9DD8A7D0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DD8A7D0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1bb9d513610>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001BB9D3B4D60>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['Api']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33599, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:11:04.009Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001BB9D943110>
           └ <function check_signature at 0x000001BB9D38EAC0>

KeyError: 'Api'
2024-03-01T15:11:05.397886+0200 INFO ::1 [01/Mar/2024:15:11:05 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:11:08.282908+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BB9D3B5080>
    │       └ <function run at 0x000001BB94D1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BB9D372140>
           │      └ <function Runner.run at 0x000001BB94DAC900>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BB94DAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BB94E7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BB94DAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BB94CEDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67970>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67970>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67970>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67970>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1bb9d513610>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001BB9D3B4D60>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['Api']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33600, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:11:07.006Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001BB9D943110>
           └ <function check_signature at 0x000001BB9D38EAC0>

KeyError: 'Api'
2024-03-01T15:11:08.286422+0200 INFO ::1 [01/Mar/2024:15:11:08 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:11:13.270176+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BB9D3B5080>
    │       └ <function run at 0x000001BB94D1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BB9D372140>
           │      └ <function Runner.run at 0x000001BB94DAC900>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BB94DAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BB94E7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BB94DAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BB94CEDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC675B0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC675B0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC675B0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC675B0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1bb9d513610>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001BB9D3B4D60>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['Api']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33601, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:11:12.006Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001BB9D943110>
           └ <function check_signature at 0x000001BB9D38EAC0>

KeyError: 'Api'
2024-03-01T15:11:13.275175+0200 INFO ::1 [01/Mar/2024:15:11:13 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:11:22.305379+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BB9D3B5080>
    │       └ <function run at 0x000001BB94D1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BB9D372140>
           │      └ <function Runner.run at 0x000001BB94DAC900>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BB94DAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BB94E7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BB94DAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BB94CEDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC64940>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC64940>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC64940>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC64940>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1bb9d513610>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001BB9D3B4D60>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['Api']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33602, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:11:21.006Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001BB9D943110>
           └ <function check_signature at 0x000001BB9D38EAC0>

KeyError: 'Api'
2024-03-01T15:11:22.311292+0200 INFO ::1 [01/Mar/2024:15:11:22 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:11:39.266668+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001BB9D3B5080>
    │       └ <function run at 0x000001BB94D1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001BB9D372140>
           │      └ <function Runner.run at 0x000001BB94DAC900>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BB94DAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BB9CBE6350>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001BB94E7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BB94DAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BB94CEDA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67280>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67280>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67280>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001BB9DC67280>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1bb9d513610>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001BB9D3B4D60>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['Api']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33603, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:11:38.005Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001BB9D943110>
           └ <function check_signature at 0x000001BB9D38EAC0>

KeyError: 'Api'
2024-03-01T15:11:39.272842+0200 INFO ::1 [01/Mar/2024:15:11:39 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:11:43.705648+0200 INFO Bot stopped!
2024-03-01T15:11:47.511040+0200 INFO Bot started!
2024-03-01T15:11:50.704098+0200 INFO ::1 [01/Mar/2024:15:11:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:11:51.127399+0200 INFO Update id=925012179 is handled. Duration 420 ms by bot id=5646878393
2024-03-01T15:11:52.863395+0200 INFO ::1 [01/Mar/2024:15:11:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:11:53.134488+0200 INFO Update id=925012180 is handled. Duration 264 ms by bot id=5646878393
2024-03-01T15:11:53.736055+0200 INFO ::1 [01/Mar/2024:15:11:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:11:54.269193+0200 INFO Update id=925012181 is handled. Duration 530 ms by bot id=5646878393
2024-03-01T15:11:57.334349+0200 INFO ::1 [01/Mar/2024:15:11:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:11:57.568112+0200 INFO Update id=925012182 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:12:03.267473+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001A8117011C0>
    │       └ <function run at 0x000001A80905C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001A8116C2240>
           │      └ <function Runner.run at 0x000001A8090EC900>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001A8090EA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001A8091CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001A8090EC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001A80902DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001A8120DE350>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001A8120DE350>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001A8120DE350>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001A8120DE350>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1a8114daad0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001A811700E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['crypto-pay-api-signature    ']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33605, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:02.008Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001A8114EC6D0>
           └ <function check_signature at 0x000001A8116DEAC0>

KeyError: 'crypto-pay-api-signature    '
2024-03-01T15:12:03.276442+0200 INFO ::1 [01/Mar/2024:15:12:03 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:12:06.277940+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001A8117011C0>
    │       └ <function run at 0x000001A80905C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001A8116C2240>
           │      └ <function Runner.run at 0x000001A8090EC900>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001A8090EA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001A8091CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001A8090EC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001A80902DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001A811FBBA30>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001A811FBBA30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001A811FBBA30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001A811FBBA30>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1a8114daad0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001A811700E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['crypto-pay-api-signature    ']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33606, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:05.010Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001A8114EC6D0>
           └ <function check_signature at 0x000001A8116DEAC0>

KeyError: 'crypto-pay-api-signature    '
2024-03-01T15:12:06.285912+0200 INFO ::1 [01/Mar/2024:15:12:06 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:12:11.340749+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001A8117011C0>
    │       └ <function run at 0x000001A80905C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001A8116C2240>
           │      └ <function Runner.run at 0x000001A8090EC900>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001A8090EA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001A8091CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001A8090EC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001A80902DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001A811FBA7D0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001A811FBA7D0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001A811FBA7D0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001A811FBA7D0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1a8114daad0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001A811700E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['crypto-pay-api-signature    ']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33607, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:10.011Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001A8114EC6D0>
           └ <function check_signature at 0x000001A8116DEAC0>

KeyError: 'crypto-pay-api-signature    '
2024-03-01T15:12:11.345113+0200 INFO ::1 [01/Mar/2024:15:12:11 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:12:12.281530+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001A8117011C0>
    │       └ <function run at 0x000001A80905C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001A8116C2240>
           │      └ <function Runner.run at 0x000001A8090EC900>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001A8090EA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001A81162B810>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001A8091CA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001A8090EC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001A80902DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001A812117040>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001A812117040>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001A812117040>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001A812117040>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1a8114daad0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001A811700E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not check_signature(crypto_bot_client, data, header['crypto-pay-api-signature    ']):
           │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
           │               │                  └ {'update_id': 33604, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:11.007Z', 'payload': {'invoice_id': 164...
           │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001A8114EC6D0>
           └ <function check_signature at 0x000001A8116DEAC0>

KeyError: 'crypto-pay-api-signature    '
2024-03-01T15:12:12.286045+0200 INFO ::1 [01/Mar/2024:15:12:12 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:12:13.709683+0200 INFO Bot stopped!
2024-03-01T15:12:17.041840+0200 INFO Bot started!
2024-03-01T15:12:20.353599+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000016F5F4F51C0>
    │       └ <function run at 0x0000016F56E7C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000016F5F4AE240>
           │      └ <function Runner.run at 0x0000016F56F0C900>
           └ <asyncio.runners.Runner object at 0x0000016F5D1EE850>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000016F56F0A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000016F5D1EE850>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000016F56FDA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000016F56F0C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000016F56E4DA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x16f5f430490>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x0000016F5F4F4E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 76, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, data['name'], int(data['lastDigits']),
          │    │            │                 │        │                 └ {'update_id': 33608, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:19.006Z', 'payload': {'invoice_id': 164...
          │    │            │                 │        └ {'update_id': 33608, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:12:19.006Z', 'payload': {'invoice_id': 164...
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x0000016F5F343560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000016F5FB9CBD0>
          └ <bot.db.Repo object at 0x0000016F5FBA8C50>

KeyError: 'name'
2024-03-01T15:12:20.362040+0200 INFO ::1 [01/Mar/2024:15:12:20 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:12:27.532073+0200 INFO Bot stopped!
2024-03-01T15:14:19.204155+0200 INFO Bot started!
2024-03-01T15:14:22.788502+0200 INFO ::1 [01/Mar/2024:15:14:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:14:23.026904+0200 INFO Update id=925012183 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:14:23.944195+0200 INFO ::1 [01/Mar/2024:15:14:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:14:24.081348+0200 INFO Update id=925012184 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:14:24.760270+0200 INFO ::1 [01/Mar/2024:15:14:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:14:24.923574+0200 INFO Update id=925012185 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T15:14:34.081436+0200 INFO ::1 [01/Mar/2024:15:14:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:14:34.311024+0200 INFO Update id=925012186 is handled. Duration 217 ms by bot id=5646878393
2024-03-01T15:14:41.306624+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000027BC37A11C0>
    │       └ <function run at 0x0000027BBB0FC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000027BC375E240>
           │      └ <function Runner.run at 0x0000027BBB18C900>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027BBB18A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000027BBB26A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027BBB18C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027BBB0CDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x27bc3918e10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x0000027BC37A0E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 78, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, amount=228, payment_type=PaymentMethods.CRYPTOPAY)
          │    │            │                 │                                 │              └ <PaymentMethods.CRYPTOPAY: 'cryptopay'>
          │    │            │                 │                                 └ <enum 'PaymentMethods'>
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x0000027BC35F3560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC4214290>
          └ <bot.db.Repo object at 0x0000027BC3F09AD0>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 45, in add_topup_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC421E490>
          │    │       └ <function AsyncSession.execute at 0x0000027BC33FC4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000027BC3D3C2D0>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC4214290>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x0000027BC2A6AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 186, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': None, 'execution_options': immutabledict({'prebuffer_rows': True}), 'bind_arguments': None}
             │       │       └ (<sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC421E490>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000027BC421F840 (otid=0x0000027BC2997DE0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000027BC331C2C0>
           └ <sqlalchemy.orm.session.Session object at 0x0000027BC3D3C550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x0000027BC32EFD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x0000027BC2F52520>
             └ <sqlalchemy.engine.base.Connection object at 0x0000027BC3E39D10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000027BC2F52840>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027BC3E39D10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1622, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x0000027BC2D4C680>
                                                └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 714, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x0000027BC2D3F6A0>
                   └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 314, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': None, 'column_keys': [], 'for_executemany': False, 'schema_translate_map': None, 'linting': 3}
           │       │                  │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
           │       │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
           │       └ <class 'sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg'>
           └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1424, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
    │        │        │     └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
    │        │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E39E50>
    │        └ <function Compiled.__init__ at 0x0000027BC2ED1800>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 865, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E39E50>
    │    │        │    └ <function Compiled.process at 0x0000027BC2ED1BC0>
    │    │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E39E50>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E39E50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 910, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E39E50>
           │   └ <function Annotated._compiler_dispatch at 0x0000027BC2C7BBA0>
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC4216DD0>
           └ <bound method SQLCompiler.visit_insert of <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC3E3...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5696, in visit_insert
    crud_params_struct = crud._get_crud_params(
                         │    └ <function _get_crud_params at 0x0000027BC2C78E00>
                         └ <module 'sqlalchemy.sql.crud' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\crud.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 335, in _get_crud_params
    raise exc.CompileError(
          │   └ <class 'sqlalchemy.exc.CompileError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.CompileError: Unconsumed column names: payment_type
2024-03-01T15:14:41.318523+0200 INFO ::1 [01/Mar/2024:15:14:41 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:14:44.266376+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000027BC37A11C0>
    │       └ <function run at 0x0000027BBB0FC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000027BC375E240>
           │      └ <function Runner.run at 0x0000027BBB18C900>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027BBB18A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000027BBB26A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027BBB18C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027BBB0CDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x27bc3918e10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x0000027BC37A0E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 78, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, amount=228, payment_type=PaymentMethods.CRYPTOPAY)
          │    │            │                 │                                 │              └ <PaymentMethods.CRYPTOPAY: 'cryptopay'>
          │    │            │                 │                                 └ <enum 'PaymentMethods'>
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x0000027BC35F3560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC5566C90>
          └ <bot.db.Repo object at 0x0000027BC5566810>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 45, in add_topup_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC5567B90>
          │    │       └ <function AsyncSession.execute at 0x0000027BC33FC4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000027BC5566310>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC5566C90>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x0000027BC2A6AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 186, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': None, 'execution_options': immutabledict({'prebuffer_rows': True}), 'bind_arguments': None}
             │       │       └ (<sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC5567B90>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000027BC5566F80 (otid=0x0000027BC2997DE0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000027BC331C2C0>
           └ <sqlalchemy.orm.session.Session object at 0x0000027BC5566410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x0000027BC32EFD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x0000027BC2F52520>
             └ <sqlalchemy.engine.base.Connection object at 0x0000027BC555CC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000027BC2F52840>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027BC555CC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1622, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x0000027BC2D4C680>
                                                └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 714, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x0000027BC2D3F6A0>
                   └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 314, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': None, 'column_keys': [], 'for_executemany': False, 'schema_translate_map': None, 'linting': 3}
           │       │                  │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
           │       │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
           │       └ <class 'sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg'>
           └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1424, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
    │        │        │     └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
    │        │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555CE10>
    │        └ <function Compiled.__init__ at 0x0000027BC2ED1800>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 865, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555CE10>
    │    │        │    └ <function Compiled.process at 0x0000027BC2ED1BC0>
    │    │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555CE10>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555CE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 910, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555CE10>
           │   └ <function Annotated._compiler_dispatch at 0x0000027BC2C7BBA0>
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC555C0D0>
           └ <bound method SQLCompiler.visit_insert of <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC555...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5696, in visit_insert
    crud_params_struct = crud._get_crud_params(
                         │    └ <function _get_crud_params at 0x0000027BC2C78E00>
                         └ <module 'sqlalchemy.sql.crud' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\crud.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 335, in _get_crud_params
    raise exc.CompileError(
          │   └ <class 'sqlalchemy.exc.CompileError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.CompileError: Unconsumed column names: payment_type
2024-03-01T15:14:44.273057+0200 INFO ::1 [01/Mar/2024:15:14:44 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:14:49.286466+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000027BC37A11C0>
    │       └ <function run at 0x0000027BBB0FC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000027BC375E240>
           │      └ <function Runner.run at 0x0000027BBB18C900>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027BBB18A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000027BBB26A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027BBB18C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027BBB0CDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x27bc3918e10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x0000027BC37A0E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 78, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, amount=228, payment_type=PaymentMethods.CRYPTOPAY)
          │    │            │                 │                                 │              └ <PaymentMethods.CRYPTOPAY: 'cryptopay'>
          │    │            │                 │                                 └ <enum 'PaymentMethods'>
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x0000027BC35F3560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC55263D0>
          └ <bot.db.Repo object at 0x0000027BC5526290>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 45, in add_topup_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC5526D50>
          │    │       └ <function AsyncSession.execute at 0x0000027BC33FC4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000027BC5526110>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC55263D0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x0000027BC2A6AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 186, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': None, 'execution_options': immutabledict({'prebuffer_rows': True}), 'bind_arguments': None}
             │       │       └ (<sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC5526D50>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000027BC5527200 (otid=0x0000027BC2997DE0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000027BC331C2C0>
           └ <sqlalchemy.orm.session.Session object at 0x0000027BC5526150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x0000027BC32EFD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x0000027BC2F52520>
             └ <sqlalchemy.engine.base.Connection object at 0x0000027BC5526450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000027BC2F52840>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027BC5526450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1622, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x0000027BC2D4C680>
                                                └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 714, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x0000027BC2D3F6A0>
                   └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 314, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': None, 'column_keys': [], 'for_executemany': False, 'schema_translate_map': None, 'linting': 3}
           │       │                  │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
           │       │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
           │       └ <class 'sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg'>
           └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1424, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
    │        │        │     └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
    │        │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC5570250>
    │        └ <function Compiled.__init__ at 0x0000027BC2ED1800>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 865, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC5570250>
    │    │        │    └ <function Compiled.process at 0x0000027BC2ED1BC0>
    │    │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC5570250>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC5570250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 910, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC5570250>
           │   └ <function Annotated._compiler_dispatch at 0x0000027BC2C7BBA0>
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC5527C50>
           └ <bound method SQLCompiler.visit_insert of <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC557...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5696, in visit_insert
    crud_params_struct = crud._get_crud_params(
                         │    └ <function _get_crud_params at 0x0000027BC2C78E00>
                         └ <module 'sqlalchemy.sql.crud' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\crud.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 335, in _get_crud_params
    raise exc.CompileError(
          │   └ <class 'sqlalchemy.exc.CompileError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.CompileError: Unconsumed column names: payment_type
2024-03-01T15:14:49.293153+0200 INFO ::1 [01/Mar/2024:15:14:49 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:14:58.289938+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000027BC37A11C0>
    │       └ <function run at 0x0000027BBB0FC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000027BC375E240>
           │      └ <function Runner.run at 0x0000027BBB18C900>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027BBB18A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027BC303F510>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000027BBB26A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027BBB18C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027BBB0CDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x27bc3918e10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x0000027BC37A0E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 78, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, amount=228, payment_type=PaymentMethods.CRYPTOPAY)
          │    │            │                 │                                 │              └ <PaymentMethods.CRYPTOPAY: 'cryptopay'>
          │    │            │                 │                                 └ <enum 'PaymentMethods'>
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x0000027BC35F3560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC4228BD0>
          └ <bot.db.Repo object at 0x0000027BC422B110>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 45, in add_topup_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC422B490>
          │    │       └ <function AsyncSession.execute at 0x0000027BC33FC4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x0000027BC422B1D0>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x0000027BC4228BD0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x0000027BC2A6AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 186, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             │       │       │       └ {'params': None, 'execution_options': immutabledict({'prebuffer_rows': True}), 'bind_arguments': None}
             │       │       └ (<sqlalchemy.dialects.postgresql.dml.Insert object at 0x0000027BC422B490>,)
             │       └ <method 'switch' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x0000027BC3E58A40 (otid=0x0000027BC2997DE0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000027BC331C2C0>
           └ <sqlalchemy.orm.session.Session object at 0x0000027BC42283D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x0000027BC32EFD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x0000027BC2F52520>
             └ <sqlalchemy.engine.base.Connection object at 0x0000027BC3D3D410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000027BC2F52840>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027BC3D3D410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1622, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x0000027BC2D4C680>
                                                └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 714, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x0000027BC2D3F6A0>
                   └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 314, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': None, 'column_keys': [], 'for_executemany': False, 'schema_translate_map': None, 'linting': 3}
           │       │                  │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
           │       │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
           │       └ <class 'sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg'>
           └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1424, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
    │        │        │     └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x0000027BC36CAA50>
    │        │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C5BD0>
    │        └ <function Compiled.__init__ at 0x0000027BC2ED1800>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 865, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C5BD0>
    │    │        │    └ <function Compiled.process at 0x0000027BC2ED1BC0>
    │    │        └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C5BD0>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C5BD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 910, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C5BD0>
           │   └ <function Annotated._compiler_dispatch at 0x0000027BC2C7BBA0>
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x0000027BC3D3DA50>
           └ <bound method SQLCompiler.visit_insert of <sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg object at 0x0000027BC42C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5696, in visit_insert
    crud_params_struct = crud._get_crud_params(
                         │    └ <function _get_crud_params at 0x0000027BC2C78E00>
                         └ <module 'sqlalchemy.sql.crud' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\crud.py'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 335, in _get_crud_params
    raise exc.CompileError(
          │   └ <class 'sqlalchemy.exc.CompileError'>
          └ <module 'sqlalchemy.exc' from 'E:\\PythonProjects\\Arbitrix\\.venv\\Lib\\site-packages\\sqlalchemy\\exc.py'>

sqlalchemy.exc.CompileError: Unconsumed column names: payment_type
2024-03-01T15:14:58.299914+0200 INFO ::1 [01/Mar/2024:15:14:58 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:15:08.691300+0200 INFO Bot stopped!
2024-03-01T15:16:29.866567+0200 INFO Bot started!
2024-03-01T15:16:32.006768+0200 INFO ::1 [01/Mar/2024:15:16:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:16:32.322517+0200 INFO Update id=925012187 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T15:16:53.413177+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 538, in _prepare_and_execute
    self._rows = await prepared_stmt.fetch(*parameters)
    │    │             │             │      └ (387375605, <PaymentMethods.CRYPTOPAY: 'cryptopay'>, None, None, 1, <TopUpStatus.COMPLETED_BY_CRYPTOBOT: 'completed_by_crypto...
    │    │             │             └ <function PreparedStatement.fetch at 0x000002AC120C1760>
    │    │             └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002AC126DBBF0>
    │    └ <member '_rows' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
                 │                   │        └ None
                 │                   └ (387375605, <PaymentMethods.CRYPTOPAY: 'cryptopay'>, None, None, 1, <TopUpStatus.COMPLETED_BY_CRYPTOBOT: 'completed_by_crypto...
                 └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002AC126DBBF0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 241, in __bind_execute
    data, status, _ = await self.__do_execute(
                            └ <asyncpg.prepared_stmt.PreparedStatement object at 0x000002AC126DBBF0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 230, in __do_execute
    return await executor(protocol)
                 │        └ <asyncpg.protocol.protocol.Protocol object at 0x000002AC120E05D0>
                 └ <function PreparedStatement.__bind_execute.<locals>.<lambda> at 0x000002AC129776A0>
  File "asyncpg\protocol\protocol.pyx", line 207, in bind_execute

asyncpg.exceptions.NotNullViolationError: null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, cryptopay, null, null, 1, completed_by_cryptobot).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002AC11836340>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000002AC11EDD890>
    └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, <PaymentMethods.CRYPTOPAY: 'cryptopay'>, None, None, 1, <TopUpStatus.COMPLETED_BY_CRYPTOBOT: 'completed_by_crypto...
    │      │       └ 'INSERT INTO top_up_requests ("ID пользователя", "Тип пополнения", "ФИО", "Последние 4 цифры карты", "Сумма пополнения", "Ста...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000002AC11D49580>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002AC125EDB40>
           └ <_AsyncIoGreenlet object at 0x000002AC125A0200 (otid=0x000002AC111C7D20) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002AC125EDB40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000002AC11D493A0>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "ФИО" відношення "top_up_reques...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, cryptopay, null, null, 1, completed_by_cryptobot).


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000002AC11FD11C0>
    │       └ <function run at 0x000002AC0992C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000002AC11F92240>
           │      └ <function Runner.run at 0x000002AC099BC900>
           └ <asyncio.runners.Runner object at 0x000002AC11C1ED90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002AC099BA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002AC11C1ED90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002AC09A9A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002AC099BC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002AC098FDA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x2ac11fba4d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000002AC11FD0E00>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 76, in handle_cryptopay_updates
    await repo.payment_repo.add_topup_request(user_id, amount=int(data['payload']['amount']), payment_method=PaymentMethods.CRYPTOPAY)
          │    │            │                 │                   │                                          │              └ <PaymentMethods.CRYPTOPAY: 'cryptopay'>
          │    │            │                 │                   │                                          └ <enum 'PaymentMethods'>
          │    │            │                 │                   └ {'update_id': 33622, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:16:52.005Z', 'payload': {'invoice_id': 164...
          │    │            │                 └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_topup_request at 0x000002AC11E23560>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x000002AC12889F90>
          └ <bot.db.Repo object at 0x000002AC11ED1990>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 45, in add_topup_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x000002AC126B2290>
          │    │       └ <function AsyncSession.execute at 0x000002AC11C2C4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000002AC12064910>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x000002AC12889F90>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x000002AC1129AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x000002AC125A0200 (otid=0x000002AC111C7D20) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000002AC11B4C2C0>
           └ <sqlalchemy.orm.session.Session object at 0x000002AC12693290>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x000002AC11B1FD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000002AC11782520>
             └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x000002AC125D5110>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002AC11782840>
           └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002AC11782A20>
          └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000002AC11782AC0>
           └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002AC11782D40>
    └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "ФИО" відношення "top_up_reques...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError'>, IntegrityError('<class \'asyncpg.e...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class \'asyncpg.exceptions.NotNullViolationError\'>:...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002AC11836340>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x000002AC11EDD890>
    └ <sqlalchemy.engine.base.Connection object at 0x000002AC127E1F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, <PaymentMethods.CRYPTOPAY: 'cryptopay'>, None, None, 1, <TopUpStatus.COMPLETED_BY_CRYPTOBOT: 'completed_by_crypto...
    │      │       └ 'INSERT INTO top_up_requests ("ID пользователя", "Тип пополнения", "ФИО", "Последние 4 цифры карты", "Сумма пополнения", "Ста...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x000002AC11D49580>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002AC125EDB40>
           └ <_AsyncIoGreenlet object at 0x000002AC125A0200 (otid=0x000002AC111C7D20) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x000002AC125EDB40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x000002AC11D493A0>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ NotNullViolationError('null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x000002AC120BF520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ NotNullViolationError('null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження')
          └ IntegrityError('<class \'asyncpg.exceptions.NotNullViolationError\'>: null значення в стовпці "ФИО" відношення "top_up_reques...

sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null значення в стовпці "ФИО" відношення "top_up_requests" порушує not-null обмеження
DETAIL:  Помилковий рядок містить (1, 387375605, cryptopay, null, null, 1, completed_by_cryptobot).
[SQL: INSERT INTO top_up_requests ("ID пользователя", "Тип пополнения", "ФИО", "Последние 4 цифры карты", "Сумма пополнения", "Статус запроса") VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) ON CONFLICT DO NOTHING RETURNING top_up_requests.id]
[parameters: (387375605, <PaymentMethods.CRYPTOPAY: 'cryptopay'>, None, None, 1, <TopUpStatus.COMPLETED_BY_CRYPTOBOT: 'completed_by_cryptobot'>)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-03-01T15:16:53.430127+0200 INFO ::1 [01/Mar/2024:15:16:53 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:16:58.367641+0200 INFO Bot stopped!
2024-03-01T15:21:52.853728+0200 INFO Bot started!
2024-03-01T15:22:59.180649+0200 INFO Bot stopped!
2024-03-01T15:23:33.402205+0200 INFO Bot started!
2024-03-01T15:23:36.250715+0200 INFO ::1 [01/Mar/2024:15:23:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:23:36.416420+0200 INFO Update id=925012188 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T15:23:37.789896+0200 INFO ::1 [01/Mar/2024:15:23:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:23:37.999100+0200 INFO Update id=925012189 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T15:23:41.854502+0200 INFO ::1 [01/Mar/2024:15:23:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:23:41.997651+0200 INFO Update id=925012190 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:23:48.493278+0200 INFO ::1 [01/Mar/2024:15:23:48 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:23:48.574623+0200 INFO Update id=925012191 is handled. Duration 77 ms by bot id=5646878393
2024-03-01T15:24:10.970910+0200 INFO ::1 [01/Mar/2024:15:24:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:24:11.177987+0200 INFO Update id=925012192 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T15:24:17.328835+0200 INFO ::1 [01/Mar/2024:15:24:17 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:24:31.010494+0200 INFO Bot stopped!
2024-03-01T15:24:34.451671+0200 INFO Bot started!
2024-03-01T15:24:36.815530+0200 INFO ::1 [01/Mar/2024:15:24:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:24:37.073183+0200 INFO Update id=925012193 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T15:24:37.773101+0200 INFO ::1 [01/Mar/2024:15:24:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:24:37.818524+0200 INFO Update id=925012194 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T15:24:37.825529+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-18' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001A0617898D0>
                   │    │          │                   │           └ {'update_id': 925012194, 'callback_query': {'id': '1663765557415599998', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001A05D82DC60>
                   │    └ <Dispatcher '0x1a06155ab10'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001A0617898D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
                 │    └ <function Dispatcher.feed_update at 0x000001A05D82DBC0>
                 └ <Dispatcher '0x1a06155ab10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A05D82C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A061789290>
                     └ <Dispatcher '0x1a06155ab10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001A061445510>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001A061611090>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001A062011200>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001A061C4A2F0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001A06153C050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001A061580450>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001A061EC0400>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001A061794E90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001A0616B9810>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012194, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001A061EC0680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1a06155ab10'>>, Update(update_id=925012194, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001A05D82D1C0>
                 └ <Dispatcher '0x1a06155ab10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A0617545E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A05D82C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A06177B850>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A05D82D260>
                 └ <Dispatcher '0x1a06155ab10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001A05D82D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A061EC0900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A05D82C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A06178AD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001A061BC8CD0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001A061EC09A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A05D82D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001A05D82D1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001A061EC1EE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001A05D82C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A06179A650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001A05D82D260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001A05D82C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001A06179A650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001A061794ED0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001A0616B9810>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001A061BC8B50>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001A05F3E9B20>, <function CallableObject.call at 0x000001A061EC0...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1a06155ab10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001A061EC0860>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='1663765557...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001A05F4345E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001A05F2218A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001A06152EA10>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001A05F3A8A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001A06152EA10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001A05F2218A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001A06155AA10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001A05F3A8A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001A06155AA10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001A05F2218A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001A061799010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000001A05F222020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001A061799010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001A061799010>
          │    │        │             └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001A05F2039C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001A0616B8E90>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001A061799010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001A061799010>
          │    │        └ CallbackQuery(id='1663765557415599998', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_start_select_offer at 0x000001A061594360>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001A0616B8E90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x000001A05F421620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x000001A05F421800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001A05F421BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001A0617B7050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
          │    └ <function MessageManager.edit_message_safe at 0x000001A05F423380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001A061BC89D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
                 │    └ <function MessageManager.edit_message at 0x000001A05F423420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001A061BC89D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
                 │    └ <function MessageManager.edit_text at 0x000001A05F423560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001A061BC89D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x000001A05DAB4360>
                 └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=387375605, message_id=62633, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=387375605, message_id=62633, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001A06156FC10>
                 └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=387375605, message_id=62633, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x000001A0616BA790>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x000001A058FF04A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x000001A0570636A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001A06156FC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=387375605, message_id=62633, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T15:24:44.306239+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001A061631440>
    │       └ <function run at 0x000001A058F8C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001A0615EA340>
           │      └ <function Runner.run at 0x000001A05901C900>
           └ <asyncio.runners.Runner object at 0x000001A05F12FF90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001A05901A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001A05F12FF90>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001A0590FA340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001A05901C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001A058F5DA80>
    └ <Handle <TaskStepMethWrapper object at 0x000001A061F29840>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x000001A061F29840>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x000001A061F29840>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x000001A061F29840>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x1a0617d5dd0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x000001A061631080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
                 │               │                  └ {'update_id': 33626, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:24:43.006Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x000001A061BBFCD0>
                 └ <function check_signature at 0x000001A06160ED40>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ 'fb8256b549bea4d285f86d80eb8b5b947d2abc20f4e3d6339f0c19dc1fcda985'
           │      │                         └ {'update_id': 33626, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:24:43.006Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x000001A05A8AF2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x000001A061BBFCD0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33626, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:24:43.006Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:24:44.315865+0200 INFO ::1 [01/Mar/2024:15:24:44 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:24:45.492031+0200 INFO ::1 [01/Mar/2024:15:24:45 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:24:45.804499+0200 INFO Update id=925012195 is handled. Duration 311 ms by bot id=5646878393
2024-03-01T15:24:58.854319+0200 INFO Bot stopped!
2024-03-01T15:25:02.086473+0200 INFO Bot started!
2024-03-01T15:25:05.996087+0200 INFO ::1 [01/Mar/2024:15:25:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:06.353183+0200 INFO Update id=925012196 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T15:25:07.310542+0200 INFO ::1 [01/Mar/2024:15:25:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:07.582929+0200 INFO Update id=925012197 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T15:25:08.654524+0200 INFO ::1 [01/Mar/2024:15:25:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:08.826575+0200 INFO Update id=925012198 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T15:25:10.087015+0200 INFO ::1 [01/Mar/2024:15:25:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:10.219543+0200 INFO Update id=925012199 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:25:10.960023+0200 INFO ::1 [01/Mar/2024:15:25:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:11.126817+0200 INFO Update id=925012200 is handled. Duration 170 ms by bot id=5646878393
2024-03-01T15:25:11.652283+0200 INFO ::1 [01/Mar/2024:15:25:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:11.795312+0200 INFO Update id=925012201 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:25:21.809937+0200 INFO ::1 [01/Mar/2024:15:25:21 +0200] "OPTIONS /traffic-requirements HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T15:25:22.047261+0200 INFO ::1 [01/Mar/2024:15:25:21 +0200] "POST /traffic-requirements HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T15:25:23.028775+0200 INFO ::1 [01/Mar/2024:15:25:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:23.210861+0200 INFO Update id=925012202 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:25:26.531182+0200 INFO ::1 [01/Mar/2024:15:25:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:25:26.611876+0200 INFO Update id=925012203 is handled. Duration 94 ms by bot id=5646878393
2024-03-01T15:25:32.325627+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000205F50913A0>
    │       └ <function run at 0x00000205ECA1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000205F504A340>
           │      └ <function Runner.run at 0x00000205ECAAC900>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000205ECAAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000205ECB7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000205ECAAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000205EC9EDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F59842E0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000205F59842E0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000205F59842E0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F59842E0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x205f561f9d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x00000205F5091080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '805', 'Accept'...
                 │               │                  └ {'update_id': 33631, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:31.006Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>
                 └ <function check_signature at 0x00000205F506EE80>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ 'd093e19b2675e90be651e9c6512379adea377ca1d2e720ed00ef6fa60c3c3f7d'
           │      │                         └ {'update_id': 33631, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:31.006Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x00000205EE30F2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33631, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:31.006Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:25:32.339884+0200 INFO ::1 [01/Mar/2024:15:25:32 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:25:35.273017+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000205F50913A0>
    │       └ <function run at 0x00000205ECA1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000205F504A340>
           │      └ <function Runner.run at 0x00000205ECAAC900>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000205ECAAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000205ECB7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000205ECAAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000205EC9EDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BF10>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BF10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BF10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BF10>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x205f561f9d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x00000205F5091080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '805', 'Accept'...
                 │               │                  └ {'update_id': 33632, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:34.005Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>
                 └ <function check_signature at 0x00000205F506EE80>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ '819662b3eb62e020b0a8035853e4fd36e2cc4a92f4e13f545cae6f66b3dcaf29'
           │      │                         └ {'update_id': 33632, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:34.005Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x00000205EE30F2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33632, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:34.005Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:25:35.280582+0200 INFO ::1 [01/Mar/2024:15:25:35 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:25:40.273415+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000205F50913A0>
    │       └ <function run at 0x00000205ECA1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000205F504A340>
           │      └ <function Runner.run at 0x00000205ECAAC900>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000205ECAAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000205ECB7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000205ECAAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000205EC9EDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BC40>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BC40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BC40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D6BC40>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x205f561f9d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x00000205F5091080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '805', 'Accept'...
                 │               │                  └ {'update_id': 33633, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:39.006Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>
                 └ <function check_signature at 0x00000205F506EE80>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ 'a1537d54f223ff5c0c2ebe4ba176fa2b6320885506190cfce94cdf176ec6591f'
           │      │                         └ {'update_id': 33633, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:39.006Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x00000205EE30F2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33633, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:39.006Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:25:40.280936+0200 INFO ::1 [01/Mar/2024:15:25:40 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:25:42.495128+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000205F50913A0>
    │       └ <function run at 0x00000205ECA1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000205F504A340>
           │      └ <function Runner.run at 0x00000205ECAAC900>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000205ECAAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000205ECB7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000205ECAAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000205EC9EDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29390>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29390>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29390>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29390>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x205f561f9d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x00000205F5091080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '814', 'Accept'...
                 │               │                  └ {'update_id': 33627, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:41.006Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>
                 └ <function check_signature at 0x00000205F506EE80>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ '6a7e854e0151782b5484a6e5286ba54c026b081f60d2f414d320746d3b002d1b'
           │      │                         └ {'update_id': 33627, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:41.006Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x00000205EE30F2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33627, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:41.006Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:25:42.503174+0200 INFO ::1 [01/Mar/2024:15:25:42 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:25:49.276883+0200 ERROR Error handling request
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000205F50913A0>
    │       └ <function run at 0x00000205ECA1C540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000205F504A340>
           │      └ <function Runner.run at 0x00000205ECAAC900>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000205ECAAA3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000205F4F928D0>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000205ECB7A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000205ECAAC180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000205EC9EDA80>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29EA0>()>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29EA0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29EA0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x00000205F6D29EA0>()>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /crypto_bot_webhook >
                 └ <bound method Application._handle of <Application 0x205f561f9d0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /crypto_bot_webhook >
                 └ <function handle_cryptopay_updates at 0x00000205F5091080>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 67, in handle_cryptopay_updates
    if not await check_signature(crypto_bot_client, data, header['Crypto-Pay-Api-Signature']):
                 │               │                  │     └ <CIMultiDictProxy('Host': 'df73-31-42-178-52.ngrok-free.app', 'User-Agent': 'axios/0.21.4', 'Content-Length': '805', 'Accept'...
                 │               │                  └ {'update_id': 33634, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:48.006Z', 'payload': {'invoice_id': 164...
                 │               └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>
                 └ <function check_signature at 0x00000205F506EE80>

  File "E:\PythonProjects\Arbitrix\bot\services\cryptopay\requests.py", line 22, in check_signature
    return client.check_signature(body_text=body_text, crypto_pay_signature=crypto_pay_signature)
           │      │                         │                               └ 'fc2a131193e62d8dd43f6f4643b593ca01c212b01f4a2449cae00d81326fa248'
           │      │                         └ {'update_id': 33634, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:48.006Z', 'payload': {'invoice_id': 164...
           │      └ <function AioCryptoPay.check_signature at 0x00000205EE30F2E0>
           └ <aiocryptopay.api.AioCryptoPay object at 0x00000205F561FC10>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiocryptopay\api.py", line 464, in check_signature
    key=token, msg=body_text.encode("UTF-8"), digestmod=sha256
        │          │                                    └ <built-in function openssl_sha256>
        │          └ {'update_id': 33634, 'update_type': 'invoice_paid', 'request_date': '2024-03-01T13:25:48.006Z', 'payload': {'invoice_id': 164...
        └ b'6\x87@\xbf\xe3,\tk\x1d\x8fV\xb7}\xc4H\xfb\x9a$\x06x\\s\x1c\xc6\x985\x97\xb1/\x06\xa9}'

AttributeError: 'dict' object has no attribute 'encode'
2024-03-01T15:25:49.282372+0200 INFO ::1 [01/Mar/2024:15:25:49 +0200] "POST /crypto_bot_webhook HTTP/1.1" 500 245 "-" "axios/0.21.4"
2024-03-01T15:25:51.743644+0200 INFO Bot stopped!
2024-03-01T15:26:53.093797+0200 INFO Bot started!
2024-03-01T15:26:54.242414+0200 INFO ::1 [01/Mar/2024:15:26:54 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:26:54.549243+0200 INFO Update id=925012204 is handled. Duration 311 ms by bot id=5646878393
2024-03-01T15:27:00.492433+0200 INFO ::1 [01/Mar/2024:15:27:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:27:00.728707+0200 INFO Update id=925012205 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:27:07.360205+0200 INFO ::1 [01/Mar/2024:15:27:07 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:27:18.724385+0200 INFO ::1 [01/Mar/2024:15:27:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:27:18.879560+0200 INFO Update id=925012206 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T15:27:44.295144+0200 INFO ::1 [01/Mar/2024:15:27:44 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:27:44.639163+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-49' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000223E4DFD1C0>
          │    └ <Dispatcher '0x223e68728d0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000223EA8379D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97DA200>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000223E8D50690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000223E8D504D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000223EA834F00>
          │    │   │      │    └ ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOpe...
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000223E958A110>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000223E92A87D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000223E8D50D90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D94E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000223E8B2C190>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000223E8D50E90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000223E94805E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x223e68728d0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E9480680>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E679CA40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000223E917FF50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E8D16160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000223E89C9AD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x00000223E69A9B20>, <function CallableObject.call at 0x00000223E97D9...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x00000223E97D9940>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000223E69E2A20>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 28, in handle_update
    await dialog_manager.switch_to(state=event.new_state)
          │              │               │     └ <State 'TopUpOperations:data_saved'>
          │              │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
          │              └ <function ManagerImpl.switch_to at 0x00000223E69E1A80>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000223E95118D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 299, in switch_to
    raise ValueError(

ValueError: Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>
2024-03-01T15:28:20.373435+0200 INFO ::1 [01/Mar/2024:15:28:20 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:28:20.573771+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-59' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000223E4DFD1C0>
          │    └ <Dispatcher '0x223e68728d0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000223E8B19950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223EA8D9120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000223E8D50690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000223E8D504D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000223EA8DF000>
          │    │   │      │    └ ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOpe...
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000223E958B1F0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000223EA8DE050>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000223E8D50D90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223EA8D9800>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000223E8B2C190>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000223E8D50E90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000223E97D8860>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x223e68728d0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D8B80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D8900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000223E917FF50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D89A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000223E89C9AD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x00000223E69A9B20>, <function CallableObject.call at 0x00000223E97D9...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x00000223E97D9260>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000223E69E2A20>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 28, in handle_update
    await dialog_manager.switch_to(state=event.new_state)
          │              │               │     └ <State 'TopUpOperations:data_saved'>
          │              │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
          │              └ <function ManagerImpl.switch_to at 0x00000223E69E1A80>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000223E957C490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 299, in switch_to
    raise ValueError(

ValueError: Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>
2024-03-01T15:29:45.350951+0200 INFO ::1 [01/Mar/2024:15:29:45 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:29:45.355017+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-69' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000223E4DFD1C0>
          │    └ <Dispatcher '0x223e68728d0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000223E68ED9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E92CFD80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000223E8D50690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000223E8D504D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000223E917B200>
          │    │   │      │    └ ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOpe...
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000223E9206200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000223E8D41410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000223E8D50D90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E92CFF60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000223E8B2C190>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000223E8D50E90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000223E94814E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x223e68728d0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97DBF60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223EA8D98A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000223E917FF50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223EA8D8860>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000223E89C9AD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x00000223E69A9B20>, <function CallableObject.call at 0x00000223EA8D9...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x00000223EA8D9440>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000223E69E2A20>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 28, in handle_update
    await dialog_manager.switch_to(state=event.new_state)
          │              │               │     └ <State 'TopUpOperations:data_saved'>
          │              │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
          │              └ <function ManagerImpl.switch_to at 0x00000223E69E1A80>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000223E929CDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 299, in switch_to
    raise ValueError(

ValueError: Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>
2024-03-01T15:30:43.285721+0200 INFO ::1 [01/Mar/2024:15:30:43 +0200] "POST /crypto_bot_webhook HTTP/1.1" 200 170 "-" "axios/0.21.4"
2024-03-01T15:30:43.733694+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-79' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x00000223E4DFD1C0>
          │    └ <Dispatcher '0x223e68728d0'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x00000223E96F2DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97DAF20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000223E8D50690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000223E8D504D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000223E9576B80>
          │    │   │      │    └ ValueError("Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOpe...
          │    │   │      └ <class 'ValueError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000223E958B5B0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000223E9576010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000223E8D50D90>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D8B80>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D40110>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000223E8B2C190>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000223E8D50E90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x00000223E94814E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x223e68728d0'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97DBE20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Dispatcher '0x223e68728d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x00000223E4DFD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D8860>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000223E4DFC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000223E917FF50>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000223E97D8A40>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000223E4DFD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x00000223E4DFC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000223E8D54390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000223E89C9AD0>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x00000223E69A9B20>, <function CallableObject.call at 0x00000223E679C...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x00000223E8D1C9D0>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x00000223E679CD60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x00000223E69E2A20>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 28, in handle_update
    await dialog_manager.switch_to(state=event.new_state)
          │              │               │     └ <State 'TopUpOperations:data_saved'>
          │              │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
          │              └ <function ManagerImpl.switch_to at 0x00000223E69E1A80>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000223E9574890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 299, in switch_to
    raise ValueError(

ValueError: Cannot switch to another state group. Current state: <State 'MainMenu:select_action'>, asked for <State 'TopUpOperations:data_saved'>
2024-03-01T15:34:47.871388+0200 INFO Bot stopped!
2024-03-01T15:34:51.500567+0200 INFO Bot started!
2024-03-01T15:34:53.403069+0200 INFO ::1 [01/Mar/2024:15:34:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:53.582252+0200 INFO ::1 [01/Mar/2024:15:34:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:53.866535+0200 INFO Update id=925012207 is handled. Duration 469 ms by bot id=5646878393
2024-03-01T15:34:53.929111+0200 INFO Update id=925012208 is handled. Duration 342 ms by bot id=5646878393
2024-03-01T15:34:55.756899+0200 INFO ::1 [01/Mar/2024:15:34:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:55.941330+0200 INFO Update id=925012209 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:34:56.897055+0200 INFO ::1 [01/Mar/2024:15:34:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:57.151513+0200 INFO Update id=925012210 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T15:34:57.633178+0200 INFO ::1 [01/Mar/2024:15:34:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:57.948480+0200 INFO Update id=925012211 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T15:34:58.371563+0200 INFO ::1 [01/Mar/2024:15:34:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:34:58.375469+0200 ERROR Cannot get window data for state <State 'ChannelPosterAdminMenu:select_channel'>
2024-03-01T15:34:58.376469+0200 INFO Update id=925012212 is not handled. Duration 14 ms by bot id=5646878393
2024-03-01T15:34:58.381469+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-40' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'Offers' object has no attribute 'channel_title'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000246A55C9510>
                   │    │          │                   │           └ {'update_id': 925012212, 'callback_query': {'id': '1663765558565366671', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000246A4F5B590>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x00000246A122DC60>
                   │    └ <Dispatcher '0x246a517a050'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x00000246A55C9510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000246A4F5B590>
                 │    └ <function Dispatcher.feed_update at 0x00000246A122DBC0>
                 └ <Dispatcher '0x246a517a050'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246A122C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246A4F71F90>
                     └ <Dispatcher '0x246a517a050'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000246A4F4BC10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000246A507CDD0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000246A5AEE4C0>
          │    │   │      │    └ AttributeError("'Offers' object has no attribute 'channel_title'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x00000246A564BF10>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000246A5634710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x00000246A4F3FF50>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000246A5151760>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000246A4E09F10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000246A4F5B190>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012212, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x00000246A58C09A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x246a517a050'>>, Update(update_id=925012212, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000246A122D1C0>
                 └ <Dispatcher '0x246a517a050'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000246A58C0B80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246A122C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246A517A8D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246A122D260>
                 └ <Dispatcher '0x246a517a050'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000246A122D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000246A58C2340>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246A122C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246A5185ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x00000246A55C8590>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x00000246A58C0E00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246A122D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000246A122D1C0>
                     └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000246A58C2480>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000246A122C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246A51BFD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000246A122D260>
                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x00000246A122C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000246A51BFD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x00000246A5187F90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x00000246A4F5B190>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000246A55C8410>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000246A2DE9B20>, <function CallableObject.call at 0x00000246A58C0...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x246a517a050'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558565366671', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x00000246A58C0EA0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000246A2E21BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
                        │    └ <function ManagerImpl.dialog at 0x00000246A2E20F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
                        │      │      └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                        │      └ <function Window.render at 0x00000246A2E34680>
                        └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
                         │    │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                         │    └ <function Window.load_data at 0x00000246A2E344A0>
                         └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000246A2E1DCB0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000246A5AEE150>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000246A51BEF10>
    │    │            └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_channel_theme': 'news'}, 'start_data': None, 'middleware_data': {'dp': <Dispatcher '0x246a517a050'...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offers_with_theme at 0x00000246A4F96840>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x00000246A51BEF10>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 129, in get_offers_with_theme
    'offers': [

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 130, in <listcomp>
    (channel.channel_id, f"{channel.channel_title} - {channel.target_request_amount}") for channel in channels_model
     │       │                                                                             └ <bot.db.models.models.Offers object at 0x00000246A5923D90>
     │       └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000246A4E2B560>
     └ <bot.db.models.models.Offers object at 0x00000246A5923D90>

AttributeError: 'Offers' object has no attribute 'channel_title'
2024-03-01T15:35:15.340324+0200 INFO Bot stopped!
2024-03-01T15:35:18.789613+0200 INFO Bot started!
2024-03-01T15:35:20.689942+0200 INFO ::1 [01/Mar/2024:15:35:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:35:21.296758+0200 INFO Update id=925012213 is handled. Duration 593 ms by bot id=5646878393
2024-03-01T15:35:22.119368+0200 INFO ::1 [01/Mar/2024:15:35:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:35:22.312285+0200 INFO Update id=925012214 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:35:22.993714+0200 INFO ::1 [01/Mar/2024:15:35:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:35:23.133890+0200 INFO Update id=925012215 is handled. Duration 139 ms by bot id=5646878393
2024-03-01T15:35:32.801366+0200 INFO ::1 [01/Mar/2024:15:35:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:35:32.807593+0200 ERROR Cannot get window data for state <State 'AdminOffers:show_offer_info'>
2024-03-01T15:35:32.809593+0200 INFO Update id=925012216 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T15:35:32.816594+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'NoneType' object has no attribute 'id'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000012A10B9F610>
                   │    │          │                   │           └ {'update_id': 925012216, 'callback_query': {'id': '1663765557701542325', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000012A10652A10>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000012A0C801C60>
                   │    └ <Dispatcher '0x12a10749c90'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000012A10B9F610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000012A10652A10>
                 │    └ <function Dispatcher.feed_update at 0x0000012A0C801BC0>
                 └ <Dispatcher '0x12a10749c90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000012A0C800400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000012A1050D1D0>
                     └ <Dispatcher '0x12a10749c90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000012A1050DB10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000012A10758610>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000012A10FFD280>
          │    │   │      │    └ AttributeError("'NoneType' object has no attribute 'id'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000012A10C1A110>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000012A10EB5610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000012A10519090>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000012A10E905E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000012A1075BC10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000012A0E425710>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012216, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000012A10E92F20>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x12a10749c90'>>, Update(update_id=925012216, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000012A0C8011C0>
                 └ <Dispatcher '0x12a10749c90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000012A10E90D60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000012A0C800400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000012A1074A490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000012A0C801260>
                 └ <Dispatcher '0x12a10749c90'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000012A0C8011C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000012A10E90CC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000012A0C800400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000012A10759B10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000012A10B9C050>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000012A10E93F60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000012A0C801260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000012A0C8011C0>
                     └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000012A10E90A40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000012A0C800400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000012A1078F8D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000012A0C801260>
                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x0000012A0C800540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000012A1078F8D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000012A1052BC50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000012A0E425710>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000012A10B93E90>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x0000012A0E3B9B20>, <function CallableObject.call at 0x0000012A10E93...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x12a10749c90'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000012A10E93E20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
          │      │                └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x0000012A0E4045E0>
          └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x0000012A0E1F18A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000012A1078E950>
          └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x0000012A0E378A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000012A1078E950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
             │ │                └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x0000012A0E1F18A0>
             └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x0000012A1078E6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x0000012A0E378A40>
                 └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x0000012A1078E6D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
             │ │                └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x0000012A0E1F18A0>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000012A1078E690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x0000012A0E3989A0>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000012A1078E690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x0000012A0E1D39C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000012A1078E750>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000012A1078E690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('-1001812565202',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000012A1078E690>
          │    │        └ CallbackQuery(id='1663765557701542325', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_select_offer at 0x0000012A104F2C00>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000012A1078E750>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 18, in on_select_offer
    await manager.start(states.AdminOffers.show_offer_info, data=manager.dialog_data)
          │       │     │      │           │                     │       └ <property object at 0x0000012A0E3EEED0>
          │       │     │      │           │                     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
          │       │     │      │           └ <State 'AdminOffers:show_offer_info'>
          │       │     │      └ <class 'bot.dialogs.channel_admin_menu.states.AdminOffers'>
          │       │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
          │       └ <function ManagerImpl.start at 0x0000012A0E3F1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'selected_channel_theme': 'news', 'selected_offer': -1001812565202}
          │    │             └ <State 'AdminOffers:show_offer_info'>
          │    └ <function ManagerImpl._start_normal at 0x0000012A0E3F1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x0000012A0E3F1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
                        │    └ <function ManagerImpl.dialog at 0x0000012A0E3F0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x0000012A0E404680>
                        └ <Window(<State 'AdminOffers:show_offer_info'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x0000012A0E4044A0>
                         └ <Window(<State 'AdminOffers:show_offer_info'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000012A0E3EDD00>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000012A10C00E90>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000012A10782050>
    │    │            └ <Window(<State 'AdminOffers:show_offer_info'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_channel_theme': 'news', 'selected_offer': -1001812565202}, 'middleware_data': {'...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offer_info at 0x0000012A105662A0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000012A10782050>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 24, in get_offer_info
    'offer_id': offer_info.id,
                └ None

AttributeError: 'NoneType' object has no attribute 'id'
2024-03-01T15:37:22.009525+0200 INFO Bot stopped!
2024-03-01T15:37:25.788972+0200 INFO Bot started!
2024-03-01T15:37:27.723680+0200 INFO ::1 [01/Mar/2024:15:37:27 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:37:27.876089+0200 INFO Update id=925012217 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T15:37:29.302279+0200 INFO ::1 [01/Mar/2024:15:37:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:37:29.453417+0200 INFO Update id=925012218 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:37:30.170581+0200 INFO ::1 [01/Mar/2024:15:37:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:37:30.176240+0200 ERROR Cannot get window data for state <State 'AdminOffers:show_offer_info'>
2024-03-01T15:37:30.177239+0200 INFO Update id=925012219 is not handled. Duration 15 ms by bot id=5646878393
2024-03-01T15:37:30.182242+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'NoneType' object has no attribute 'id'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000025E98D8F190>
                   │    │          │                   │           └ {'update_id': 925012219, 'callback_query': {'id': '1663765557187831158', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000025E98C2A6D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000025E95051C60>
                   │    └ <Dispatcher '0x25e98f9a110'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000025E98D8F190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000025E98C2A6D0>
                 │    └ <function Dispatcher.feed_update at 0x0000025E95051BC0>
                 └ <Dispatcher '0x25e98f9a110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025E95050400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025E98D8E8D0>
                     └ <Dispatcher '0x25e98f9a110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000025E98D789D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000025E98FA8810>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000025E998498C0>
          │    │   │      │    └ AttributeError("'NoneType' object has no attribute 'id'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000025E9946E2F0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000025E99509B90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000025E98FA8E50>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000025E98F70680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000025E98FB4050>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000025E98FA8F50>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012219, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000025E993E8A40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x25e98f9a110'>>, Update(update_id=925012219, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000025E950511C0>
                 └ <Dispatcher '0x25e98f9a110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000025E996E4CC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025E95050400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025E98F9A950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000025E95051260>
                 └ <Dispatcher '0x25e98f9a110'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000025E950511C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000025E996E49A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025E95050400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025E98FA9F90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000025E993F0890>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000025E996E4D60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000025E95051260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000025E950511C0>
                     └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000025E996E7C40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025E95050400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025E98FEC190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000025E95051260>
                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x0000025E95050540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025E98FEC190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000025E98FB4090>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000025E98FA8F50>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000025E993F0650>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x0000025E96C09B20>, <function CallableObject.call at 0x0000025E996E4...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x25e98f9a110'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000025E996E4860>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>>, CallbackQuery(...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
          │      │                │                 └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
          │      │                └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x0000025E96C545E0>
          └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
          │    │        │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x0000025E96A418A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000025E98FE71D0>
          └ <Window(<State 'ChannelPosterAdminMenu:select_channel'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x0000025E96BC8A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x0000025E98FE71D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
             │ │                └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x0000025E96A418A0>
             └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x0000025E98FE6F50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
                 │    │                       │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x0000025E96BC8A40>
                 └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x0000025E98FE6F50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
             │ │                │         └ <Dialog(<StatesGroup 'ChannelPosterAdminMenu'>)>
             │ │                └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x0000025E96A418A0>
             └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000025E98FE6F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 73, in process_callback
    return await self._process_item_callback(
                 │    └ <function Select._process_item_callback at 0x0000025E96BE89A0>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000025E98FE6F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 119, in _process_item_callback
    await self.on_click.process_event(
          │    │        └ <function SimpleEventProcessor.process_event at 0x0000025E96A239C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000025E98FE6FD0>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000025E98FE6F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ('-1001812565202',)
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
          │    │        │      └ <aiogram_dialog.widgets.kbd.select.Select object at 0x0000025E98FE6F10>
          │    │        └ CallbackQuery(id='1663765557187831158', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_select_offer at 0x0000025E98D42D40>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x0000025E98FE6FD0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\selected.py", line 18, in on_select_offer
    await manager.start(states.AdminOffers.show_offer_info, data=manager.dialog_data)
          │       │     │      │           │                     │       └ <property object at 0x0000025E96C3EE80>
          │       │     │      │           │                     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
          │       │     │      │           └ <State 'AdminOffers:show_offer_info'>
          │       │     │      └ <class 'bot.dialogs.channel_admin_menu.states.AdminOffers'>
          │       │     └ <module 'bot.dialogs.channel_admin_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\channel_admin_menu\\states....
          │       └ <function ManagerImpl.start at 0x0000025E96C41620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ {'selected_channel_theme': 'news', 'selected_offer': -1001812565202, 'selected_offer_id': -1001812565202}
          │    │             └ <State 'AdminOffers:show_offer_info'>
          │    └ <function ManagerImpl._start_normal at 0x0000025E96C41800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x0000025E96C41BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
                        │    └ <function ManagerImpl.dialog at 0x0000025E96C40F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x0000025E96C54680>
                        └ <Window(<State 'AdminOffers:show_offer_info'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x0000025E96C544A0>
                         └ <Window(<State 'AdminOffers:show_offer_info'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000025E96C3DCB0>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000025E993F14D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000025E98FD68D0>
    │    │            └ <Window(<State 'AdminOffers:show_offer_info'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_channel_theme': 'news', 'selected_offer': -1001812565202, 'selected_offer_id': -...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offer_info at 0x0000025E98DAE2A0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000025E98FD68D0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 24, in get_offer_info
    'offer_id': offer_info.id,
                └ None

AttributeError: 'NoneType' object has no attribute 'id'
2024-03-01T15:38:02.803329+0200 INFO ::1 [01/Mar/2024:15:38:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:38:03.080355+0200 INFO Update id=925012220 is handled. Duration 282 ms by bot id=5646878393
2024-03-01T15:38:04.191010+0200 INFO ::1 [01/Mar/2024:15:38:04 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:38:04.391287+0200 INFO Update id=925012221 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:38:05.143518+0200 INFO ::1 [01/Mar/2024:15:38:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:38:05.343168+0200 INFO Update id=925012222 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:38:37.180398+0200 INFO Bot stopped!
2024-03-01T15:38:40.784570+0200 INFO Bot started!
2024-03-01T15:38:41.646082+0200 INFO ::1 [01/Mar/2024:15:38:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:38:41.846298+0200 INFO Update id=925012223 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T15:38:42.814303+0200 INFO ::1 [01/Mar/2024:15:38:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:38:43.008486+0200 INFO Update id=925012224 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:39:24.855523+0200 INFO Bot stopped!
2024-03-01T15:39:28.367376+0200 INFO Bot started!
2024-03-01T15:39:29.254879+0200 INFO ::1 [01/Mar/2024:15:39:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:29.259493+0200 ERROR Cannot get window data for state <State 'AdminOffers:select_offer'>
2024-03-01T15:39:29.261492+0200 INFO Update id=925012225 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T15:39:29.265489+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('selected_offer_status')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
                   │    │          │                   │           └ {'update_id': 925012225, 'callback_query': {'id': '1663765556114487450', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001802B7B1C60>
                   │    └ <Dispatcher '0x1802f6f9e50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                 │    └ <function Dispatcher.feed_update at 0x000001802B7B1BC0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F704110>
                     └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001802F4BC690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001802F704450>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001802FC5EF40>
          │    │   │      │    └ KeyError('selected_offer_status')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001802FBC5F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001802FC74DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001802F4EF350>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001802FE40040>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F707D90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012225, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001802FE40C20>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1802f6f9e50'>>, Update(update_id=925012225, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001802B7B11C0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE40900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F6FA610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE409A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F705C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001802FB3FED0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE40B80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE407C0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001802B7B0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F4DAD10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001802FB3FC90>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001802D369B20>, <function CallableObject.call at 0x000001802FE40...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765556114487450', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001802FE40CC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'AdminOffers'>)>>, CallbackQuery(id='1663765...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001802D3A1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
                        │    └ <function ManagerImpl.dialog at 0x000001802D3A0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x000001802D3B4680>
                        └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x000001802D3B44A0>
                         └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001802D39DD50>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>
    │    │            └ <Window(<State 'AdminOffers:select_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_channel_theme': 'news', 'selected_offer_id': 13}, 'middleware_data': {'dp': <Dis...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_admin_offers at 0x000001802F516160>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 11, in get_admin_offers
    admin_offers = await repo.offer_repo.get_offers(status=dialog_manager.start_data['selected_offer_status'])
                         │    │          │                 │              └ <property object at 0x000001802D39EF70>
                         │    │          │                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001802FC691D0>
                         │    │          └ <function OfferRequestsRepo.get_offers at 0x000001802F402E80>
                         │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x000001802FC69310>
                         └ <bot.db.Repo object at 0x000001802FC69450>

KeyError: 'selected_offer_status'
2024-03-01T15:39:40.891774+0200 INFO ::1 [01/Mar/2024:15:39:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:41.214565+0200 INFO Update id=925012226 is handled. Duration 313 ms by bot id=5646878393
2024-03-01T15:39:41.840401+0200 INFO ::1 [01/Mar/2024:15:39:41 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:42.114099+0200 INFO Update id=925012227 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T15:39:42.789772+0200 INFO ::1 [01/Mar/2024:15:39:42 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:43.016458+0200 INFO Update id=925012228 is handled. Duration 217 ms by bot id=5646878393
2024-03-01T15:39:43.943114+0200 INFO ::1 [01/Mar/2024:15:39:43 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:44.182454+0200 INFO Update id=925012229 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:39:44.717937+0200 INFO ::1 [01/Mar/2024:15:39:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:45.025229+0200 INFO Update id=925012230 is handled. Duration 311 ms by bot id=5646878393
2024-03-01T15:39:45.783069+0200 INFO ::1 [01/Mar/2024:15:39:45 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:46.080065+0200 INFO Update id=925012231 is handled. Duration 297 ms by bot id=5646878393
2024-03-01T15:39:46.964326+0200 INFO ::1 [01/Mar/2024:15:39:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:39:46.966482+0200 ERROR Cannot get window data for state <State 'AdminOffers:select_offer'>
2024-03-01T15:39:46.967482+0200 INFO Update id=925012232 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T15:39:46.969483+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-52' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('selected_offer_status')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
                   │    │          │                   │           └ {'update_id': 925012232, 'callback_query': {'id': '1663765558536723566', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001802B7B1C60>
                   │    └ <Dispatcher '0x1802f6f9e50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                 │    └ <function Dispatcher.feed_update at 0x000001802B7B1BC0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F704110>
                     └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001802F4BC690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001802F704450>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000180300D96C0>
          │    │   │      │    └ KeyError('selected_offer_status')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001802FBC6020>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000180300B4590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001802F4EF350>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001802FE40860>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F707D90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012232, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001802FED6700>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1802f6f9e50'>>, Update(update_id=925012232, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001802B7B11C0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE40AE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F6FA610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE43380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F705C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001802FB3FED0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE40540>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE43240>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001802B7B0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F4DAD10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001802FB3FC90>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001802D369B20>, <function CallableObject.call at 0x000001802FE43...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558536723566', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001802FE434C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'AdminOffers'>)>>, CallbackQuery(id='1663765...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001802D3A1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
                        │    └ <function ManagerImpl.dialog at 0x000001802D3A0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x000001802D3B4680>
                        └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x000001802D3B44A0>
                         └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001802D39DD50>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>
    │    │            └ <Window(<State 'AdminOffers:select_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_channel_theme': 'news', 'selected_offer_id': 13}, 'middleware_data': {'dp': <Dis...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_admin_offers at 0x000001802F516160>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 11, in get_admin_offers
    admin_offers = await repo.offer_repo.get_offers(status=dialog_manager.start_data['selected_offer_status'])
                         │    │          │                 │              └ <property object at 0x000001802D39EF70>
                         │    │          │                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300CE590>
                         │    │          └ <function OfferRequestsRepo.get_offers at 0x000001802F402E80>
                         │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x00000180300CED10>
                         └ <bot.db.Repo object at 0x00000180300CFB90>

KeyError: 'selected_offer_status'
2024-03-01T15:40:23.368221+0200 INFO ::1 [01/Mar/2024:15:40:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:40:23.370759+0200 ERROR Cannot get window data for state <State 'AdminOffers:select_offer'>
2024-03-01T15:40:23.372759+0200 INFO Update id=925012233 is not handled. Duration 0 ms by bot id=5646878393
2024-03-01T15:40:23.373761+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-56' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('selected_offer_status')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
                   │    │          │                   │           └ {'update_id': 925012233, 'callback_query': {'id': '1663765557414707163', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001802B7B1C60>
                   │    └ <Dispatcher '0x1802f6f9e50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001802FB3B210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001802F38A6D0>
                 │    └ <function Dispatcher.feed_update at 0x000001802B7B1BC0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F704110>
                     └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001802F4BC690>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001802F704450>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x00000180300F1100>
          │    │   │      │    └ KeyError('selected_offer_status')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001802FBC64D0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x00000180300E6490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001802F4EF350>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x00000180277DAC00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F707D90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012233, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001802FE43420>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1802f6f9e50'>>, Update(update_id=925012233, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001802B7B11C0>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FFFAC00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F6FA610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dispatcher '0x1802f6f9e50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FFFB880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F705C50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001802FB3FED0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FFF93A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001802B7B11C0>
                     └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001802FE43B00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001802B7B0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001802B7B1260>
                 └ <Dialog(<StatesGroup 'AdminOffers'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001802B7B0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001802F733010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001802F4DAD10>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001802F704D90>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001802FB3FC90>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001802D369B20>, <function CallableObject.call at 0x000001802FFFA...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1802f6f9e50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557414707163', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001802FFFAA20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'AdminOffers'>)>>, CallbackQuery(id='1663765...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001802D3A1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
                        │    └ <function ManagerImpl.dialog at 0x000001802D3A0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
                        │      │      └ <Dialog(<StatesGroup 'AdminOffers'>)>
                        │      └ <function Window.render at 0x000001802D3B4680>
                        └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
                         │    │         └ <Dialog(<StatesGroup 'AdminOffers'>)>
                         │    └ <function Window.load_data at 0x000001802D3B44A0>
                         └ <Window(<State 'AdminOffers:select_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001802D39DD50>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>
    │    │            └ <Window(<State 'AdminOffers:select_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {}, 'start_data': {'selected_channel_theme': 'news', 'selected_offer_id': 13}, 'middleware_data': {'dp': <Dis...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_admin_offers at 0x000001802F516160>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001802F731C90>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\channel_admin_menu\getters.py", line 11, in get_admin_offers
    admin_offers = await repo.offer_repo.get_offers(status=dialog_manager.start_data['selected_offer_status'])
                         │    │          │                 │              └ <property object at 0x000001802D39EF70>
                         │    │          │                 └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x00000180300F0510>
                         │    │          └ <function OfferRequestsRepo.get_offers at 0x000001802F402E80>
                         │    └ <bot.db.requests.offer_requests.OfferRequestsRepo object at 0x00000180300F0410>
                         └ <bot.db.Repo object at 0x00000180300F0350>

KeyError: 'selected_offer_status'
2024-03-01T15:40:24.156558+0200 INFO ::1 [01/Mar/2024:15:40:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:40:24.437785+0200 INFO Update id=925012234 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T15:40:25.403526+0200 INFO ::1 [01/Mar/2024:15:40:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:40:25.595453+0200 INFO Update id=925012235 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T15:40:26.621609+0200 INFO ::1 [01/Mar/2024:15:40:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:40:26.904049+0200 INFO Update id=925012236 is handled. Duration 280 ms by bot id=5646878393
2024-03-01T15:40:44.838364+0200 INFO ::1 [01/Mar/2024:15:40:44 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:40:45.375099+0200 INFO Update id=925012237 is handled. Duration 531 ms by bot id=5646878393
2024-03-01T15:41:01.098182+0200 INFO ::1 [01/Mar/2024:15:41:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:41:01.312211+0200 INFO Update id=925012238 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T15:42:47.274926+0200 INFO Bot stopped!
2024-03-01T15:42:50.978397+0200 INFO Bot started!
2024-03-01T15:42:51.886960+0200 INFO ::1 [01/Mar/2024:15:42:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:42:52.142302+0200 INFO Update id=925012239 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T15:43:47.106344+0200 INFO Bot stopped!
2024-03-01T15:43:50.718220+0200 INFO Bot started!
2024-03-01T15:43:51.074983+0200 INFO ::1 [01/Mar/2024:15:43:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:43:51.301814+0200 INFO Update id=925012240 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:44:08.611329+0200 INFO Bot stopped!
2024-03-01T15:44:12.035748+0200 INFO Bot started!
2024-03-01T15:44:12.943404+0200 INFO ::1 [01/Mar/2024:15:44:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:13.081119+0200 INFO Update id=925012241 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:44:14.330594+0200 INFO ::1 [01/Mar/2024:15:44:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:14.495535+0200 INFO Update id=925012242 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T15:44:15.411328+0200 INFO ::1 [01/Mar/2024:15:44:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:15.536190+0200 INFO Update id=925012243 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:16.522594+0200 INFO ::1 [01/Mar/2024:15:44:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:16.646546+0200 INFO Update id=925012244 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:17.573650+0200 INFO ::1 [01/Mar/2024:15:44:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:17.701560+0200 INFO Update id=925012245 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:18.934716+0200 INFO ::1 [01/Mar/2024:15:44:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:19.530155+0200 INFO Update id=925012246 is handled. Duration 593 ms by bot id=5646878393
2024-03-01T15:44:20.059823+0200 INFO ::1 [01/Mar/2024:15:44:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:20.192081+0200 INFO Update id=925012247 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:44:21.244223+0200 INFO ::1 [01/Mar/2024:15:44:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:21.435988+0200 INFO Update id=925012248 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:44:21.999452+0200 INFO ::1 [01/Mar/2024:15:44:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:22.118082+0200 INFO Update id=925012249 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:23.663240+0200 INFO ::1 [01/Mar/2024:15:44:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:23.778778+0200 INFO Update id=925012250 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T15:44:26.006969+0200 INFO ::1 [01/Mar/2024:15:44:26 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:26.149085+0200 INFO Update id=925012251 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:44:29.291132+0200 INFO ::1 [01/Mar/2024:15:44:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:29.476603+0200 INFO Update id=925012252 is handled. Duration 187 ms by bot id=5646878393
2024-03-01T15:44:30.332947+0200 INFO ::1 [01/Mar/2024:15:44:30 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:30.465588+0200 INFO Update id=925012253 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:31.662178+0200 INFO ::1 [01/Mar/2024:15:44:31 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:31.817697+0200 INFO Update id=925012254 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T15:44:32.501424+0200 INFO ::1 [01/Mar/2024:15:44:32 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:32.619972+0200 INFO Update id=925012255 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T15:44:33.034947+0200 INFO ::1 [01/Mar/2024:15:44:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:33.180632+0200 INFO Update id=925012256 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T15:44:33.674307+0200 INFO ::1 [01/Mar/2024:15:44:33 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:33.930348+0200 INFO Update id=925012257 is handled. Duration 250 ms by bot id=5646878393
2024-03-01T15:44:36.165445+0200 INFO ::1 [01/Mar/2024:15:44:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:36.378388+0200 INFO Update id=925012258 is handled. Duration 217 ms by bot id=5646878393
2024-03-01T15:44:40.890181+0200 INFO ::1 [01/Mar/2024:15:44:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:41.216406+0200 INFO Update id=925012259 is handled. Duration 329 ms by bot id=5646878393
2024-03-01T15:44:46.742595+0200 INFO ::1 [01/Mar/2024:15:44:46 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:46.977808+0200 INFO Update id=925012260 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:44:49.829629+0200 INFO ::1 [01/Mar/2024:15:44:49 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:50.208607+0200 INFO Update id=925012261 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T15:44:51.128332+0200 INFO ::1 [01/Mar/2024:15:44:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:51.250093+0200 INFO Update id=925012262 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T15:44:52.369150+0200 INFO ::1 [01/Mar/2024:15:44:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:52.484612+0200 INFO Update id=925012263 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T15:44:53.422714+0200 INFO ::1 [01/Mar/2024:15:44:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:53.571342+0200 INFO Update id=925012264 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T15:44:55.023876+0200 INFO ::1 [01/Mar/2024:15:44:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:55.159300+0200 INFO Update id=925012265 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:44:55.646086+0200 INFO ::1 [01/Mar/2024:15:44:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:55.826251+0200 INFO Update id=925012266 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T15:44:56.632236+0200 INFO ::1 [01/Mar/2024:15:44:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:56.753406+0200 INFO Update id=925012267 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:44:58.369390+0200 INFO ::1 [01/Mar/2024:15:44:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:44:58.600006+0200 INFO Update id=925012268 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:45:08.301257+0200 INFO ::1 [01/Mar/2024:15:45:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:45:08.429345+0200 INFO Update id=925012269 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:45:09.688506+0200 INFO ::1 [01/Mar/2024:15:45:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:45:09.818553+0200 INFO Update id=925012270 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:45:11.438460+0200 INFO ::1 [01/Mar/2024:15:45:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:45:11.558286+0200 INFO Update id=925012271 is handled. Duration 108 ms by bot id=5646878393
2024-03-01T15:45:15.307410+0200 INFO ::1 [01/Mar/2024:15:45:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:45:15.353562+0200 INFO Update id=925012272 is not handled. Duration 47 ms by bot id=5646878393
2024-03-01T15:45:15.359559+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-198' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B35BF7DC10>
                   │    │          │                   │           └ {'update_id': 925012272, 'callback_query': {'id': '1663765559021495339', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001B3580F1C60>
                   │    └ <Dispatcher '0x1b35bcb9650'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B35BF7DC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
                 │    └ <function Dispatcher.feed_update at 0x000001B3580F1BC0>
                 └ <Dispatcher '0x1b35bcb9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B3580F0400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B35BE1E910>
                     └ <Dispatcher '0x1b35bcb9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001B35BCBAC50>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001B35C034E10>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001B35C97A180>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001B35C4FA890>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001B35C928790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001B35BDDDE10>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001B35C772A20>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B35C040450>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B35C0354D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012272, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001B35C8A3B00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1b35bcb9650'>>, Update(update_id=925012272, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001B3580F11C0>
                 └ <Dispatcher '0x1b35bcb9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B35C8A3600>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B3580F0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B35C02AE10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B3580F1260>
                 └ <Dispatcher '0x1b35bcb9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B3580F11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B35C8CD3A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B3580F0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B35C036390>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001B35C4788D0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001B35C8CE5C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B3580F1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B3580F11C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B35C8CFCE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B3580F0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B35C434490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B3580F1260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001B3580F0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B35C434490>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B35C040490>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B35C0354D0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001B35C478750>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001B359C99B20>, <function CallableObject.call at 0x000001B35C8CE...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1b35bcb9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001B35C8CE520>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='1663765559...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000001B359CE45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000001B359AD18A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B35C42F450>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001B359C58A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B35C42F450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001B359AD18A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B35C42F250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000001B359C58A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B35C42F250>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000001B359AD18A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001B35C42ED10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000001B359AD2020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001B35C42ED10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001B35C42ED10>
          │    │        │             └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000001B359AB39C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001B35C42EED0>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001B35C42ED10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000001B35C42ED10>
          │    │        └ CallbackQuery(id='1663765559021495339', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_start_select_offer at 0x000001B35BE54360>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000001B35C42EED0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x000001B359CD1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x000001B359CD1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000001B359CD1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B35C97B650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
          │    └ <function MessageManager.edit_message_safe at 0x000001B359CD3380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001B35B0C5550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
                 │    └ <function MessageManager.edit_message at 0x000001B359CD3420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001B35B0C5550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
                 │    └ <function MessageManager.edit_text at 0x000001B359CD3560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000001B35B0C5550>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x000001B358230360>
                 └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001B35BE1F650>
                 └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x000001B35BF7DDD0>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x000001B3538B04A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x000001B3519436A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000001B35BE1F650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T15:46:35.252752+0200 INFO Bot stopped!
2024-03-01T15:46:38.805610+0200 INFO Bot started!
2024-03-01T15:46:40.242165+0200 INFO ::1 [01/Mar/2024:15:46:40 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:46:40.334136+0200 INFO Update id=925012273 is not handled. Duration 93 ms by bot id=5646878393
2024-03-01T15:46:40.340136+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-12' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=TelegramBadRequest('Telegram server says - Bad Request: message text is empty')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002B2BE16DC10>
                   │    │          │                   │           └ {'update_id': 925012273, 'callback_query': {'id': '1663765557625841632', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000002B2BA2CDC60>
                   │    └ <Dispatcher '0x2b2bdeaaad0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000002B2BE16DC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
                 │    └ <function Dispatcher.feed_update at 0x000002B2BA2CDBC0>
                 └ <Dispatcher '0x2b2bdeaaad0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002B2BA2CC400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002B2BE22C3D0>
                     └ <Dispatcher '0x2b2bdeaaad0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002B2BDFDC7D0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002B2BE22C710>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002B2BE6D14C0>
          │    │   │      │    └ TelegramBadRequest('Telegram server says - Bad Request: message text is empty')
          │    │   │      └ <class 'aiogram.exceptions.TelegramBadRequest'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002B2BE6E9F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002B2BE7C4DD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002B2BE00CA90>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000002B2BE960180>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002B2BDFF9B50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002B2BE22D0D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012273, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000002B2BE960D60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2b2bdeaaad0'>>, Update(update_id=925012273, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000002B2BA2CD1C0>
                 └ <Dispatcher '0x2b2bdeaaad0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002B2BE960A40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002B2BA2CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002B2BE21E910>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002B2BA2CD260>
                 └ <Dispatcher '0x2b2bdeaaad0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000002B2BA2CD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002B2BE960AE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002B2BA2CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002B2BE22DF50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002B2BE668B90>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002B2BE960CC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002B2BA2CD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000002B2BA2CD1C0>
                     └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002B2BE960900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002B2BA2CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002B2BE624990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002B2BA2CD260>
                 └ <Dialog(<StatesGroup 'MainMenu'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000002B2BA2CC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002B2BE624990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002B2BA6D1910>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002B2BE22D0D0>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002B2BE6689D0>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000002B2BBE89B20>, <function CallableObject.call at 0x000002B2BE960...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x2b2bdeaaad0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000002B2BE960E00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'MainMenu'>)>>, CallbackQuery(id='1663765557...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 145, in _callback_handler
    await window.process_callback(cleaned_callback, self, dialog_manager)
          │      │                │                 │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
          │      │                │                 └ <Dialog(<StatesGroup 'MainMenu'>)>
          │      │                └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │      └ <function Window.process_callback at 0x000002B2BBED45E0>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 100, in process_callback
    await self.keyboard.process_callback(callback, dialog, manager)
          │    │        │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
          │    │        │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
          │    │        │                └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function Keyboard.process_callback at 0x000002B2BBCC18A0>
          │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000002B2BE61F950>
          └ <Window(<State 'MainMenu:select_action'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000002B2BBE48A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000002B2BE61F950>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000002B2BBCC18A0>
             └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000002B2BE61F750>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 79, in process_callback
    return await self._process_other_callback(callback, dialog, manager)
                 │    │                       │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
                 │    │                       │         └ <Dialog(<StatesGroup 'MainMenu'>)>
                 │    │                       └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    └ <function Group._process_other_callback at 0x000002B2BBE48A40>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000002B2BE61F750>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 74, in _process_other_callback
    if await b.process_callback(callback, dialog, manager):
             │ │                │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
             │ │                │         └ <Dialog(<StatesGroup 'MainMenu'>)>
             │ │                └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
             │ └ <function Keyboard.process_callback at 0x000002B2BBCC18A0>
             └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000002B2BE61F210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 66, in process_callback
    return await self._process_own_callback(
                 │    └ <function Button._process_own_callback at 0x000002B2BBCC2020>
                 └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000002B2BE61F210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\button.py", line 36, in _process_own_callback
    await self.on_click.process_event(callback, self, manager)
          │    │        │             │         │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
          │    │        │             │         └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000002B2BE61F210>
          │    │        │             └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    │        └ <function SimpleEventProcessor.process_event at 0x000002B2BBCA39C0>
          │    └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000002B2BE61F3D0>
          └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000002B2BE61F210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\widget_event.py", line 34, in process_event
    await self.callback(event, source, manager, *args, **kwargs)
          │    │        │      │       │         │       └ {}
          │    │        │      │       │         └ ()
          │    │        │      │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
          │    │        │      └ <aiogram_dialog.widgets.kbd.button.Button object at 0x000002B2BE61F210>
          │    │        └ CallbackQuery(id='1663765557625841632', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
          │    └ <function on_start_select_offer at 0x000002B2BE034360>
          └ <aiogram_dialog.widgets.widget_event.SimpleEventProcessor object at 0x000002B2BE61F3D0>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\selected.py", line 17, in on_start_select_offer
    await dialog_manager.start(states.SelectWebMasterOffer.select_category)
          │              │     │      │                    └ <State 'SelectWebMasterOffer:select_category'>
          │              │     │      └ <class 'bot.dialogs.web_master_menu.states.SelectWebMasterOffer'>
          │              │     └ <module 'bot.dialogs.web_master_menu.states' from 'E:\\PythonProjects\\Arbitrix\\bot\\dialogs\\web_master_menu\\states.py'>
          │              └ <function ManagerImpl.start at 0x000002B2BBEC1620>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 207, in start
    await self._start_normal(state, data, access_settings)
          │    │             │      │     └ None
          │    │             │      └ None
          │    │             └ <State 'SelectWebMasterOffer:select_category'>
          │    └ <function ManagerImpl._start_normal at 0x000002B2BBEC1800>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 264, in _start_normal
    await self.show()
          │    └ <function ManagerImpl.show at 0x000002B2BBEC1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 333, in show
    sent_message = await self.message_manager.show_message(
                         └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002B2BE789890>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 186, in show_message
    await self.edit_message_safe(bot, new_message, old_message),
          │    │                 │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
          │    │                 └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
          │    └ <function MessageManager.edit_message_safe at 0x000002B2BBEC3380>
          └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000002B2BE00EA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 274, in edit_message_safe
    return await self.edit_message(bot, new_message, old_message)
                 │    │            │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │            └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
                 │    └ <function MessageManager.edit_message at 0x000002B2BBEC3420>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000002B2BE00EA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 294, in edit_message
    return await self.edit_text(bot, new_message, old_message)
                 │    │         │    │            └ OldMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         │    └ NewMessage(chat=Chat(id=387375605, type='private', title=None, username='s0larm0v3', first_name='Solarmove', last_name=None, ...
                 │    │         └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
                 │    └ <function MessageManager.edit_text at 0x000002B2BBEC3560>
                 └ <aiogram_dialog.manager.message_manager.MessageManager object at 0x000002B2BE00EA50>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\message_manager.py", line 312, in edit_text
    return await bot.edit_message_text(
                 │   └ <function Bot.edit_message_text at 0x000002B2BA540360>
                 └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 1543, in edit_message_text
    return await self(call, request_timeout=request_timeout)
                 │    │                     └ None
                 │    └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\bot.py", line 492, in __call__
    return await self.session(self, method, timeout=request_timeout)
                 │    │       │     │               └ None
                 │    │       │     └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
                 │    │       └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
                 │    └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000002B2BA6D0790>
                 └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
           │    │                   │          │    └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
           │    │                   │          └ <aiogram.client.bot.Bot object at 0x000002B2BDFDE410>
           │    │                   └ functools.partial(<bound method AiohttpSession.make_request of <aiogram.client.session.aiohttp.AiohttpSession object at 0x000...
           │    └ ~TelegramType
           └ <function cast at 0x000002B2B5AB04A0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 178, in make_request
    response = self.check_response(
               │    └ <function BaseSession.check_response at 0x000002B2B3B436A0>
               └ <aiogram.client.session.aiohttp.AiohttpSession object at 0x000002B2BA6D0790>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
          │                         │               └ 'Bad Request: message text is empty'
          │                         └ EditMessageText(text='', chat_id=387375605, message_id=62644, inline_message_id=None, parse_mode=<Default('parse_mode')>, ent...
          └ <class 'aiogram.exceptions.TelegramBadRequest'>

aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message text is empty
2024-03-01T15:47:39.955747+0200 INFO Bot stopped!
2024-03-01T15:47:43.603766+0200 INFO Bot started!
2024-03-01T15:47:47.901972+0200 INFO ::1 [01/Mar/2024:15:47:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:47:48.084134+0200 INFO Update id=925012274 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:50:56.931029+0200 INFO ::1 [01/Mar/2024:15:50:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:50:57.434470+0200 INFO Update id=925012275 is handled. Duration 500 ms by bot id=5646878393
2024-03-01T15:50:57.898294+0200 INFO ::1 [01/Mar/2024:15:50:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:50:58.135524+0200 INFO Update id=925012276 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T15:51:00.392012+0200 INFO ::1 [01/Mar/2024:15:51:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:00.572970+0200 INFO Update id=925012277 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T15:51:01.470413+0200 INFO ::1 [01/Mar/2024:15:51:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:01.760723+0200 INFO Update id=925012278 is handled. Duration 280 ms by bot id=5646878393
2024-03-01T15:51:02.799348+0200 INFO ::1 [01/Mar/2024:15:51:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:03.066021+0200 INFO Update id=925012279 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T15:51:03.606939+0200 INFO ::1 [01/Mar/2024:15:51:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:03.909045+0200 INFO Update id=925012280 is handled. Duration 312 ms by bot id=5646878393
2024-03-01T15:51:04.388101+0200 INFO ::1 [01/Mar/2024:15:51:04 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:04.729945+0200 INFO Update id=925012281 is handled. Duration 344 ms by bot id=5646878393
2024-03-01T15:51:05.146592+0200 INFO ::1 [01/Mar/2024:15:51:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:05.355669+0200 INFO Update id=925012282 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T15:51:46.094508+0200 INFO Bot stopped!
2024-03-01T15:51:49.611401+0200 INFO Bot started!
2024-03-01T15:51:52.260730+0200 INFO ::1 [01/Mar/2024:15:51:52 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:52.643623+0200 INFO Update id=925012283 is handled. Duration 391 ms by bot id=5646878393
2024-03-01T15:51:55.059303+0200 INFO ::1 [01/Mar/2024:15:51:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:55.180435+0200 INFO Update id=925012284 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:51:55.794218+0200 INFO ::1 [01/Mar/2024:15:51:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:55.919818+0200 INFO Update id=925012285 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:51:57.274653+0200 INFO ::1 [01/Mar/2024:15:51:57 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:57.467123+0200 INFO Update id=925012286 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:51:58.332623+0200 INFO ::1 [01/Mar/2024:15:51:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:58.467817+0200 INFO Update id=925012287 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:51:58.847419+0200 INFO ::1 [01/Mar/2024:15:51:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:59.009267+0200 INFO Update id=925012288 is handled. Duration 155 ms by bot id=5646878393
2024-03-01T15:51:59.343971+0200 INFO ::1 [01/Mar/2024:15:51:59 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:51:59.797345+0200 INFO Update id=925012289 is handled. Duration 452 ms by bot id=5646878393
2024-03-01T15:52:00.561580+0200 INFO ::1 [01/Mar/2024:15:52:00 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:00.969353+0200 INFO Update id=925012290 is handled. Duration 407 ms by bot id=5646878393
2024-03-01T15:52:01.691970+0200 INFO ::1 [01/Mar/2024:15:52:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:01.839958+0200 INFO Update id=925012291 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T15:52:05.542616+0200 INFO ::1 [01/Mar/2024:15:52:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:05.680737+0200 INFO Update id=925012292 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T15:52:07.032019+0200 INFO ::1 [01/Mar/2024:15:52:07 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:07.184522+0200 INFO Update id=925012293 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T15:52:30.243874+0200 INFO Bot stopped!
2024-03-01T15:52:33.968685+0200 INFO Bot started!
2024-03-01T15:52:34.768606+0200 INFO ::1 [01/Mar/2024:15:52:34 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:34.956070+0200 INFO Update id=925012294 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T15:52:36.359933+0200 INFO ::1 [01/Mar/2024:15:52:36 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:36.571301+0200 INFO Update id=925012295 is handled. Duration 202 ms by bot id=5646878393
2024-03-01T15:52:37.632991+0200 INFO ::1 [01/Mar/2024:15:52:37 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:52:37.994093+0200 ERROR Cannot get window data for state <State 'SelectWebMasterOffer:select_webmaster_offer'>
2024-03-01T15:52:37.996095+0200 INFO Update id=925012296 is not handled. Duration 360 ms by bot id=5646878393
2024-03-01T15:52:38.000091+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'str' object has no attribute 'value'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001DBFCB9C210>
                   │    │          │                   │           └ {'update_id': 925012296, 'callback_query': {'id': '1663765558953451033', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001DBFA98D8D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001DBF8E8DC60>
                   │    └ <Dispatcher '0x1dbfcbbba10'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001DBFCB9C210>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001DBFA98D8D0>
                 │    └ <function Dispatcher.feed_update at 0x000001DBF8E8DBC0>
                 └ <Dispatcher '0x1dbfcbbba10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001DBF8E8C400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001DBFCB9D1D0>
                     └ <Dispatcher '0x1dbfcbbba10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001DBFCDE4ED0>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001DBFCDE4D50>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001DBFD672980>
          │    │   │      │    └ AttributeError("'str' object has no attribute 'value'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001DBFD2A9F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001DBFD22FBD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001DBFCDE5550>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001DBFCDAC5E0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001DBFCDEC850>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001DBFCDE5810>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012296, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001DBFD520F40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1dbfcbbba10'>>, Update(update_id=925012296, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001DBF8E8D1C0>
                 └ <Dispatcher '0x1dbfcbbba10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001DBFD5223E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001DBF8E8C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001DBFCDDAF90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001DBF8E8D260>
                 └ <Dispatcher '0x1dbfcbbba10'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001DBF8E8D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001DBFD520A40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001DBF8E8C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001DBFCDE66D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001DBFD22CE90>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001DBFD522480>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001DBF8E8D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001DBF8E8D1C0>
                     └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001DBFD224F40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001DBF8E8C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001DBFD202D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001DBF8E8D260>
                 └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001DBF8E8C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001DBFD202D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001DBFCBB9250>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001DBFCDE5810>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001DBFCBCED10>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001DBFAA49B20>, <function CallableObject.call at 0x000001DBFD556...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1dbfcbbba10'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558953451033', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001DBFD556160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001DBFAA81BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
                        │    └ <function ManagerImpl.dialog at 0x000001DBFAA80F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
                        │      │      └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                        │      └ <function Window.render at 0x000001DBFAA94680>
                        └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
                         │    │         └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                         │    └ <function Window.load_data at 0x000001DBFAA944A0>
                         └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x000001DBFAA7DC60>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001DBFD290410>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001DBFD201390>
    │    │            └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offers at 0x000001DBFCBF51C0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x000001DBFD201390>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\getters.py", line 94, in get_offers
    'source': selected_target_source.value,
              └ 'Телеграм канал'

AttributeError: 'str' object has no attribute 'value'
2024-03-01T15:54:04.404431+0200 INFO Bot stopped!
2024-03-01T15:54:07.801717+0200 INFO Bot started!
2024-03-01T15:54:09.572740+0200 INFO ::1 [01/Mar/2024:15:54:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:54:09.758779+0200 INFO Update id=925012297 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:54:10.467128+0200 INFO ::1 [01/Mar/2024:15:54:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:54:10.614034+0200 INFO Update id=925012298 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T15:54:14.210483+0200 INFO ::1 [01/Mar/2024:15:54:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:54:14.336583+0200 INFO Update id=925012299 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:54:16.795956+0200 INFO ::1 [01/Mar/2024:15:54:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:54:16.922588+0200 INFO Update id=925012300 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:55:08.722572+0200 INFO Bot stopped!
2024-03-01T15:55:12.196950+0200 INFO Bot started!
2024-03-01T15:55:12.809309+0200 INFO ::1 [01/Mar/2024:15:55:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:55:13.221689+0200 INFO Update id=925012301 is handled. Duration 422 ms by bot id=5646878393
2024-03-01T15:55:13.695076+0200 INFO ::1 [01/Mar/2024:15:55:13 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:55:13.849216+0200 INFO Update id=925012302 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T15:55:15.324318+0200 INFO ::1 [01/Mar/2024:15:55:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:55:15.333497+0200 ERROR Cannot get window data for state <State 'SelectWebMasterOffer:select_webmaster_offer'>
2024-03-01T15:55:15.335495+0200 INFO Update id=925012303 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T15:55:15.340043+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=AttributeError("'str' object has no attribute 'value'")>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000018FD9CB8F10>
                   │    │          │                   │           └ {'update_id': 925012303, 'callback_query': {'id': '1663765557652907444', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x0000018FD7451D90>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x0000018FD5FA1C60>
                   │    └ <Dispatcher '0x18fd9cc9650'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000018FD9CB8F10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x0000018FD7451D90>
                 │    └ <function Dispatcher.feed_update at 0x0000018FD5FA1BC0>
                 └ <Dispatcher '0x18fd9cc9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018FD5FA0400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018FD9CC8750>
                     └ <Dispatcher '0x18fd9cc9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000018FD9CE0C90>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000018FD9E1D010>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000018FDA780640>
          │    │   │      │    └ AttributeError("'str' object has no attribute 'value'")
          │    │   │      └ <class 'AttributeError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000018FDA3A9F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000018FDA696A10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x0000018FD9EE9210>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000018FD9EB0540>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000018FD9EEC510>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000018FD9EE9390>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012303, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000018FDA620D60>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x18fd9cc9650'>>, Update(update_id=925012303, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000018FD5FA11C0>
                 └ <Dispatcher '0x18fd9cc9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018FDA620CC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018FD5FA0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018FD9CCA850>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000018FD5FA1260>
                 └ <Dispatcher '0x18fd9cc9650'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000018FD5FA11C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018FDA6205E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018FD5FA0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018FD9EEA3D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000018FDA32CB90>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000018FDA620900>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000018FD5FA1260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000018FD5FA11C0>
                     └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018FDA622480>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000018FD5FA0400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018FDA2FEC90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000018FD5FA1260>
                 └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x0000018FD5FA0540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018FDA2FEC90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x0000018FD9CC8350>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000018FD9EE9390>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x0000018FD9B6B910>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x0000018FD7B49B20>, <function CallableObject.call at 0x0000018FDA620...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x18fd9cc9650'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557652907444', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000018FDA620E00>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x0000018FD7B81BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
                        │    └ <function ManagerImpl.dialog at 0x0000018FD7B80F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
                        │      │      └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                        │      └ <function Window.render at 0x0000018FD7B94680>
                        └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
                         │    │         └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                         │    └ <function Window.load_data at 0x0000018FD7B944A0>
                         └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x0000018FD7B7DD00>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018FDA448150>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000018FDA2FD210>
    │    │            └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'TG_CHANNEL', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'middlewa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offers at 0x0000018FD9CF5120>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000018FDA2FD210>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\getters.py", line 94, in get_offers
    'source': selected_target_source.value,
              └ 'TG_CHANNEL'

AttributeError: 'str' object has no attribute 'value'
2024-03-01T15:56:41.704688+0200 INFO Bot stopped!
2024-03-01T15:56:45.200952+0200 INFO Bot started!
2024-03-01T15:56:57.714429+0200 INFO Bot stopped!
2024-03-01T15:57:01.121438+0200 INFO Bot started!
2024-03-01T15:57:02.849811+0200 INFO ::1 [01/Mar/2024:15:57:02 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:57:03.017243+0200 INFO Update id=925012304 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T15:57:03.600911+0200 INFO ::1 [01/Mar/2024:15:57:03 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:57:03.719948+0200 INFO Update id=925012305 is handled. Duration 109 ms by bot id=5646878393
2024-03-01T15:57:05.633072+0200 INFO ::1 [01/Mar/2024:15:57:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:57:05.644331+0200 ERROR Cannot render window for state <State 'SelectWebMasterOffer:select_webmaster_offer'>
2024-03-01T15:57:05.645329+0200 INFO Update id=925012306 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T15:57:05.652332+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError(None)>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B71D103ED0>
                   │    │          │                   │           └ {'update_id': 925012306, 'callback_query': {'id': '1663765558527711750', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001B71D1B8710>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001B719341C60>
                   │    └ <Dispatcher '0x1b71d27a3d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001B71D103ED0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001B71D1B8710>
                 │    └ <function Dispatcher.feed_update at 0x000001B719341BC0>
                 └ <Dispatcher '0x1b71d27a3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B719340400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B71D0493D0>
                     └ <Dispatcher '0x1b71d27a3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001B71D284C10>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001B71D2849D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001B71DB23F40>
          │    │   │      │    └ KeyError(None)
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001B71D749F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001B71D2E34D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001B71D285190>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001B71D9BCA40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B71D28C490>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B71CF0A310>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012306, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001B71D250680>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1b71d27a3d0'>>, Update(update_id=925012306, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001B7193411C0>
                 └ <Dispatcher '0x1b71d27a3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B71D9BCF40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B719340400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B71D27AC10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B719341260>
                 └ <Dispatcher '0x1b71d27a3d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B7193411C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B71D9BD3A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B719340400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B71D286310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001B71D6CC350>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001B71D9BE480>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B719341260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B7193411C0>
                     └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B71D9BE3E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B719340400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B71D6A2510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B719341260>
                 └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001B719340540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B71D6A2510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001B71D28C4D0>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001B71CF0A310>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001B71CF0A110>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001B71AEE9B20>, <function CallableObject.call at 0x000001B71D9F6...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1b71d27a3d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558527711750', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001B71D9F6160>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001B71AF21BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                        │    └ <function ManagerImpl.dialog at 0x000001B71AF20F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                        │      │      └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                        │      └ <function Window.render at 0x000001B71AF34680>
                        └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 118, in render
    reply_markup=await self.render_kbd(current_data, manager),
                       │    │          │             └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                       │    │          └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                       │    └ <function Window.render_kbd at 0x000001B71AF34400>
                       └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 75, in render_kbd
    keyboard = await self.keyboard.render_keyboard(data, manager)
                     │    │        │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                     │    │        │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                     │    │        └ <function Keyboard.render_keyboard at 0x000001B71AD21580>
                     │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B71D6A0990>
                     └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function Group._render_keyboard at 0x000001B71AEA8900>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001B71D6A0990>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                  │ │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                  │ └ <function Keyboard.render_keyboard at 0x000001B71AD21580>
                  └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001B71D6A0710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function ScrollingGroup._render_keyboard at 0x000001B71AEC80E0>
                 └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001B71D6A0710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 101, in _render_keyboard
    keyboard = await self._render_contents(data, manager)
                     │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                     │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                     │    └ <function ScrollingGroup._render_contents at 0x000001B71AEABEC0>
                     └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001B71D6A0710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 43, in _render_contents
    return await super()._render_keyboard(data, manager)
                                          │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                                          └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                  │ │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                  │ └ <function Keyboard.render_keyboard at 0x000001B71AD21580>
                  └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B71D6A06D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function Select._render_keyboard at 0x000001B71AEC87C0>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B71D6A06D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 85, in _render_keyboard
    [
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 86, in <listcomp>
    await self._render_button(pos, item, item, data, manager)
          │    │              │    │     │     │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
          │    │              │    │     │     └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
          │    │              │    │     └ (13, 'Test #1 - 2.0')
          │    │              │    └ (13, 'Test #1 - 2.0')
          │    │              └ 0
          │    └ <function Select._render_button at 0x000001B71AEC8900>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B71D6A06D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 108, in _render_button
    text=await self.text.render_text(data, manager),
               │    │    │           │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
               │    │    │           └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
               │    │    └ <function Text.render_text at 0x000001B71AD22660>
               │    └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001B71D6A0650>
               └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001B71D6A06D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\text\base.py", line 26, in render_text
    return await self._render_text(data, manager)
                 │    │            │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                 │    │            └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
                 │    └ <function Case._render_text at 0x000001B71AE7B1A0>
                 └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001B71D6A0650>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\text\multi.py", line 54, in _render_text
    return await self.texts[selection].render_text(data, manager)
                 │    │     │                      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001B71D7E88D0>
                 │    │     │                      └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
                 │    │     └ None
                 │    └ {<OfferStatus.ACTIVE: 'active'>: <aiogram_dialog.widgets.text.format.Format object at 0x000001B71D6A05D0>, <OfferStatus.COMPL...
                 └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001B71D6A0650>

KeyError: None
2024-03-01T15:58:14.795141+0200 INFO Bot stopped!
2024-03-01T15:58:18.403539+0200 INFO Bot started!
2024-03-01T15:58:19.332849+0200 INFO ::1 [01/Mar/2024:15:58:19 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:58:19.616898+0200 INFO Update id=925012307 is handled. Duration 281 ms by bot id=5646878393
2024-03-01T15:58:20.599703+0200 INFO ::1 [01/Mar/2024:15:58:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:58:20.728090+0200 INFO Update id=925012308 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T15:58:21.458419+0200 INFO ::1 [01/Mar/2024:15:58:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:58:21.650146+0200 INFO Update id=925012309 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T15:58:22.032517+0200 INFO ::1 [01/Mar/2024:15:58:22 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:58:22.306802+0200 INFO Update id=925012310 is handled. Duration 265 ms by bot id=5646878393
2024-03-01T15:58:23.052105+0200 INFO ::1 [01/Mar/2024:15:58:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T15:58:23.064555+0200 ERROR Cannot render window for state <State 'SelectWebMasterOffer:select_webmaster_offer'>
2024-03-01T15:58:23.065556+0200 INFO Update id=925012311 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T15:58:23.070555+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-36' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError(None)>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E20CFE9310>
                   │    │          │                   │           └ {'update_id': 925012311, 'callback_query': {'id': '1663765557833950166', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x000001E20D133950>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001E2092CDC60>
                   │    └ <Dispatcher '0x1e20d218f50'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x000001E20CFE9310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x000001E20D133950>
                 │    └ <function Dispatcher.feed_update at 0x000001E2092CDBC0>
                 └ <Dispatcher '0x1e20d218f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2092CC400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E20CFDD1D0>
                     └ <Dispatcher '0x1e20d218f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001E20D21B810>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001E20D21B4D0>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000001E20DAD0880>
          │    │   │      │    └ KeyError(None)
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000001E20D6E9F30>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000001E20D98FCD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001E20D21BCD0>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001E20D960EA0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E20D22AF50>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E20D21BF90>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012311, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001E20D9609A0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1e20d218f50'>>, Update(update_id=925012311, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001E2092CD1C0>
                 └ <Dispatcher '0x1e20d218f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E20D960B80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2092CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E20D2197D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2092CD260>
                 └ <Dispatcher '0x1e20d218f50'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001E2092CD1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E20D960A40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2092CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E20D228E90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000001E20D663D10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000001E20D960D60>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2092CD260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001E2092CD1C0>
                     └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001E20D960C20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001E2092CC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E20D641C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001E2092CD260>
                 └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001E2092CC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001E20D641C90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001E20D22AF90>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000001E20D21BF90>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000001E20D663B50>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x000001E20AE89B20>, <function CallableObject.call at 0x000001E20D991...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1e20d218f50'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765557833950166', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x000001E20D991080>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x000001E20AEC1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                        │    └ <function ManagerImpl.dialog at 0x000001E20AEC0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                        │      │      └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                        │      └ <function Window.render at 0x000001E20AED4680>
                        └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 118, in render
    reply_markup=await self.render_kbd(current_data, manager),
                       │    │          │             └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                       │    │          └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                       │    └ <function Window.render_kbd at 0x000001E20AED4400>
                       └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 75, in render_kbd
    keyboard = await self.keyboard.render_keyboard(data, manager)
                     │    │        │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                     │    │        │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                     │    │        └ <function Keyboard.render_keyboard at 0x000001E20ACC1580>
                     │    └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E20D640090>
                     └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function Group._render_keyboard at 0x000001E20AE48900>
                 └ <aiogram_dialog.widgets.kbd.group.Group object at 0x000001E20D640090>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                  │ │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                  │ └ <function Keyboard.render_keyboard at 0x000001E20ACC1580>
                  └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001E20D63BDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function ScrollingGroup._render_keyboard at 0x000001E20AE680E0>
                 └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001E20D63BDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 101, in _render_keyboard
    keyboard = await self._render_contents(data, manager)
                     │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                     │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                     │    └ <function ScrollingGroup._render_contents at 0x000001E20AE4BEC0>
                     └ <aiogram_dialog.widgets.kbd.scrolling_group.ScrollingGroup object at 0x000001E20D63BDD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\scrolling_group.py", line 43, in _render_contents
    return await super()._render_keyboard(data, manager)
                                          │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                                          └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\group.py", line 41, in _render_keyboard
    b_kbd = await b.render_keyboard(data, manager)
                  │ │               │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                  │ │               └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                  │ └ <function Keyboard.render_keyboard at 0x000001E20ACC1580>
                  └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001E20D63BD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\base.py", line 31, in render_keyboard
    return await self._render_keyboard(data, manager)
                 │    │                │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                 │    │                └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
                 │    └ <function Select._render_keyboard at 0x000001E20AE687C0>
                 └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001E20D63BD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 85, in _render_keyboard
    [
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 86, in <listcomp>
    await self._render_button(pos, item, item, data, manager)
          │    │              │    │     │     │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
          │    │              │    │     │     └ {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': None, 'midd...
          │    │              │    │     └ (13, 'Test #1 - 2.0')
          │    │              │    └ (13, 'Test #1 - 2.0')
          │    │              └ 0
          │    └ <function Select._render_button at 0x000001E20AE68900>
          └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001E20D63BD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\kbd\select.py", line 108, in _render_button
    text=await self.text.render_text(data, manager),
               │    │    │           │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
               │    │    │           └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
               │    │    └ <function Text.render_text at 0x000001E20ACC2660>
               │    └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001E20D63BD10>
               └ <aiogram_dialog.widgets.kbd.select.Select object at 0x000001E20D63BD90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\text\base.py", line 26, in render_text
    return await self._render_text(data, manager)
                 │    │            │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                 │    │            └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
                 │    └ <function Case._render_text at 0x000001E20AE1B1A0>
                 └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001E20D63BD10>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\text\multi.py", line 54, in _render_text
    return await self.texts[selection].render_text(data, manager)
                 │    │     │                      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000001E20DAB67D0>
                 │    │     │                      └ {'data': {'dialog_data': {'selected_target_source': 'Телеграм канал', 'selected_traffic_source': 'Tik-Tok'}, 'start_data': No...
                 │    │     └ None
                 │    └ {<OfferStatus.ACTIVE: 'active'>: <aiogram_dialog.widgets.text.format.Format object at 0x000001E20D63BC90>, <OfferStatus.COMPL...
                 └ <aiogram_dialog.widgets.text.multi.Case object at 0x000001E20D63BD10>

KeyError: None
2024-03-01T16:00:10.837068+0200 INFO Bot stopped!
2024-03-01T16:00:14.329502+0200 INFO Bot started!
2024-03-01T16:00:16.033806+0200 INFO ::1 [01/Mar/2024:16:00:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:16.215524+0200 INFO Update id=925012312 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T16:00:17.808762+0200 INFO ::1 [01/Mar/2024:16:00:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:17.987699+0200 INFO Update id=925012313 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T16:00:18.709752+0200 INFO ::1 [01/Mar/2024:16:00:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:18.857605+0200 INFO Update id=925012314 is handled. Duration 140 ms by bot id=5646878393
2024-03-01T16:00:20.813090+0200 INFO ::1 [01/Mar/2024:16:00:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:20.941758+0200 INFO Update id=925012315 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T16:00:23.160696+0200 INFO ::1 [01/Mar/2024:16:00:23 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:23.361262+0200 INFO Update id=925012316 is handled. Duration 203 ms by bot id=5646878393
2024-03-01T16:00:52.981347+0200 INFO Bot stopped!
2024-03-01T16:00:56.534184+0200 INFO Bot started!
2024-03-01T16:00:58.959107+0200 INFO ::1 [01/Mar/2024:16:00:58 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:00:59.155944+0200 INFO Update id=925012317 is handled. Duration 186 ms by bot id=5646878393
2024-03-01T16:01:01.030971+0200 INFO ::1 [01/Mar/2024:16:01:01 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:01:01.387794+0200 INFO Update id=925012318 is handled. Duration 358 ms by bot id=5646878393
2024-03-01T16:01:14.362716+0200 INFO Bot stopped!
2024-03-01T16:01:17.672258+0200 INFO Bot started!
2024-03-01T16:01:18.579955+0200 INFO ::1 [01/Mar/2024:16:01:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:01:18.763170+0200 INFO Update id=925012319 is handled. Duration 170 ms by bot id=5646878393
2024-03-01T16:01:19.677778+0200 INFO ::1 [01/Mar/2024:16:01:19 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:01:19.835826+0200 INFO Update id=925012320 is handled. Duration 157 ms by bot id=5646878393
2024-03-01T16:01:44.040481+0200 INFO Bot stopped!
2024-03-01T16:01:47.599248+0200 INFO Bot started!
2024-03-01T16:01:51.462162+0200 INFO ::1 [01/Mar/2024:16:01:51 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:01:52.177614+0200 INFO Update id=925012321 is handled. Duration 717 ms by bot id=5646878393
2024-03-01T16:01:53.326452+0200 INFO ::1 [01/Mar/2024:16:01:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:01:53.337151+0200 ERROR Cannot get window data for state <State 'SelectWebMasterOffer:select_webmaster_offer'>
2024-03-01T16:01:53.338147+0200 INFO Update id=925012322 is not handled. Duration 16 ms by bot id=5646878393
2024-03-01T16:01:53.342739+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-18' coro=<BaseRequestHandler._background_feed_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py:137> exception=KeyError('TargetSource.TG_CHANNEL')>
Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\webhook\aiohttp_server.py", line 138, in _background_feed_update
    result = await self.dispatcher.feed_raw_update(bot=bot, update=update, **self.data)
                   │    │          │                   │           │         │    └ {}
                   │    │          │                   │           │         └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000018862691510>
                   │    │          │                   │           └ {'update_id': 925012322, 'callback_query': {'id': '1663765558884406281', 'from': {'id': 387375605, 'is_bot': False, 'first_na...
                   │    │          │                   └ <aiogram.client.bot.Bot object at 0x00000188626192D0>
                   │    │          └ <function Dispatcher.feed_raw_update at 0x000001885E6EDC60>
                   │    └ <Dispatcher '0x1886263a7d0'>
                   └ <aiogram.webhook.aiohttp_server.SimpleRequestHandler object at 0x0000018862691510>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 189, in feed_raw_update
    return await self.feed_update(bot=bot, update=parsed_update, **kwargs)
                 │    │               │           │                └ {}
                 │    │               │           └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 │    │               └ <aiogram.client.bot.Bot object at 0x00000188626192D0>
                 │    └ <function Dispatcher.feed_update at 0x000001885E6EDBC0>
                 └ <Dispatcher '0x1886263a7d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001885E6EC400>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001886263C990>
                     └ <Dispatcher '0x1886263a7d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001886263D110>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001886263CD90>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x0000018862ED0F40>
          │    │   │      │    └ KeyError('TargetSource.TG_CHANNEL')
          │    │   │      └ <class 'KeyError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x0000018862B0A200>
          └ <contextlib._AsyncGeneratorContextManager object at 0x0000018862A8DAD0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000001886263D550>, <function TelegramEventObse...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000018862D80A40>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001886264C750>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000018862418190>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ Update(update_id=925012322, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000018862D80CC0>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1886263a7d0'>>, Update(update_id=925012322, messa...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │    │                           │                  └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001885E6ED1C0>
                 └ <Dispatcher '0x1886263a7d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000188626105E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001885E6EC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000188601EE450>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001885E6ED260>
                 └ <Dispatcher '0x1886263a7d0'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001885E6ED1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018862D80900>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001885E6EC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001886263E610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 261, in process_callback_query
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x0000018862A8CE10>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x0000018862D823E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001885E6ED260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │      │                           │                  └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001885E6ED1C0>
                     └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │        │                     │               └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000018862D80E00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001885E6EC400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018862A63010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001885E6ED260>
                 └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                     │        │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                     │        └ <function TelegramEventObserver.trigger at 0x000001885E6EC540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000018862A63010>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │             └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000001886264C790>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x0000018862418190>, functools.partial(<aiogram...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x00000188623FFC50>, functools.parti...

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                 │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                 └ functools.partial(<function context_saver_middleware at 0x00000188602A9B20>, <function CallableObject.call at 0x0000018862D82...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'dp': <Dispatcher '0x1886263a7d0'>, 'session_pool': async_sessionmaker(class_='AsyncSession', bind=<sqlalchemy.ext.asyncio.e...
                   │       └ CallbackQuery(id='1663765558884406281', from_user=User(id=387375605, is_bot=False, first_name='Solarmove', last_name=None, us...
                   └ <function CallableObject.call at 0x0000018862D82340>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dialog._callback_handler of <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>>, CallbackQuery(id...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 148, in _callback_handler
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x00000188602E1BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
                        │    └ <function ManagerImpl.dialog at 0x00000188602E0F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 123, in render
    new_message = await window.render(self, manager)
                        │      │      │     └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
                        │      │      └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                        │      └ <function Window.render at 0x00000188602F4680>
                        └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 109, in render
    current_data = await self.load_data(dialog, manager)
                         │    │         │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
                         │    │         └ <Dialog(<StatesGroup 'SelectWebMasterOffer'>)>
                         │    └ <function Window.load_data at 0x00000188602F44A0>
                         └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\window.py", line 85, in load_data
    data.update(await self.getter(**manager.middleware_data))
    │    │            │    │        │       └ <property object at 0x00000188602DDC60>
    │    │            │    │        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x0000018862BAA190>
    │    │            │    └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000018862A61610>
    │    │            └ <Window(<State 'SelectWebMasterOffer:select_webmaster_offer'>)>
    │    └ <method 'update' of 'dict' objects>
    └ {'dialog_data': {'selected_target_source': 'TargetSource.TG_CHANNEL', 'selected_traffic_source': 'Reels'}, 'start_data': None...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\widgets\data\data_context.py", line 37, in __call__
    return await self.normal_getter(
                 │    └ <function get_offers at 0x00000188624551C0>
                 └ <aiogram_dialog.widgets.data.data_context.PreviewAwareGetter object at 0x0000018862A61610>

  File "E:\PythonProjects\Arbitrix\bot\dialogs\web_master_menu\getters.py", line 95, in get_offers
    'source': categories_for_zaliv[selected_target_source],
              │                    └ 'TargetSource.TG_CHANNEL'
              └ {<TargetSource.TG_CHANNEL: 'Телеграм канал'>: 'Заявки в Телеграм-каналы', <TargetSource.GAMBLING: 'Гемблинг'>: 'Гемблинг', <T...

KeyError: 'TargetSource.TG_CHANNEL'
2024-03-01T16:02:47.363285+0200 INFO Bot stopped!
2024-03-01T16:02:50.830302+0200 INFO Bot started!
2024-03-01T16:02:53.533507+0200 INFO ::1 [01/Mar/2024:16:02:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:02:53.688604+0200 INFO Update id=925012323 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T16:02:55.111754+0200 INFO ::1 [01/Mar/2024:16:02:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:02:55.239146+0200 INFO Update id=925012324 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T16:02:56.170206+0200 INFO ::1 [01/Mar/2024:16:02:56 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:02:56.323431+0200 INFO Update id=925012325 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T16:03:05.140192+0200 INFO ::1 [01/Mar/2024:16:03:05 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:05.513703+0200 INFO Update id=925012326 is handled. Duration 375 ms by bot id=5646878393
2024-03-01T16:03:06.444745+0200 INFO ::1 [01/Mar/2024:16:03:06 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:06.711485+0200 INFO Update id=925012327 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T16:03:08.006539+0200 INFO ::1 [01/Mar/2024:16:03:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:08.475321+0200 INFO Update id=925012328 is handled. Duration 469 ms by bot id=5646878393
2024-03-01T16:03:09.406041+0200 INFO ::1 [01/Mar/2024:16:03:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:09.588324+0200 INFO Update id=925012329 is handled. Duration 188 ms by bot id=5646878393
2024-03-01T16:03:10.453094+0200 INFO ::1 [01/Mar/2024:16:03:10 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:10.684576+0200 INFO Update id=925012330 is handled. Duration 233 ms by bot id=5646878393
2024-03-01T16:03:11.009143+0200 INFO ::1 [01/Mar/2024:16:03:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:11.276823+0200 INFO Update id=925012331 is handled. Duration 266 ms by bot id=5646878393
2024-03-01T16:03:12.688338+0200 INFO ::1 [01/Mar/2024:16:03:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:13.172868+0200 INFO Update id=925012332 is handled. Duration 468 ms by bot id=5646878393
2024-03-01T16:03:14.001669+0200 INFO ::1 [01/Mar/2024:16:03:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:14.336335+0200 INFO Update id=925012333 is handled. Duration 329 ms by bot id=5646878393
2024-03-01T16:03:14.943072+0200 INFO ::1 [01/Mar/2024:16:03:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:15.102292+0200 INFO Update id=925012334 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T16:03:15.516340+0200 INFO ::1 [01/Mar/2024:16:03:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:15.670735+0200 INFO Update id=925012335 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T16:03:16.134845+0200 INFO ::1 [01/Mar/2024:16:03:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:16.250593+0200 INFO Update id=925012336 is handled. Duration 110 ms by bot id=5646878393
2024-03-01T16:03:21.116041+0200 INFO ::1 [01/Mar/2024:16:03:21 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:21.538717+0200 INFO Update id=925012337 is handled. Duration 421 ms by bot id=5646878393
2024-03-01T16:03:50.922946+0200 INFO ::1 [01/Mar/2024:16:03:50 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:51.232250+0200 INFO Update id=925012338 is handled. Duration 297 ms by bot id=5646878393
2024-03-01T16:03:53.402090+0200 INFO ::1 [01/Mar/2024:16:03:53 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:53.735233+0200 INFO Update id=925012339 is handled. Duration 328 ms by bot id=5646878393
2024-03-01T16:03:55.933612+0200 INFO ::1 [01/Mar/2024:16:03:55 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:03:56.100941+0200 INFO Update id=925012340 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T16:05:00.597208+0200 INFO Bot stopped!
2024-03-01T16:05:04.209481+0200 INFO Bot started!
2024-03-01T16:05:06.527442+0200 INFO ::1 [01/Mar/2024:16:05:06 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:05:06.980354+0200 INFO Update id=925012341 is handled. Duration 453 ms by bot id=5646878393
2024-03-01T16:05:40.161876+0200 INFO Bot stopped!
2024-03-01T16:05:43.652728+0200 INFO Bot started!
2024-03-01T16:05:45.365238+0200 INFO ::1 [01/Mar/2024:16:05:45 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:05:45.668825+0200 INFO Update id=925012342 is handled. Duration 296 ms by bot id=5646878393
2024-03-01T16:05:47.912821+0200 INFO ::1 [01/Mar/2024:16:05:47 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:05:48.070080+0200 INFO Update id=925012343 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T16:06:02.601977+0200 INFO Bot stopped!
2024-03-01T16:06:05.999310+0200 INFO Bot started!
2024-03-01T16:06:09.352286+0200 INFO ::1 [01/Mar/2024:16:06:09 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:09.646874+0200 INFO Update id=925012344 is handled. Duration 296 ms by bot id=5646878393
2024-03-01T16:06:11.062588+0200 INFO ::1 [01/Mar/2024:16:06:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:11.234388+0200 INFO Update id=925012345 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T16:06:12.228912+0200 INFO ::1 [01/Mar/2024:16:06:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:12.396647+0200 INFO Update id=925012346 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T16:06:12.875509+0200 INFO ::1 [01/Mar/2024:16:06:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:13.015223+0200 INFO Update id=925012347 is handled. Duration 139 ms by bot id=5646878393
2024-03-01T16:06:14.351291+0200 INFO ::1 [01/Mar/2024:16:06:14 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:14.533527+0200 INFO Update id=925012348 is handled. Duration 187 ms by bot id=5646878393
2024-03-01T16:06:15.112549+0200 INFO ::1 [01/Mar/2024:16:06:15 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:15.290347+0200 INFO Update id=925012349 is handled. Duration 171 ms by bot id=5646878393
2024-03-01T16:06:16.443749+0200 INFO ::1 [01/Mar/2024:16:06:16 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:16.663947+0200 INFO Update id=925012350 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T16:06:17.422073+0200 INFO ::1 [01/Mar/2024:16:06:17 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:17.570948+0200 INFO Update id=925012351 is handled. Duration 156 ms by bot id=5646878393
2024-03-01T16:06:18.476507+0200 INFO ::1 [01/Mar/2024:16:06:18 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:18.760601+0200 INFO Update id=925012352 is handled. Duration 280 ms by bot id=5646878393
2024-03-01T16:06:20.027452+0200 INFO ::1 [01/Mar/2024:16:06:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:20.195832+0200 INFO Update id=925012353 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T16:06:24.227997+0200 INFO ::1 [01/Mar/2024:16:06:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:06:24.439437+0200 INFO Update id=925012354 is handled. Duration 218 ms by bot id=5646878393
2024-03-01T16:08:08.179469+0200 INFO ::1 [01/Mar/2024:16:08:08 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:08:08.422519+0200 INFO Update id=925012355 is handled. Duration 234 ms by bot id=5646878393
2024-03-01T16:09:58.032974+0200 INFO ::1 [01/Mar/2024:16:09:58 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:09:58.113177+0200 INFO ::1 [01/Mar/2024:16:09:58 +0200] "POST /withdraw-request HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:11:43.746999+0200 INFO ::1 [01/Mar/2024:16:11:43 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:11:43.829231+0200 INFO ::1 [01/Mar/2024:16:11:43 +0200] "POST /withdraw-request HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:17:54.004813+0200 INFO Bot stopped!
2024-03-01T16:17:57.478661+0200 INFO Bot started!
2024-03-01T16:18:17.199693+0200 INFO Bot stopped!
2024-03-01T16:18:20.727617+0200 INFO Bot started!
2024-03-01T16:18:29.934861+0200 INFO ::1 [01/Mar/2024:16:18:29 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:18:30.412021+0200 ERROR Error handling request
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 514, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                      │                └ <function AsyncAdapt_asyncpg_connection._prepare at 0x00000224B3DFA200>
                                      └ <AdaptedConnection <asyncpg.connection.Connection object at 0x00000224B41863E0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 765, in _prepare
    prepared_stmt = await self._connection.prepare(
                          │    └ <member '_connection' of 'AdaptedConnection' objects>
                          └ <AdaptedConnection <asyncpg.connection.Connection object at 0x00000224B41863E0>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
                 │    └ <function Connection._prepare at 0x00000224B41800E0>
                 └ <asyncpg.connection.Connection object at 0x00000224B41863E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
                 │    └ <function Connection._get_statement at 0x00000224B416FD80>
                 └ <asyncpg.connection.Connection object at 0x00000224B41863E0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                      │    └ <member '_protocol' of 'Connection' objects>
                      └ <asyncpg.connection.Connection object at 0x00000224B41863E0>
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare

asyncpg.exceptions.UndefinedColumnError: стовпець "Криптовалютный адрес" зв'язку "withdraw_requests" не існує


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000224B38E6340>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x00000224B3FB93D0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Банківська картка', 'test', None, 12322, 'ACTIVE')
    │      │       └ 'INSERT INTO withdraw_requests ("ID пользователя", "Тип выплаты", "Название банка", "Криптовалютный адрес", "Сумма выплаты", ...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x00000224B3DF9580>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000224B469D120>
           └ <_AsyncIoGreenlet object at 0x00000224B4238900 (otid=0x00000224B3277DB0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000224B469D120>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x00000224B3DF93A0>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ UndefinedColumnError('стовпець "Криптовалютный адрес" зв\'язку "withdraw_requests" не існує')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ UndefinedColumnError('стовпець "Криптовалютный адрес" зв\'язку "withdraw_requests" не існує')
          └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Криптовалютный адрес" зв\'язку "withdraw_req...

sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: стовпець "Криптовалютный адрес" зв'язку "withdraw_requests" не існує


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "E:\PythonProjects\Arbitrix\bot\__main__.py", line 134, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000224B40816C0>
    │       └ <function run at 0x00000224AB9DC540>
    └ <module 'asyncio' from 'C:\\Users\\Solarmove\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\__init__.py'>

  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000224B4036740>
           │      └ <function Runner.run at 0x00000224ABA6C900>
           └ <asyncio.runners.Runner object at 0x00000224B391F750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\loguru\_logger.py:1263...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000224ABA6A3E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000224B391F750>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 637, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000224ABB4A340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 604, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000224ABA6C180>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1909, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000224AB9ADA80>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_protocol.py", line 452, in _handle_request
    resp = await request_handler(request)
                 │               └ <Request POST /withdraw-request >
                 └ <bound method Application._handle of <Application 0x224b4610d50>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiohttp\web_app.py", line 543, in _handle
    resp = await handler(request)
                 │       └ <Request POST /withdraw-request >
                 └ <function handle_withdraw_request at 0x00000224B4081440>

  File "E:\PythonProjects\Arbitrix\bot\handlers\other_handlers.py", line 111, in handle_withdraw_request
    await repo.payment_repo.add_withdraw_request(user_id, amount, data['paymentType']['name'], bank_name, card_number, crypto_adress)
          │    │            │                    │        │       │                            │          │            └ None
          │    │            │                    │        │       │                            │          └ '1233'
          │    │            │                    │        │       │                            └ 'test'
          │    │            │                    │        │       └ {'paymentType': {'id': 1, 'name': 'Банківська картка'}, 'bankName': 'test', 'requisites': '1233', 'sum': '12322', 'tg_user_id...
          │    │            │                    │        └ 12322
          │    │            │                    └ 387375605
          │    │            └ <function PaymentRequestsRepo.add_withdraw_request at 0x00000224B3ECF740>
          │    └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x00000224B4238890>
          └ <bot.db.Repo object at 0x00000224B4221850>

  File "E:\PythonProjects\Arbitrix\bot\db\requests\payment_requests.py", line 21, in add_withdraw_request
    await self.session.execute(query)
          │    │       │       └ <sqlalchemy.dialects.postgresql.dml.Insert object at 0x00000224B42388D0>
          │    │       └ <function AsyncSession.execute at 0x00000224B3CDC4A0>
          │    └ <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x00000224B3FABED0>
          └ <bot.db.requests.payment_requests.PaymentRequestsRepo object at 0x00000224B4238890>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 452, in execute
    result = await greenlet_spawn(
                   └ <function greenlet_spawn at 0x00000224B334AAC0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 197, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             │       │      │   └ <built-in function exc_info>
             │       │      └ <module 'sys' (built-in)>
             │       └ <method 'throw' of 'greenlet.greenlet' objects>
             └ <_AsyncIoGreenlet object at 0x00000224B4238900 (otid=0x00000224B3277DB0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2306, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x00000224B3BFC2C0>
           └ <sqlalchemy.orm.session.Session object at 0x00000224B41CD310>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2191, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function BulkORMInsert.orm_execute_statement at 0x00000224B3BCFD80>)>
                   │      └ <class 'sqlalchemy.orm.bulk_persistence.BulkORMInsert'>
                   └ typing.Any
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1276, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x00000224B3832520>
             └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1408, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedInsert object at 0x00000224B4803E10>>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 513, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x00000224B3832840>
           └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x00000224B3832A20>
          └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1839, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x00000224B3832AC0>
           └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1979, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x00000224B3832D40>
    └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2335, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Криптовалютный адрес" зв\'язку "withdraw_req...
          │                    │              └ (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError'>, ProgrammingError('<class \'async...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ ProgrammingError('(sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class \'asyncpg.exceptions.UndefinedColumnError\...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1960, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000224B38E6340>
    │    └ <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x00000224B3FB93D0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000224B41FD9D0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (387375605, 'Банківська картка', 'test', None, 12322, 'ACTIVE')
    │      │       └ 'INSERT INTO withdraw_requests ("ID пользователя", "Тип выплаты", "Название банка", "Криптовалютный адрес", "Сумма выплаты", ...
    │      └ <function AsyncAdapt_asyncpg_cursor.execute at 0x00000224B3DF9580>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 572, in execute
    self._adapt_connection.await_(
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 127, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
           │                     └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000224B469D120>
           └ <_AsyncIoGreenlet object at 0x00000224B4238900 (otid=0x00000224B3277DB0) dead>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 192, in greenlet_spawn
    value = await result
                  └ <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x00000224B469D120>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._handle_exception(error)
    │    └ <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x00000224B3DF93A0>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 501, in _handle_exception
    self._adapt_connection._handle_exception(error)
    │    │                                   └ UndefinedColumnError('стовпець "Криптовалютный адрес" зв\'язку "withdraw_requests" не існує')
    │    └ <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    └ <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x00000224B487B4C0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 789, in _handle_exception
    raise translated_error from error
          │                     └ UndefinedColumnError('стовпець "Криптовалютный адрес" зв\'язку "withdraw_requests" не існує')
          └ ProgrammingError('<class \'asyncpg.exceptions.UndefinedColumnError\'>: стовпець "Криптовалютный адрес" зв\'язку "withdraw_req...

sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: стовпець "Криптовалютный адрес" зв'язку "withdraw_requests" не існує
[SQL: INSERT INTO withdraw_requests ("ID пользователя", "Тип выплаты", "Название банка", "Криптовалютный адрес", "Сумма выплаты", "Статус запроса") VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::withdrawstatus) ON CONFLICT DO NOTHING RETURNING withdraw_requests.id]
[parameters: (387375605, 'Банківська картка', 'test', None, 12322, 'ACTIVE')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-03-01T16:18:30.426435+0200 INFO ::1 [01/Mar/2024:16:18:30 +0200] "POST /withdraw-request HTTP/1.1" 500 418 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:18:44.658632+0200 INFO Bot stopped!
2024-03-01T16:18:48.640226+0200 INFO Bot started!
2024-03-01T16:18:54.910545+0200 INFO ::1 [01/Mar/2024:16:18:54 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:18:55.050878+0200 INFO ::1 [01/Mar/2024:16:18:54 +0200] "POST /withdraw-request HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:18:55.058966+0200 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Updater._process_update() done, defined at E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py:25> exception=UnregisteredWindowError("No window found for `<State 'WithdrawFunds:save_withdraw_data'>` Current state group is `WithdrawFunds`")>
Traceback (most recent call last):

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 106, in _current_window
    return self.windows[manager.current_context().state]
           │    │       │       └ <function ManagerImpl.current_context at 0x0000020898D10FE0>
           │    │       └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002089B0C6D90>
           │    └ {<State 'WithdrawFunds:show_withdraw_menu'>: <Window(<State 'WithdrawFunds:show_withdraw_menu'>)>}
           └ <Dialog(<StatesGroup 'WithdrawFunds'>)>

KeyError: <State 'WithdrawFunds:save_withdraw_data'>


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\updater.py", line 27, in _process_update
    await self.dp.propagate_event(
          │    │  └ <function Router.propagate_event at 0x000002089712D1C0>
          │    └ <Dispatcher '0x2089b06b350'>
          └ <aiogram_dialog.manager.updater.Updater object at 0x000002089AE5CE90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002089B7AB920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002089712C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002089B07D610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002089B07DD50>, functools...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002089B07DD10>, functools.partial(<bot.middlewa...
  File "C:\Users\Solarmove\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
          │    │   │      │    │      └ <traceback object at 0x000002089B7E74C0>
          │    │   │      │    └ UnregisteredWindowError("No window found for `<State 'WithdrawFunds:save_withdraw_data'>` Current state group is `WithdrawFun...
          │    │   │      └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>
          │    │   └ <method 'athrow' of 'async_generator' objects>
          │    └ <async_generator object RedisEventIsolation.lock at 0x000002089B53A3E0>
          └ <contextlib._AsyncGeneratorContextManager object at 0x000002089B4C3710>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 231, in lock
    yield None
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.RedisI18nMiddleware object at 0x000002089B07E110>, <function Router.propagate_...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 95, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002089B7BBB00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002089712D260>
                 └ <Dispatcher '0x2089b06b350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                     │        └ <function TelegramEventObserver.trigger at 0x000002089712C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002089B07D610>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.db.DbSessionMiddleware object at 0x000002089B085750>, functools.partial(<bot.middlewares.i...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\db.py", line 22, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ functools.partial(<bot.middlewares.i18n_dialog.I18nDialogMiddleware object at 0x000002089AE5C9D0>, <function CallableObject.c...

  File "E:\PythonProjects\Arbitrix\bot\middlewares\i18n_dialog.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogUpdate(update_id=0, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=No...
                 └ <function CallableObject.call at 0x0000020898ACCE00>

  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2089b06b350'>>, DialogUpdate(update_id=0, message...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │    │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │    │                           └ 'aiogd_update'
                 │    └ <function Router.propagate_event at 0x000002089712D1C0>
                 └ <Dispatcher '0x2089b06b350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 129, in propagate_event
    return await _wrapped(event, **kwargs)
                 │        │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002089B7BBD80>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002089712D260>
                 └ <Dispatcher '0x2089b06b350'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │      │                           │                  └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │      │                           └ 'aiogd_update'
                     │      └ <function Router.propagate_event at 0x000002089712D1C0>
                     └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │        │                     │               └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002089B7BBF60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002089712C400>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002089AE2D690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 236, in process_aiogd_update
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.BgFactoryMiddleware object at 0x000002089B4C1ED0>, <function Rou...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 77, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ <function Router.propagate_event.<locals>._wrapped at 0x000002089B7BBCE0>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002089712D260>
                 └ <Router '__main__'>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                     │        │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                     │        └ <function TelegramEventObserver.trigger at 0x000002089712C540>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002089AE2D690>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │             └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<aiogram_dialog.manager.manager_middleware.ManagerMiddleware object at 0x000002089B4C1D10>, functools.parti...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager_middleware.py", line 52, in __call__
    return await handler(event, data)
                 │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                 │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                 └ functools.partial(<function context_saver_middleware at 0x0000020898CD9B20>, <function CallableObject.call at 0x000002089B7BB...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\context\intent_middleware.py", line 275, in context_saver_middleware
    result = await handler(event, data)
                   │       │      └ {'bot': <aiogram.client.bot.Bot object at 0x000002089ACFE050>, 'event_from_user': FakeUser(id=387375605, is_bot=False, first_...
                   │       └ DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=False, first_name='', last_name=None, username=None, language_code=...
                   └ <function CallableObject.call at 0x000002089B7BBE20>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function handle_update at 0x0000020898D12A20>, DialogSwitchEvent(from_user=FakeUser(id=387375605, is_bot=F...
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\update_handler.py", line 29, in handle_update
    await dialog_manager.show()
          │              └ <function ManagerImpl.show at 0x0000020898D11BC0>
          └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002089B0C6D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\manager\manager.py", line 324, in show
    new_message = await self.dialog().render(self)
                        │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002089B0C6D90>
                        │    └ <function ManagerImpl.dialog at 0x0000020898D10F40>
                        └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002089B0C6D90>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 122, in render
    window = await self._current_window(manager)
                   │    │               └ <aiogram_dialog.manager.manager.ManagerImpl object at 0x000002089B0C6D90>
                   │    └ <function Dialog._current_window at 0x0000020898CD8CC0>
                   └ <Dialog(<StatesGroup 'WithdrawFunds'>)>
  File "E:\PythonProjects\Arbitrix\.venv\Lib\site-packages\aiogram_dialog\dialog.py", line 108, in _current_window
    raise UnregisteredWindowError(
          └ <class 'aiogram_dialog.api.exceptions.UnregisteredWindowError'>

aiogram_dialog.api.exceptions.UnregisteredWindowError: No window found for `<State 'WithdrawFunds:save_withdraw_data'>` Current state group is `WithdrawFunds`
2024-03-01T16:19:06.482712+0200 INFO Bot stopped!
2024-03-01T16:19:09.798177+0200 INFO Bot started!
2024-03-01T16:19:11.424326+0200 INFO ::1 [01/Mar/2024:16:19:11 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:11.884196+0200 INFO Update id=925012356 is handled. Duration 452 ms by bot id=5646878393
2024-03-01T16:19:12.945156+0200 INFO ::1 [01/Mar/2024:16:19:12 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:13.121978+0200 INFO Update id=925012357 is handled. Duration 172 ms by bot id=5646878393
2024-03-01T16:19:18.807779+0200 INFO ::1 [01/Mar/2024:16:19:18 +0200] "OPTIONS /withdraw-request HTTP/1.1" 200 360 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:19:19.032921+0200 INFO ::1 [01/Mar/2024:16:19:18 +0200] "POST /withdraw-request HTTP/1.1" 200 332 "https://webapp-forms.netlify.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"
2024-03-01T16:19:20.687021+0200 INFO ::1 [01/Mar/2024:16:19:20 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:20.822574+0200 INFO Update id=925012358 is handled. Duration 141 ms by bot id=5646878393
2024-03-01T16:19:24.596675+0200 INFO ::1 [01/Mar/2024:16:19:24 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:25.204954+0200 INFO Update id=925012359 is handled. Duration 609 ms by bot id=5646878393
2024-03-01T16:19:25.485553+0200 INFO ::1 [01/Mar/2024:16:19:25 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:26.108961+0200 INFO Update id=925012360 is handled. Duration 608 ms by bot id=5646878393
2024-03-01T16:19:29.219304+0200 INFO ::1 [01/Mar/2024:16:19:29 +0200] "POST /webhook HTTP/1.1" 200 159 "-" "-"
2024-03-01T16:19:29.347271+0200 INFO Update id=925012361 is handled. Duration 125 ms by bot id=5646878393
2024-03-01T16:42:53.523155+0200 INFO Bot stopped!
